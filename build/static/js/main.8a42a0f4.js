/*! For license information please see main.8a42a0f4.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:o,_owner:i.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,S=Object.prototype.hasOwnProperty,_={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var a,o={},s=null,i=null;if(null!=t)for(a in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,a)&&!k.hasOwnProperty(a)&&(o[a]=t[a]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===o[a]&&(o[a]=l[a]);return{$$typeof:n,type:e,key:s,ref:i,props:o,_owner:_.current}}function N(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var j=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,a,o,s){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+C(l,0):o,x(s)?(a="",null!=e&&(a=e.replace(j,"$&/")+"/"),T(s,t,a,"",function(e){return e})):null!=s&&(N(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(j,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",x(e))for(var c=0;c<e.length;c++){var u=o+C(i=e[c],c);l+=T(i,t,a,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(i=e.next()).done;)l+=T(i=i.value,t,a,u=o+C(i,c++),s);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",function(e){return t.call(n,e,a++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},R={transition:null},D={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:R,ReactCurrentOwner:_};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!N(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),o=e.key,s=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,i=_.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!k.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:e.type,key:o,ref:s,props:a,_owner:i}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<o(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var i=2*(r+1)-1,l=e[i],c=i+1,u=e[c];if(0>o(l,n))c<a&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[i]=n,r=i);else{if(!(c<a&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,R(S);else{var t=r(u);null!==t&&D(x,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(N),N=-1),f=!0;var o=p;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var i=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof i?h.callback=i:h===r(c)&&a(c),w(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&D(x,d.startTime-n),l=!1}return l}finally{h=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,k=!1,E=null,N=-1,j=5,C=-1;function T(){return!(t.unstable_now()-C<j)}function P(){if(null!==E){var e=t.unstable_now();C=e;var n=!0;try{n=E(!0,e)}finally{n?_():(k=!1,E=null)}}else k=!1}if("function"===typeof b)_=function(){b(P)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,I=A.port2;A.port1.onmessage=P,_=function(){I.postMessage(null)}}else _=function(){v(P,0)};function R(e){E=e,k||(k=!0,_())}function D(e,n){N=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,R(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:o,expirationTime:i=o+i,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(g?(y(N),N=-1):g=!0,D(x,o-s))):(e.sortIndex=i,n(c,e),m||f||(m=!0,R(S))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),a=n(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,a,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),S=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),j=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var L,U=Object.assign;function M(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var z=!1;function F(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),o=r.stack.split("\n"),s=a.length-1,i=o.length-1;1<=s&&0<=i&&a[s]!==o[i];)i--;for(;1<=s&&0<=i;s--,i--)if(a[s]!==o[i]){if(1!==s||1!==i)do{if(s--,0>--i||a[s]!==o[i]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=i);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?M(e):""}function H(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case S:return"Portal";case E:return"Profiler";case k:return"StrictMode";case T:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case j:return(e.displayName||"Context")+".Consumer";case N:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function G(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function oe(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,_e=null,ke=null;function Ee(e){if(e=ba(e)){if("function"!==typeof Se)throw Error(o(280));var t=e.stateNode;t&&(t=xa(t),Se(e.stateNode,e.type,t))}}function Ne(e){_e?ke?ke.push(e):ke=[e]:_e=e}function je(){if(_e){var e=_e,t=ke;if(ke=_e=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ce(e,t){return e(t)}function Te(){}var Pe=!1;function Ae(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Ce(e,t,n)}finally{Pe=!1,(null!==_e||null!==ke)&&(Te(),je())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var r=xa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Re=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Re=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Re=!1}function Oe(e,t,n,r,a,o,s,i,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Ue=null,Me=!1,ze=null,Fe={onError:function(e){Le=!0,Ue=e}};function He(e,t,n,r,a,o,s,i,l){Le=!1,Ue=null,Oe.apply(Fe,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Be(e)!==e)throw Error(o(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return Ve(a),e;if(s===r)return Ve(a),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=s;else{for(var i=!1,l=a.child;l;){if(l===n){i=!0,n=a,r=s;break}if(l===r){i=!0,r=a,n=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===n){i=!0,n=s,r=a;break}if(l===r){i=!0,r=s,n=a;break}l=l.sibling}if(!i)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?$e(e):null}function $e(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=$e(e);if(null!==t)return t;e=e.sibling}return null}var Je=a.unstable_scheduleCallback,Ke=a.unstable_cancelCallback,Qe=a.unstable_shouldYield,Ge=a.unstable_requestPaint,Ye=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/lt|0)|0},it=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var i=s&~a;0!==i?r=dt(i):0!==(o&=s)&&(r=dt(o))}else 0!==(s=n&~a)?r=dt(s):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(o=t&-t)||16===a&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,St,_t,kt,Et,Nt=!1,jt=[],Ct=null,Tt=null,Pt=null,At=new Map,It=new Map,Rt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Lt(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ut(e){var t=ya(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Et(e.priority,function(){_t(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Mt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function zt(e,t,n){Mt(e)&&n.delete(t)}function Ft(){Nt=!1,null!==Ct&&Mt(Ct)&&(Ct=null),null!==Tt&&Mt(Tt)&&(Tt=null),null!==Pt&&Mt(Pt)&&(Pt=null),At.forEach(zt),It.forEach(zt)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,Nt||(Nt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ft)))}function Bt(e){function t(t){return Ht(t,e)}if(0<jt.length){Ht(jt[0],e);for(var n=1;n<jt.length;n++){var r=jt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Ht(Ct,e),null!==Tt&&Ht(Tt,e),null!==Pt&&Ht(Pt,e),At.forEach(t),It.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Ut(n),null===n.blockedOn&&Rt.shift()}var Wt=w.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,r){var a=bt,o=Wt.transition;Wt.transition=null;try{bt=1,Jt(e,t,n,r)}finally{bt=a,Wt.transition=o}}function $t(e,t,n,r){var a=bt,o=Wt.transition;Wt.transition=null;try{bt=4,Jt(e,t,n,r)}finally{bt=a,Wt.transition=o}}function Jt(e,t,n,r){if(Vt){var a=Qt(e,t,n,r);if(null===a)Vr(e,t,r,Kt,n),Ot(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Ct=Lt(Ct,e,t,n,r,a),!0;case"dragenter":return Tt=Lt(Tt,e,t,n,r,a),!0;case"mouseover":return Pt=Lt(Pt,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return At.set(o,Lt(At.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,It.set(o,Lt(It.get(o)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==a;){var o=ba(a);if(null!==o&&xt(o),null===(o=Qt(e,t,n,r))&&Vr(e,t,r,Kt,n),o===a)break;a=o}null!==a&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Kt=null;function Qt(e,t,n,r){if(Kt=null,null!==(e=ya(e=xe(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,a="value"in Yt?Yt.value:Yt.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[o-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),dn=U({},cn,{view:0,detail:0}),hn=an(dn),pn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=an(pn),mn=an(U({},pn,{dataTransfer:0})),gn=an(U({},dn,{relatedTarget:0})),vn=an(U({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=U({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),wn=an(U({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function En(){return kn}var Nn=U({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),jn=an(Nn),Cn=an(U({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Pn=an(U({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=U({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(An),Rn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Ln=u&&"TextEvent"in window&&!On,Un=u&&(!Dn||On&&8<On&&11>=On),Mn=String.fromCharCode(32),zn=!1;function Fn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function qn(e,t,n,r){Ne(r),0<(t=$r(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var $n=null,Jn=null;function Kn(e){Mr(e,0)}function Qn(e){if(J(wa(e)))return e}function Gn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){$n&&($n.detachEvent("onpropertychange",nr),Jn=$n=null)}function nr(e){if("value"===e.propertyName&&Qn(Jn)){var t=[];qn(t,Jn,e,xe(e)),Ae(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Jn=n,($n=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Jn)}function or(e,t){if("click"===e)return Qn(t)}function sr(e,t){if("input"===e||"change"===e)return Qn(t)}var ir="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ir(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!ir(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,o=Math.min(r.start,a);r=void 0===r.end?o:Math.min(r.end,a),!e.extend&&o>r&&(a=r,r=o,o=a),a=ur(n,o);var s=ur(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==K(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=$r(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},_r={},kr={};function Er(e){if(_r[e])return _r[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return _r[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Nr=Er("animationend"),jr=Er("animationiteration"),Cr=Er("animationstart"),Tr=Er("transitionend"),Pr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){Pr.set(e,t),l(t,[e])}for(var Rr=0;Rr<Ar.length;Rr++){var Dr=Ar[Rr];Ir(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Ir(Nr,"onAnimationEnd"),Ir(jr,"onAnimationIteration"),Ir(Cr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,i,l,c){if(He.apply(this,arguments),Le){if(!Le)throw Error(o(198));var u=Ue;Le=!1,Ue=null,Me||(Me=!0,ze=u)}}(r,t,void 0,e),e.currentTarget=null}function Mr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var i=r[s],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==o&&a.isPropagationStopped())break e;Ur(a,i,c),o=l}else for(s=0;s<r.length;s++){if(l=(i=r[s]).instance,c=i.currentTarget,i=i.listener,l!==o&&a.isPropagationStopped())break e;Ur(a,i,c),o=l}}}if(Me)throw e=ze,Me=!1,ze=null,e}function zr(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Fr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Hr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Hr]){e[Hr]=!0,s.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||Fr(t,!1,e),Fr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hr]||(t[Hr]=!0,Fr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Gt(t)){case 1:var a=qt;break;case 4:a=$t;break;default:a=Jt}n=a.bind(null,t,n,e),a=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,a){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==i;){if(null===(s=ya(i)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}i=i.parentNode}}r=r.return}Ae(function(){var r=o,a=xe(n),s=[];e:{var i=Pr.get(e);if(void 0!==i){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=jn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Nr:case jr:case Cr:l=vn;break;case Tr:l=Pn;break;case"scroll":l=hn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==i?i+"Capture":null:i;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ie(f,h))&&u.push(qr(f,m,p)))),d)break;f=f.return}0<u.length&&(i=new l(i,c,null,n,a),s.push({event:i,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[fa])&&(l||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?i:wa(l),p=null==c?i:wa(c),(i=new u(m,f+"leave",l,n,a)).target=d,i.relatedTarget=p,m=null,ya(a)===r&&((u=new u(h,f+"enter",c,n,a)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Jr(p))f++;for(p=0,m=h;m;m=Jr(m))p++;for(;0<f-p;)u=Jr(u),f--;for(;0<p-f;)h=Jr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Jr(u),h=Jr(h)}u=null}else u=null;null!==l&&Kr(s,i,l,u,!1),null!==c&&null!==d&&Kr(s,d,c,u,!0)}if("select"===(l=(i=r?wa(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===l&&"file"===i.type)var g=Gn;else if(Vn(i))if(Yn)g=sr;else{g=ar;var v=rr}else(l=i.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(g=or);switch(g&&(g=g(e,r))?qn(s,g,n,a):(v&&v(e,i,r),"focusout"===e&&(v=i._wrapperState)&&v.controlled&&"number"===i.type&&ee(i,"number",i.value)),v=r?wa(r):window,e){case"focusin":(Vn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,a)}var y;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Fn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(y=en()):(Xt="value"in(Yt=a)?Yt.value:Yt.textContent,Bn=!0)),0<(v=$r(r,b)).length&&(b=new wn(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Hn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Hn(t);case"keypress":return 32!==t.which?null:(zn=!0,Mn);case"textInput":return(e=t.data)===Mn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Dn&&Fn(e,t)?(e=en(),Zt=Xt=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=$r(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=y))}Mr(s,t)})}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function $r(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=Ie(e,n))&&r.unshift(qr(e,o,a)),null!=(o=Ie(e,t))&&r.push(qr(e,o,a))),e=e.return}return r}function Jr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,a){for(var o=t._reactName,s=[];null!==n&&n!==r;){var i=n,l=i.alternate,c=i.stateNode;if(null!==l&&l===r)break;5===i.tag&&null!==c&&(i=c,a?null!=(l=Ie(n,o))&&s.unshift(qr(n,l,i)):a||null!=(l=Ie(n,o))&&s.push(qr(n,l,i))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qr=/\r\n?/g,Gr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Gr,"")}function Xr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(o(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,oa="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oa?function(e){return oa.resolve(null).then(e).catch(ia)}:ra;function ia(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Bt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,pa="__reactProps$"+da,fa="__reactContainer$"+da,ma="__reactEvents$"+da,ga="__reactListeners$"+da,va="__reactHandles$"+da;function ya(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[ha])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function xa(e){return e[pa]||null}var Sa=[],_a=-1;function ka(e){return{current:e}}function Ea(e){0>_a||(e.current=Sa[_a],Sa[_a]=null,_a--)}function Na(e,t){_a++,Sa[_a]=e.current,e.current=t}var ja={},Ca=ka(ja),Ta=ka(!1),Pa=ja;function Aa(e,t){var n=e.type.contextTypes;if(!n)return ja;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ia(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ra(){Ea(Ta),Ea(Ca)}function Da(e,t,n){if(Ca.current!==ja)throw Error(o(168));Na(Ca,t),Na(Ta,n)}function Oa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(o(108,W(e)||"Unknown",a));return U({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ja,Pa=Ca.current,Na(Ca,e),Na(Ta,Ta.current),!0}function Ua(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Oa(e,t,Pa),r.__reactInternalMemoizedMergedChildContext=e,Ea(Ta),Ea(Ca),Na(Ca,e)):Ea(Ta),Na(Ta,n)}var Ma=null,za=!1,Fa=!1;function Ha(e){null===Ma?Ma=[e]:Ma.push(e)}function Ba(){if(!Fa&&null!==Ma){Fa=!0;var e=0,t=bt;try{var n=Ma;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ma=null,za=!1}catch(a){throw null!==Ma&&(Ma=Ma.slice(e+1)),Je(Ze,Ba),a}finally{bt=t,Fa=!1}}return null}var Wa=[],Va=0,qa=null,$a=0,Ja=[],Ka=0,Qa=null,Ga=1,Ya="";function Xa(e,t){Wa[Va++]=$a,Wa[Va++]=qa,qa=e,$a=t}function Za(e,t,n){Ja[Ka++]=Ga,Ja[Ka++]=Ya,Ja[Ka++]=Qa,Qa=e;var r=Ga;e=Ya;var a=32-st(r)-1;r&=~(1<<a),n+=1;var o=32-st(t)+a;if(30<o){var s=a-a%5;o=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Ga=1<<32-st(t)+a|n<<a|r,Ya=o+e}else Ga=1<<o|n<<a|r,Ya=e}function eo(e){null!==e.return&&(Xa(e,1),Za(e,1,0))}function to(e){for(;e===qa;)qa=Wa[--Va],Wa[Va]=null,$a=Wa[--Va],Wa[Va]=null;for(;e===Qa;)Qa=Ja[--Ka],Ja[Ka]=null,Ya=Ja[--Ka],Ja[Ka]=null,Ga=Ja[--Ka],Ja[Ka]=null}var no=null,ro=null,ao=!1,oo=null;function so(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function io(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qa?{id:Ga,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(ao){var t=ro;if(t){var n=t;if(!io(e,t)){if(lo(e))throw Error(o(418));t=ca(n.nextSibling);var r=no;t&&io(e,t)?so(r,n):(e.flags=-4097&e.flags|2,ao=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,ao=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!ao)return uo(e),ao=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)so(e,t),t=ca(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ca(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=ca(e.nextSibling)}function fo(){ro=no=null,ao=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=w.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function wo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===_?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===I&&bo(o)===t.type)?((r=a(t,n.props)).ref=vo(e,t,n),r.return=e,r):((r=Dc(n.type,n.key,n.props,null,e.mode,r)).ref=vo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Mc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case S:return(t=Mc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Oc(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===a?c(e,t,n,r):null;case S:return n.key===a?u(e,t,n,r):null;case I:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||O(n))return null!==a?null:d(e,t,n,r,null);yo(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case S:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case I:return f(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,a,null);yo(t,r)}return null}function m(a,o,i,l){for(var c=null,u=null,d=o,m=o=0,g=null;null!==d&&m<i.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(a,d,i[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(a,d),o=s(v,o,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===i.length)return n(a,d),ao&&Xa(a,m),c;if(null===d){for(;m<i.length;m++)null!==(d=h(a,i[m],l))&&(o=s(d,o,m),null===u?c=d:u.sibling=d,u=d);return ao&&Xa(a,m),c}for(d=r(a,d);m<i.length;m++)null!==(g=f(d,a,m,i[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(a,e)}),ao&&Xa(a,m),c}function g(a,i,l,c){var u=O(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var d=u=null,m=i,g=i=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(a,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(a,m),i=s(b,i,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(a,m),ao&&Xa(a,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(a,y.value,c))&&(i=s(y,i,g),null===d?u=y:d.sibling=y,d=y);return ao&&Xa(a,g),u}for(m=r(a,m);!y.done;g++,y=l.next())null!==(y=f(m,a,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),i=s(y,i,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(a,e)}),ao&&Xa(a,g),u}return function e(r,o,s,l){if("object"===typeof s&&null!==s&&s.type===_&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case x:e:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===_){if(7===u.tag){n(r,u.sibling),(o=a(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&bo(c)===u.type){n(r,u.sibling),(o=a(u,s.props)).ref=vo(r,u,s),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===_?((o=Oc(s.props.children,r.mode,l,s.key)).return=r,r=o):((l=Dc(s.type,s.key,s.props,null,r.mode,l)).ref=vo(r,o,s),l.return=r,r=l)}return i(r);case S:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=a(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Mc(s,r.mode,l)).return=r,r=o}return i(r);case I:return e(r,o,(u=s._init)(s._payload),l)}if(te(s))return m(r,o,s,l);if(O(s))return g(r,o,s,l);yo(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=a(o,s)).return=r,r=o):(n(r,o),(o=Uc(s,r.mode,l)).return=r,r=o),i(r)):n(r,o)}}var xo=wo(!0),So=wo(!1),_o=ka(null),ko=null,Eo=null,No=null;function jo(){No=Eo=ko=null}function Co(e){var t=_o.current;Ea(_o),e._currentValue=t}function To(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Po(e,t){ko=e,No=Eo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bi=!0),e.firstContext=null)}function Ao(e){var t=e._currentValue;if(No!==e)if(e={context:e,memoizedValue:t,next:null},null===Eo){if(null===ko)throw Error(o(308));Eo=e,ko.dependencies={lanes:0,firstContext:e}}else Eo=Eo.next=e;return t}var Io=null;function Ro(e){null===Io?Io=[e]:Io.push(e)}function Do(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ro(t)):(n.next=a.next,a.next=n),t.interleaved=n,Oo(e,r)}function Oo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Lo=!1;function Uo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Oo(e,n)}return null===(a=r.interleaved)?(t.next=t,Ro(r)):(t.next=a.next,a.next=t),r.interleaved=t,Oo(e,n)}function Ho(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Bo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wo(e,t,n,r){var a=e.updateQueue;Lo=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var l=i,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((i=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===i?u.firstBaseUpdate=c:i.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=a.baseState;for(s=0,u=c=l=null,i=o;;){var h=i.lane,p=i.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var f=e,m=i;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=U({},d,h);break e;case 2:Lo=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[i]:h.push(i))}else p={eventTime:p,lane:h,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=h;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(h=i).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===o&&(a.shared.lanes=0);Ll|=s,e.lanes=s,e.memoizedState=d}}function Vo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(o(191,a));a.call(r)}}}var qo={},$o=ka(qo),Jo=ka(qo),Ko=ka(qo);function Qo(e){if(e===qo)throw Error(o(174));return e}function Go(e,t){switch(Na(Ko,t),Na(Jo,e),Na($o,qo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ea($o),Na($o,t)}function Yo(){Ea($o),Ea(Jo),Ea(Ko)}function Xo(e){Qo(Ko.current);var t=Qo($o.current),n=le(t,e.type);t!==n&&(Na(Jo,e),Na($o,n))}function Zo(e){Jo.current===e&&(Ea($o),Ea(Jo))}var es=ka(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function rs(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var as=w.ReactCurrentDispatcher,os=w.ReactCurrentBatchConfig,ss=0,is=null,ls=null,cs=null,us=!1,ds=!1,hs=0,ps=0;function fs(){throw Error(o(321))}function ms(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ir(e[n],t[n]))return!1;return!0}function gs(e,t,n,r,a,s){if(ss=s,is=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,as.current=null===e||null===e.memoizedState?Zs:ei,e=n(r,a),ds){s=0;do{if(ds=!1,hs=0,25<=s)throw Error(o(301));s+=1,cs=ls=null,t.updateQueue=null,as.current=ti,e=n(r,a)}while(ds)}if(as.current=Xs,t=null!==ls&&null!==ls.next,ss=0,cs=ls=is=null,us=!1,t)throw Error(o(300));return e}function vs(){var e=0!==hs;return hs=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?is.memoizedState=cs=e:cs=cs.next=e,cs}function bs(){if(null===ls){var e=is.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?is.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?is.memoizedState=cs=e:cs=cs.next=e}return cs}function ws(e,t){return"function"===typeof t?t(e):t}function xs(e){var t=bs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=ls,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var i=a.next;a.next=s.next,s.next=i}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var l=i=null,c=null,u=s;do{var d=u.lane;if((ss&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,i=r):c=c.next=h,is.lanes|=d,Ll|=d}u=u.next}while(null!==u&&u!==s);null===c?i=r:c.next=l,ir(r,t.memoizedState)||(bi=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,is.lanes|=s,Ll|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ss(e){var t=bs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var i=a=a.next;do{s=e(s,i.action),i=i.next}while(i!==a);ir(s,t.memoizedState)||(bi=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function _s(){}function ks(e,t){var n=is,r=bs(),a=t(),s=!ir(r.memoizedState,a);if(s&&(r.memoizedState=a,bi=!0),r=r.queue,Ls(js.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,As(9,Ns.bind(null,n,r,a,t),void 0,null),null===Tl)throw Error(o(349));0!==(30&ss)||Es(n,t,a)}return a}function Es(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=is.updateQueue)?(t={lastEffect:null,stores:null},is.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ns(e,t,n,r){t.value=n,t.getSnapshot=r,Cs(t)&&Ts(e)}function js(e,t,n){return n(function(){Cs(t)&&Ts(e)})}function Cs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ir(e,n)}catch(r){return!0}}function Ts(e){var t=Oo(e,1);null!==t&&nc(t,e,1,-1)}function Ps(e){var t=ys();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ws,lastRenderedState:e},t.queue=e,e=e.dispatch=Ks.bind(null,is,e),[t.memoizedState,e]}function As(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=is.updateQueue)?(t={lastEffect:null,stores:null},is.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Is(){return bs().memoizedState}function Rs(e,t,n,r){var a=ys();is.flags|=e,a.memoizedState=As(1|t,n,void 0,void 0===r?null:r)}function Ds(e,t,n,r){var a=bs();r=void 0===r?null:r;var o=void 0;if(null!==ls){var s=ls.memoizedState;if(o=s.destroy,null!==r&&ms(r,s.deps))return void(a.memoizedState=As(t,n,o,r))}is.flags|=e,a.memoizedState=As(1|t,n,o,r)}function Os(e,t){return Rs(8390656,8,e,t)}function Ls(e,t){return Ds(2048,8,e,t)}function Us(e,t){return Ds(4,2,e,t)}function Ms(e,t){return Ds(4,4,e,t)}function zs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ds(4,4,zs.bind(null,t,e),n)}function Hs(){}function Bs(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ws(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Vs(e,t,n){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,bi=!0),e.memoizedState=n):(ir(n,t)||(n=mt(),is.lanes|=n,Ll|=n,e.baseState=!0),t)}function qs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=os.transition;os.transition={};try{e(!1),t()}finally{bt=n,os.transition=r}}function $s(){return bs().memoizedState}function Js(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Gs(t,n);else if(null!==(n=Do(e,t,n,r))){nc(n,e,r,ec()),Ys(n,t,r)}}function Ks(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Gs(t,a);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,i=o(s,n);if(a.hasEagerState=!0,a.eagerState=i,ir(i,s)){var l=t.interleaved;return null===l?(a.next=a,Ro(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Do(e,t,a,r))&&(nc(n,e,r,a=ec()),Ys(n,t,r))}}function Qs(e){var t=e.alternate;return e===is||null!==t&&t===is}function Gs(e,t){ds=us=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ys(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xs={readContext:Ao,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},Zs={readContext:Ao,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Ao,useEffect:Os,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Rs(4194308,4,zs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Rs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Rs(4,2,e,t)},useMemo:function(e,t){var n=ys();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ys();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Js.bind(null,is,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:Ps,useDebugValue:Hs,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=Ps(!1),t=e[0];return e=qs.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=is,a=ys();if(ao){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Tl)throw Error(o(349));0!==(30&ss)||Es(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Os(js.bind(null,r,s,e),[e]),r.flags|=2048,As(9,Ns.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ys(),t=Tl.identifierPrefix;if(ao){var n=Ya;t=":"+t+"R"+(n=(Ga&~(1<<32-st(Ga)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ps++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ei={readContext:Ao,useCallback:Bs,useContext:Ao,useEffect:Ls,useImperativeHandle:Fs,useInsertionEffect:Us,useLayoutEffect:Ms,useMemo:Ws,useReducer:xs,useRef:Is,useState:function(){return xs(ws)},useDebugValue:Hs,useDeferredValue:function(e){return Vs(bs(),ls.memoizedState,e)},useTransition:function(){return[xs(ws)[0],bs().memoizedState]},useMutableSource:_s,useSyncExternalStore:ks,useId:$s,unstable_isNewReconciler:!1},ti={readContext:Ao,useCallback:Bs,useContext:Ao,useEffect:Ls,useImperativeHandle:Fs,useInsertionEffect:Us,useLayoutEffect:Ms,useMemo:Ws,useReducer:Ss,useRef:Is,useState:function(){return Ss(ws)},useDebugValue:Hs,useDeferredValue:function(e){var t=bs();return null===ls?t.memoizedState=e:Vs(t,ls.memoizedState,e)},useTransition:function(){return[Ss(ws)[0],bs().memoizedState]},useMutableSource:_s,useSyncExternalStore:ks,useId:$s,unstable_isNewReconciler:!1};function ni(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ri(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ai={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),o=zo(r,a);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Fo(e,o,a))&&(nc(t,e,a,r),Ho(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),o=zo(r,a);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Fo(e,o,a))&&(nc(t,e,a,r),Ho(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=zo(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Fo(e,a,r))&&(nc(t,e,r,n),Ho(t,e,r))}};function oi(e,t,n,r,a,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,o))}function si(e,t,n){var r=!1,a=ja,o=t.contextType;return"object"===typeof o&&null!==o?o=Ao(o):(a=Ia(t)?Pa:Ca.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):ja),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ai,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function ii(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ai.enqueueReplaceState(t,t.state,null)}function li(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Uo(e);var o=t.contextType;"object"===typeof o&&null!==o?a.context=Ao(o):(o=Ia(t)?Pa:Ca.current,a.context=Aa(e,o)),a.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ri(e,t,o,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ai.enqueueReplaceState(a,a.state,null),Wo(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ci(e,t){try{var n="",r=t;do{n+=H(r),r=r.return}while(r);var a=n}catch(o){a="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:a,digest:null}}function ui(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function di(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hi="function"===typeof WeakMap?WeakMap:Map;function pi(e,t,n){(n=zo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vl||(Vl=!0,ql=r),di(0,t)},n}function fi(e,t,n){(n=zo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){di(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){di(0,t),"function"!==typeof r&&(null===$l?$l=new Set([this]):$l.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mi(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hi;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function gi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vi(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zo(-1,1)).tag=2,Fo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var yi=w.ReactCurrentOwner,bi=!1;function wi(e,t,n,r){t.child=null===e?So(t,null,n,r):xo(t,e.child,n,r)}function xi(e,t,n,r,a){n=n.render;var o=t.ref;return Po(t,a),r=gs(e,t,n,r,o,a),n=vs(),null===e||bi?(ao&&n&&eo(t),t.flags|=1,wi(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vi(e,t,a))}function Si(e,t,n,r,a){if(null===e){var o=n.type;return"function"!==typeof o||Ic(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,_i(e,t,o,r,a))}if(o=e.child,0===(e.lanes&a)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Vi(e,t,a)}return t.flags|=1,(e=Rc(o,r)).ref=t.ref,e.return=t,t.child=e}function _i(e,t,n,r,a){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(bi=!1,t.pendingProps=r=o,0===(e.lanes&a))return t.lanes=e.lanes,Vi(e,t,a);0!==(131072&e.flags)&&(bi=!0)}}return Ni(e,t,n,r,a)}function ki(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Na(Rl,Il),Il|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Na(Rl,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Na(Rl,Il),Il|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Na(Rl,Il),Il|=r;return wi(e,t,a,n),t.child}function Ei(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ni(e,t,n,r,a){var o=Ia(n)?Pa:Ca.current;return o=Aa(t,o),Po(t,a),n=gs(e,t,n,r,o,a),r=vs(),null===e||bi?(ao&&r&&eo(t),t.flags|=1,wi(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vi(e,t,a))}function ji(e,t,n,r,a){if(Ia(n)){var o=!0;La(t)}else o=!1;if(Po(t,a),null===t.stateNode)Wi(e,t),si(t,n,r),li(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,i=t.memoizedProps;s.props=i;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ao(c):c=Aa(t,c=Ia(n)?Pa:Ca.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==r||l!==c)&&ii(t,s,r,c),Lo=!1;var h=t.memoizedState;s.state=h,Wo(t,r,s,a),l=t.memoizedState,i!==r||h!==l||Ta.current||Lo?("function"===typeof u&&(ri(t,n,u,r),l=t.memoizedState),(i=Lo||oi(t,n,i,r,h,l,c))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=i):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Mo(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ni(t.type,i),s.props=c,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ao(l):l=Aa(t,l=Ia(n)?Pa:Ca.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==d||h!==l)&&ii(t,s,r,l),Lo=!1,h=t.memoizedState,s.state=h,Wo(t,r,s,a);var f=t.memoizedState;i!==d||h!==f||Ta.current||Lo?("function"===typeof p&&(ri(t,n,p,r),f=t.memoizedState),(c=Lo||oi(t,n,c,r,h,f,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ci(e,t,n,r,o,a)}function Ci(e,t,n,r,a,o){Ei(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&Ua(t,n,!1),Vi(e,t,o);r=t.stateNode,yi.current=t;var i=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=xo(t,e.child,null,o),t.child=xo(t,null,i,o)):wi(e,t,i,o),t.memoizedState=r.state,a&&Ua(t,n,!0),t.child}function Ti(e){var t=e.stateNode;t.pendingContext?Da(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Da(0,t.context,!1),Go(e,t.containerInfo)}function Pi(e,t,n,r,a){return fo(),mo(a),t.flags|=256,wi(e,t,n,r),t.child}var Ai,Ii,Ri,Di,Oi={dehydrated:null,treeContext:null,retryLane:0};function Li(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ui(e,t,n){var r,a=t.pendingProps,s=es.current,i=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Na(es,1&s),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==i?(i.childLanes=0,i.pendingProps=l):i=Lc(l,a,0,null),e=Oc(e,a,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Li(n),t.memoizedState=Oi,e):Mi(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,i){if(n)return 256&t.flags?(t.flags&=-257,zi(e,t,i,r=ui(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(s=Oc(s,a,i,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&xo(t,e.child,null,i),t.child.memoizedState=Li(i),t.memoizedState=Oi,s);if(0===(1&t.mode))return zi(e,t,i,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,zi(e,t,i,r=ui(s=Error(o(419)),r,void 0))}if(l=0!==(i&e.childLanes),bi||l){if(null!==(r=Tl)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|i))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Oo(e,a),nc(r,e,a,-1))}return mc(),zi(e,t,i,r=ui(Error(o(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=jc.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ro=ca(a.nextSibling),no=t,ao=!0,oo=null,null!==e&&(Ja[Ka++]=Ga,Ja[Ka++]=Ya,Ja[Ka++]=Qa,Ga=e.id,Ya=e.overflow,Qa=t),t=Mi(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,s,n);if(i){i=a.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Rc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?i=Rc(r,i):(i=Oc(i,l,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=null===(l=e.child.memoizedState)?Li(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Oi,a}return e=(i=e.child).sibling,a=Rc(i,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Mi(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zi(e,t,n,r){return null!==r&&mo(r),xo(t,e.child,null,n),(e=Mi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fi(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),To(e.return,t,n)}function Hi(e,t,n,r,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a)}function Bi(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(wi(e,t,r.children,n),0!==(2&(r=es.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fi(e,n,t);else if(19===e.tag)Fi(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Na(es,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Hi(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ts(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Hi(t,!0,n,null,o);break;case"together":Hi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vi(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qi(e,t){if(!ao)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function $i(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ji(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $i(t),null;case 1:case 17:return Ia(t.type)&&Ra(),$i(t),null;case 3:return r=t.stateNode,Yo(),Ea(Ta),Ea(Ca),rs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(sc(oo),oo=null))),Ii(e,t),$i(t),null;case 5:Zo(t);var a=Qo(Ko.current);if(n=t.type,null!==e&&null!=t.stateNode)Ri(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return $i(t),null}if(e=Qo($o.current),ho(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ha]=t,r[pa]=s,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(a=0;a<Or.length;a++)zr(Or[a],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":G(r,s),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},zr("invalid",r);break;case"textarea":ae(r,s),zr("invalid",r)}for(var l in ye(n,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",""+c]):i.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":$(r),Z(r,s,!0);break;case"textarea":$(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,Ai(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),a=r;break;case"iframe":case"object":case"embed":zr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Or.length;a++)zr(Or[a],e);a=r;break;case"source":zr("error",e),a=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),a=r;break;case"details":zr("toggle",e),a=r;break;case"input":G(e,r),a=Q(e,r),zr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=U({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),zr("invalid",e)}for(s in ye(n,a),c=a)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(i.hasOwnProperty(s)?null!=u&&"onScroll"===s&&zr("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":$(e),Z(e,r,!1);break;case"textarea":$(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return $i(t),null;case 6:if(e&&null!=t.stateNode)Di(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=Qo(Ko.current),Qo($o.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(s=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return $i(t),null;case 13:if(Ea(es),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ao&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,s=!1;else if(s=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[ha]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;$i(t),s=!1}else null!==oo&&(sc(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),$i(t),null);case 4:return Yo(),Ii(e,t),null===e&&Br(t.stateNode.containerInfo),$i(t),null;case 10:return Co(t.type._context),$i(t),null;case 19:if(Ea(es),null===(s=t.memoizedState))return $i(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)qi(s,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,qi(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Na(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Ye()>Bl&&(t.flags|=128,r=!0,qi(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ts(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qi(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ao)return $i(t),null}else 2*Ye()-s.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,qi(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ye(),t.sibling=null,n=es.current,Na(es,r?1&n|2:1&n),t):($i(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Il)&&($i(t),6&t.subtreeFlags&&(t.flags|=8192)):$i(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ki(e,t){switch(to(t),t.tag){case 1:return Ia(t.type)&&Ra(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yo(),Ea(Ta),Ea(Ca),rs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zo(t),null;case 13:if(Ea(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ea(es),null;case 4:return Yo(),null;case 10:return Co(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Ai=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ii=function(){},Ri=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Qo($o.current);var o,s=null;switch(n){case"input":a=Q(e,a),r=Q(e,r),s=[];break;case"select":a=U({},a,{value:void 0}),r=U({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(i.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(i.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zr("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Di=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qi=!1,Gi=!1,Yi="function"===typeof WeakSet?WeakSet:Set,Xi=null;function Zi(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){kc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var o=a.destroy;a.destroy=void 0,void 0!==o&&el(t,n,o)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[ma],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(at,n)}catch(i){}switch(n.tag){case 5:Gi||Zi(n,t);case 6:var r=ul,a=dl;ul=null,hl(e,t,n),dl=a,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Bt(e)):la(ul,n.stateNode));break;case 4:r=ul,a=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=a;break;case 0:case 11:case 14:case 15:if(!Gi&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var o=a,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&el(n,t,s),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Gi&&(Zi(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){kc(n,t,i)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Gi=(r=Gi)||null!==n.memoizedState,hl(e,t,n),Gi=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Yi),t.forEach(function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));pl(s,i,a),ul=null,dl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){kc(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){kc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Zi(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Zi(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){kc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,i=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Y(a,s),be(l,i);var u=be(l,s);for(i=0;i<c.length;i+=2){var d=c[i],h=c[i+1];"style"===d?ge(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):b(a,d,h,u)}switch(l){case"input":X(a,s);break;case"textarea":oe(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ne(a,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[pa]=s}catch(g){kc(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(o(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){kc(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Hl=Ye())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Gi=(u=Gi)||d,ml(t,e),Gi=u):ml(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xi=e,d=e.child;null!==d;){for(h=Xi=d;null!==Xi;){switch(f=(p=Xi).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zi(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){kc(r,n,g)}}break;case 5:Zi(p,p.return);break;case 22:if(null!==p.memoizedState){xl(h);continue}}null!==f?(f.return=p,Xi=f):xl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,i=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",i))}catch(g){kc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&r&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,il(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,il(e),s);break;default:throw Error(o(161))}}catch(i){kc(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Xi=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Xi;){var a=Xi,o=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Qi;if(!s){var i=a.alternate,l=null!==i&&null!==i.memoizedState||Gi;i=Qi;var c=Gi;if(Qi=s,(Gi=l)&&!c)for(Xi=a;null!==Xi;)l=(s=Xi).child,22===s.tag&&null!==s.memoizedState?Sl(a):null!==l?(l.return=s,Xi=l):Sl(a);for(;null!==o;)Xi=o,bl(o,t,n),o=o.sibling;Xi=a,Qi=i,Gi=c}wl(e)}else 0!==(8772&a.subtreeFlags)&&null!==o?(o.return=a,Xi=o):wl(e)}}function wl(e){for(;null!==Xi;){var t=Xi;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Gi||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Gi)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ni(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Vo(t,s,r);break;case 3:var i=t.updateQueue;if(null!==i){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vo(t,i,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(o(163))}Gi||512&t.flags&&al(t)}catch(p){kc(t,t.return,p)}}if(t===e){Xi=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xi=n;break}Xi=t.return}}function xl(e){for(;null!==Xi;){var t=Xi;if(t===e){Xi=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xi=n;break}Xi=t.return}}function Sl(e){for(;null!==Xi;){var t=Xi;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){kc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){kc(t,a,l)}}var o=t.return;try{al(t)}catch(l){kc(t,o,l)}break;case 5:var s=t.return;try{al(t)}catch(l){kc(t,s,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Xi=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Xi=i;break}Xi=t.return}}var _l,kl=Math.ceil,El=w.ReactCurrentDispatcher,Nl=w.ReactCurrentOwner,jl=w.ReactCurrentBatchConfig,Cl=0,Tl=null,Pl=null,Al=0,Il=0,Rl=ka(0),Dl=0,Ol=null,Ll=0,Ul=0,Ml=0,zl=null,Fl=null,Hl=0,Bl=1/0,Wl=null,Vl=!1,ql=null,$l=null,Jl=!1,Kl=null,Ql=0,Gl=0,Yl=null,Xl=-1,Zl=0;function ec(){return 0!==(6&Cl)?Ye():-1!==Xl?Xl:Xl=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Al?Al&-Al:null!==go.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function nc(e,t,n,r){if(50<Gl)throw Gl=0,Yl=null,Error(o(185));vt(e,n,r),0!==(2&Cl)&&e===Tl||(e===Tl&&(0===(2&Cl)&&(Ul|=n),4===Dl&&ic(e,Al)),rc(e,r),1===n&&0===Cl&&0===(1&t.mode)&&(Bl=Ye()+500,za&&Ba()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),i=1<<s,l=a[s];-1===l?0!==(i&n)&&0===(i&r)||(a[s]=pt(i,t)):l<=t&&(e.expiredLanes|=i),o&=~i}}(e,t);var r=ht(e,e===Tl?Al:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){za=!0,Ha(e)}(lc.bind(null,e)):Ha(lc.bind(null,e)),sa(function(){0===(6&Cl)&&Ba()}),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Xl=-1,Zl=0,0!==(6&Cl))throw Error(o(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?Al:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=Cl;Cl|=2;var s=fc();for(Tl===e&&Al===t||(Wl=null,Bl=Ye()+500,hc(e,t));;)try{yc();break}catch(l){pc(e,l)}jo(),El.current=s,Cl=a,null!==Pl?t=0:(Tl=null,Al=0,t=Dl)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=oc(e,a))),1===t)throw n=Ol,hc(e,0),ic(e,r),rc(e,Ye()),n;if(6===t)ic(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],o=a.getSnapshot;a=a.value;try{if(!ir(o(),a))return!1}catch(i){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(s=ft(e))&&(r=s,t=oc(e,s))),1===t))throw n=Ol,hc(e,0),ic(e,r),rc(e,Ye()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:xc(e,Fl,Wl);break;case 3:if(ic(e,r),(130023424&r)===r&&10<(t=Hl+500-Ye())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(xc.bind(null,e,Fl,Wl),t);break}xc(e,Fl,Wl);break;case 4:if(ic(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-st(r);s=1<<i,(i=t[i])>a&&(a=i),r&=~s}if(r=a,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=ra(xc.bind(null,e,Fl,Wl),r);break}xc(e,Fl,Wl);break;default:throw Error(o(329))}}}return rc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function oc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Fl,Fl=n,null!==t&&sc(t)),e}function sc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function ic(e,t){for(t&=~Ml,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Cl))throw Error(o(327));Sc();var t=ht(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Ol,hc(e,0),ic(e,t),rc(e,Ye()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Fl,Wl),rc(e,Ye()),null}function cc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Bl=Ye()+500,za&&Ba())}}function uc(e){null!==Kl&&0===Kl.tag&&0===(6&Cl)&&Sc();var t=Cl;Cl|=1;var n=jl.transition,r=bt;try{if(jl.transition=null,bt=1,e)return e()}finally{bt=r,jl.transition=n,0===(6&(Cl=t))&&Ba()}}function dc(){Il=Rl.current,Ea(Rl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Pl)for(n=Pl.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ra();break;case 3:Yo(),Ea(Ta),Ea(Ca),rs();break;case 5:Zo(r);break;case 4:Yo();break;case 13:case 19:Ea(es);break;case 10:Co(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Tl=e,Pl=e=Rc(e.current,null),Al=Il=t,Dl=0,Ol=null,Ml=Ul=Ll=0,Fl=zl=null,null!==Io){for(t=0;t<Io.length;t++)if(null!==(r=(n=Io[t]).interleaved)){n.interleaved=null;var a=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=a,r.next=s}n.pending=r}Io=null}return e}function pc(e,t){for(;;){var n=Pl;try{if(jo(),as.current=Xs,us){for(var r=is.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}us=!1}if(ss=0,cs=ls=is=null,ds=!1,hs=0,Nl.current=null,null===n||null===n.return){Dl=1,Ol=t,Pl=null;break}e:{var s=e,i=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gi(i);if(null!==f){f.flags&=-257,vi(f,i,l,0,t),1&f.mode&&mi(s,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mi(s,u,t),mc();break e}c=Error(o(426))}else if(ao&&1&l.mode){var v=gi(i);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vi(v,i,l,0,t),mo(ci(c,l));break e}}s=c=ci(c,l),4!==Dl&&(Dl=2),null===zl?zl=[s]:zl.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Bo(s,pi(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===$l||!$l.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Bo(s,fi(s,l,t));break e}}s=s.return}while(null!==s)}wc(n)}catch(w){t=w,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function fc(){var e=El.current;return El.current=Xs,null===e?Xs:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Tl||0===(268435455&Ll)&&0===(268435455&Ul)||ic(Tl,Al)}function gc(e,t){var n=Cl;Cl|=2;var r=fc();for(Tl===e&&Al===t||(Wl=null,hc(e,t));;)try{vc();break}catch(a){pc(e,a)}if(jo(),Cl=n,El.current=r,null!==Pl)throw Error(o(261));return Tl=null,Al=0,Dl}function vc(){for(;null!==Pl;)bc(Pl)}function yc(){for(;null!==Pl&&!Qe();)bc(Pl)}function bc(e){var t=_l(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?wc(e):Pl=t,Nl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ji(n,t,Il)))return void(Pl=n)}else{if(null!==(n=Ki(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Dl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Dl&&(Dl=5)}function xc(e,t,n){var r=bt,a=jl.transition;try{jl.transition=null,bt=1,function(e,t,n,r){do{Sc()}while(null!==Kl);if(0!==(6&Cl))throw Error(o(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),o=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~o}}(e,s),e===Tl&&(Pl=Tl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Jl||(Jl=!0,Tc(tt,function(){return Sc(),null})),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=jl.transition,jl.transition=null;var i=bt;bt=1;var l=Cl;Cl|=4,Nl.current=null,function(e,t){if(ea=Vt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(x){n=null;break e}var i=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(l=i+a),h!==s||0!==r&&3!==h.nodeType||(c=i+r),3===h.nodeType&&(i+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===a&&(l=i),p===s&&++d===r&&(c=i),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Vt=!1,Xi=t;null!==Xi;)if(e=(t=Xi).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xi=e;else for(;null!==Xi;){t=Xi;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ni(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(x){kc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Xi=e;break}Xi=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ta),Vt=!!ea,ta=ea=null,e.current=n,yl(n,e,a),Ge(),Cl=l,bt=i,jl.transition=s}else e.current=n;if(Jl&&(Jl=!1,Kl=e,Ql=a),s=e.pendingLanes,0===s&&($l=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Vl)throw Vl=!1,e=ql,ql=null,e;0!==(1&Ql)&&0!==e.tag&&Sc(),s=e.pendingLanes,0!==(1&s)?e===Yl?Gl++:(Gl=0,Yl=e):Gl=0,Ba()}(e,t,n,r)}finally{jl.transition=a,bt=r}return null}function Sc(){if(null!==Kl){var e=wt(Ql),t=jl.transition,n=bt;try{if(jl.transition=null,bt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Ql=0,0!==(6&Cl))throw Error(o(331));var a=Cl;for(Cl|=4,Xi=e.current;null!==Xi;){var s=Xi,i=s.child;if(0!==(16&Xi.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xi=u;null!==Xi;){var d=Xi;switch(d.tag){case 0:case 11:case 15:nl(8,d,s)}var h=d.child;if(null!==h)h.return=d,Xi=h;else for(;null!==Xi;){var p=(d=Xi).sibling,f=d.return;if(ol(d),d===u){Xi=null;break}if(null!==p){p.return=f,Xi=p;break}Xi=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xi=s}}if(0!==(2064&s.subtreeFlags)&&null!==i)i.return=s,Xi=i;else e:for(;null!==Xi;){if(0!==(2048&(s=Xi).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Xi=y;break e}Xi=s.return}}var b=e.current;for(Xi=b;null!==Xi;){var w=(i=Xi).child;if(0!==(2064&i.subtreeFlags)&&null!==w)w.return=i,Xi=w;else e:for(i=b;null!==Xi;){if(0!==(2048&(l=Xi).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(S){kc(l,l.return,S)}if(l===i){Xi=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Xi=x;break e}Xi=l.return}}if(Cl=a,Ba(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(at,e)}catch(S){}r=!0}return r}finally{bt=n,jl.transition=t}}return!1}function _c(e,t,n){e=Fo(e,t=pi(0,t=ci(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function kc(e,t,n){if(3===e.tag)_c(e,e,n);else for(;null!==t;){if(3===t.tag){_c(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===$l||!$l.has(r))){t=Fo(t,e=fi(t,e=ci(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Ec(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Al&n)===n&&(4===Dl||3===Dl&&(130023424&Al)===Al&&500>Ye()-Hl?hc(e,0):Ml|=n),rc(e,t)}function Nc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Oo(e,t))&&(vt(e,t,n),rc(e,n))}function jc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Nc(e,n)}function Tc(e,t){return Je(e,t)}function Pc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Pc(e,t,n,r)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,r,a,s){var i=2;if(r=e,"function"===typeof e)Ic(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case _:return Oc(n.children,a,s,t);case k:i=8,a|=8;break;case E:return(e=Ac(12,n,t,2|a)).elementType=E,e.lanes=s,e;case T:return(e=Ac(13,n,t,a)).elementType=T,e.lanes=s,e;case P:return(e=Ac(19,n,t,a)).elementType=P,e.lanes=s,e;case R:return Lc(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case N:i=10;break e;case j:i=9;break e;case C:i=11;break e;case A:i=14;break e;case I:i=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Ac(i,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Oc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Mc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,r,a,o,s,i,l){return e=new zc(e,t,n,i,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Ac(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uo(o),e}function Hc(e){if(!e)return ja;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ia(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ia(n))return Oa(e,n,t)}return t}function Bc(e,t,n,r,a,o,s,i,l){return(e=Fc(n,r,!0,e,0,o,0,i,l)).context=Hc(null),n=e.current,(o=zo(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Fo(n,o,a),e.current.lanes=a,vt(e,a,r),rc(e,r),e}function Wc(e,t,n,r){var a=t.current,o=ec(),s=tc(a);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=zo(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Fo(a,t,s))&&(nc(e,a,s,o),Ho(e,a,s)),s}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function $c(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}_l=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)bi=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bi=!1,function(e,t,n){switch(t.tag){case 3:Ti(t),fo();break;case 5:Xo(t);break;case 1:Ia(t.type)&&La(t);break;case 4:Go(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Na(_o,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Na(es,1&es.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ui(e,t,n):(Na(es,1&es.current),null!==(e=Vi(e,t,n))?e.sibling:null);Na(es,1&es.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bi(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Na(es,es.current),r)break;return null;case 22:case 23:return t.lanes=0,ki(e,t,n)}return Vi(e,t,n)}(e,t,n);bi=0!==(131072&e.flags)}else bi=!1,ao&&0!==(1048576&t.flags)&&Za(t,$a,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wi(e,t),e=t.pendingProps;var a=Aa(t,Ca.current);Po(t,n),a=gs(null,t,r,e,a,n);var s=vs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ia(r)?(s=!0,La(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Uo(t),a.updater=ai,t.stateNode=a,a._reactInternals=t,li(t,r,e,n),t=Ci(null,t,r,!0,s,n)):(t.tag=0,ao&&s&&eo(t),wi(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wi(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(r),e=ni(r,e),a){case 0:t=Ni(null,t,r,e,n);break e;case 1:t=ji(null,t,r,e,n);break e;case 11:t=xi(null,t,r,e,n);break e;case 14:t=Si(null,t,r,ni(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ni(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 1:return r=t.type,a=t.pendingProps,ji(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 3:e:{if(Ti(t),null===e)throw Error(o(387));r=t.pendingProps,a=(s=t.memoizedState).element,Mo(e,t),Wo(t,r,null,n);var i=t.memoizedState;if(r=i.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Pi(e,t,r,n,a=ci(Error(o(423)),t));break e}if(r!==a){t=Pi(e,t,r,n,a=ci(Error(o(424)),t));break e}for(ro=ca(t.stateNode.containerInfo.firstChild),no=t,ao=!0,oo=null,n=So(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===a){t=Vi(e,t,n);break e}wi(e,t,r,n)}t=t.child}return t;case 5:return Xo(t),null===e&&co(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,i=a.children,na(r,a)?i=null:null!==s&&na(r,s)&&(t.flags|=32),Ei(e,t),wi(e,t,i,n),t.child;case 6:return null===e&&co(t),null;case 13:return Ui(e,t,n);case 4:return Go(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xo(t,null,r,n):wi(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,xi(e,t,r,a=t.elementType===r?a:ni(r,a),n);case 7:return wi(e,t,t.pendingProps,n),t.child;case 8:case 12:return wi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Na(_o,r._currentValue),r._currentValue=i,null!==s)if(ir(s.value,i)){if(s.children===a.children&&!Ta.current){t=Vi(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){i=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=zo(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),To(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)i=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(i=s.return))throw Error(o(341));i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),To(i,n,t),i=s.sibling}else i=s.child;if(null!==i)i.return=s;else for(i=s;null!==i;){if(i===t){i=null;break}if(null!==(s=i.sibling)){s.return=i.return,i=s;break}i=i.return}s=i}wi(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Po(t,n),r=r(a=Ao(a)),t.flags|=1,wi(e,t,r,n),t.child;case 14:return a=ni(r=t.type,t.pendingProps),Si(e,t,r,a=ni(r.type,a),n);case 15:return _i(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ni(r,a),Wi(e,t),t.tag=1,Ia(r)?(e=!0,La(t)):e=!1,Po(t,n),si(t,r,a),li(t,r,a,n),Ci(null,t,r,!0,e,n);case 19:return Bi(e,t,n);case 22:return ki(e,t,n)}throw Error(o(156,t.tag))};var Jc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Gc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,a){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof a){var i=a;a=function(){var e=Vc(s);i.call(e)}}Wc(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var o=r;r=function(){var e=Vc(s);o.call(e)}}var s=Bc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[fa]=s.current,Br(8===e.nodeType?e.parentNode:e),uc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var i=r;r=function(){var e=Vc(l);i.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[fa]=l.current,Br(8===e.nodeType?e.parentNode:e),uc(function(){Wc(t,l,n,r)}),l}(n,t,e,a,r);return Vc(s)}Qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Wc(e,t,null,null)},Qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Wc(null,e,null,null)}),t[fa]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Ut(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Ye()),0===(6&Cl)&&(Bl=Ye()+500,Ba()))}break;case 13:uc(function(){var t=Oo(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),$c(e,1)}},St=function(e){if(13===e.tag){var t=Oo(e,134217728);if(null!==t)nc(t,e,134217728,ec());$c(e,134217728)}},_t=function(e){if(13===e.tag){var t=tc(e),n=Oo(e,t);if(null!==n)nc(n,e,t,ec());$c(e,t)}},kt=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=xa(r);if(!a)throw Error(o(90));J(r),X(r,a)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,Te=uc;var eu={usingClientEntryPoint:!1,Events:[ba,wa,xa,Ne,je,cc]},tu={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{at=ru.inject(nu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Gc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Gc(e))throw Error(o(299));var n=!1,r="",a=Jc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,Br(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(o(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Gc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",i=Jc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(i=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,a,0,s,i),e[fa]=t.current,Br(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Qc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(o(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function o(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l=n(43),c=n(391);function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const d=["sri"],h=["page"],p=["page","matches"],f=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],m=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],g=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var v="popstate";function y(){return E(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return S("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:_(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function b(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function w(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return i(i({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?k(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function _(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function k(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function E(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:a=document.defaultView,v5Compat:o=!1}=r,s=a.history,l="POP",c=null,u=d();function d(){return(s.state||{idx:null}).idx}function h(){l="POP";let e=d(),t=null==e?null:e-u;u=e,c&&c({action:l,location:f.location,delta:t})}function p(e){return N(e)}null==u&&(u=0,s.replaceState(i(i({},s.state),{},{idx:u}),""));let f={get action(){return l},get location(){return e(a,s)},listen(e){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(v,h),c=e,()=>{a.removeEventListener(v,h),c=null}},createHref:e=>t(a,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let r=S(f.location,e,t);n&&n(r,e),u=d()+1;let i=x(r,u),h=f.createHref(r);try{s.pushState(i,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;a.location.assign(h)}o&&c&&c({action:l,location:f.location,delta:1})},replace:function(e,t){l="REPLACE";let r=S(f.location,e,t);n&&n(r,e),u=d();let a=x(r,u),i=f.createHref(r);s.replaceState(a,"",i),o&&c&&c({action:l,location:f.location,delta:0})},go:e=>s.go(e)};return f}function N(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),b(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:_(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function j(e,t){return C(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function C(e,t,n,r){let a=W(("string"===typeof t?k(t):t).pathname||"/",n);if(null==a)return null;let o=T(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let s=null;for(let i=0;null==s&&i<o.length;++i){let e=B(a);s=z(o[i],e,r)}return s}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(e,o){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,i=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&s)return;b(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=K([r,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(b(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),T(e.children,t,u,c,s)),(null!=e.path||e.index)&&t.push({path:c,score:M(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of P(e.path))o(e,t,!0,r);else o(e,t)}),t}function P(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return a?[o,""]:[o];let s=P(r.join("/")),i=[];return i.push(...s.map(e=>""===e?o:[o,e].join("/"))),a&&i.push(...s),i.map(t=>e.startsWith("/")&&""===t?"/":t)}var A=/^:[\w-]+$/,I=3,R=2,D=1,O=10,L=-2,U=e=>"*"===e;function M(e,t){let n=e.split("/"),r=n.length;return n.some(U)&&(r+=L),t&&(r+=R),n.filter(e=>!U(e)).reduce((e,t)=>e+(A.test(t)?I:""===t?D:O),r)}function z(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,a={},o="/",s=[];for(let i=0;i<r.length;++i){let e=r[i],l=i===r.length-1,c="/"===o?t:t.slice(o.length)||"/",u=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=F({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),s.push({params:a,pathname:K([o,u.pathname]),pathnameBase:Q(K([o,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(o=K([o,u.pathnameBase]))}return s}function F(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=H(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],s=o.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=i[n]||"";s=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=i[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:o,pathnameBase:s,pattern:e}}function H(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function B(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return w(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function W(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function V(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function q(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function $(e){let t=q(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function J(e,t,n){let r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=k(e):(r=i({},e),b(!r.pathname||!r.pathname.includes("?"),V("?","pathname","search",r)),b(!r.pathname||!r.pathname.includes("#"),V("#","pathname","hash",r)),b(!r.search||!r.search.includes("#"),V("#","search","hash",r)));let o,s=""===e||""===r.pathname,l=s?"/":r.pathname;if(null==l)o=n;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:a=""}="string"===typeof e?k(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:G(r),hash:Y(a)}}(r,o),u=l&&"/"!==l&&l.endsWith("/"),d=(s||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}var K=e=>e.join("/").replace(/\/\/+/g,"/"),Q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),G=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function X(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Z=["POST","PUT","PATCH","DELETE"],ee=(new Set(Z),["GET",...Z]);new Set(ee),Symbol("ResetLoaderData");var te=l.createContext(null);te.displayName="DataRouter";var ne=l.createContext(null);ne.displayName="DataRouterState";var re=l.createContext(!1);var ae=l.createContext({isTransitioning:!1});ae.displayName="ViewTransition";var oe=l.createContext(new Map);oe.displayName="Fetchers";var se=l.createContext(null);se.displayName="Await";var ie=l.createContext(null);ie.displayName="Navigation";var le=l.createContext(null);le.displayName="Location";var ce=l.createContext({outlet:null,matches:[],isDataRoute:!1});ce.displayName="Route";var ue=l.createContext(null);ue.displayName="RouteError";function de(){return null!=l.useContext(le)}function he(){return b(de(),"useLocation() may be used only in the context of a <Router> component."),l.useContext(le).location}var pe="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function fe(e){l.useContext(ie).static||l.useLayoutEffect(e)}function me(){let{isDataRoute:e}=l.useContext(ce);return e?function(){let{router:e}=Ee("useNavigate"),t=je("useNavigate"),n=l.useRef(!1);fe(()=>{n.current=!0});let r=l.useCallback(async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(n.current,pe),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,i({fromRouteId:t},a)))},[e,t]);return r}():function(){b(de(),"useNavigate() may be used only in the context of a <Router> component.");let e=l.useContext(te),{basename:t,navigator:n}=l.useContext(ie),{matches:r}=l.useContext(ce),{pathname:a}=he(),o=JSON.stringify($(r)),s=l.useRef(!1);fe(()=>{s.current=!0});let i=l.useCallback(function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(w(s.current,pe),!s.current)return;if("number"===typeof r)return void n.go(r);let l=J(r,JSON.parse(o),a,"path"===i.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:K([t,l.pathname])),(i.replace?n.replace:n.push)(l,i.state,i)},[t,n,o,a,e]);return i}()}l.createContext(null);function ge(){let{matches:e}=l.useContext(ce),t=e[e.length-1];return t?t.params:{}}function ve(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=l.useContext(ce),{pathname:r}=he(),a=JSON.stringify($(n));return l.useMemo(()=>J(e,JSON.parse(a),r,"path"===t),[e,a,r,t])}function ye(e,t,n,r,a){b(de(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=l.useContext(ie),{matches:s}=l.useContext(ce),c=s[s.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let e=p&&p.path||"";Pe(d,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=he();if(t){var g;let e="string"===typeof t?k(t):t;b("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let v=f.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=j(e,{pathname:y});w(p||null!=x,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),w(null==x||void 0!==x[x.length-1].route.element||void 0!==x[x.length-1].route.Component||void 0!==x[x.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let S=_e(x&&x.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:K([h,o.encodeLocation?o.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:K([h,o.encodeLocation?o.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),s,n,r,a);return t&&S?l.createElement(le.Provider,{value:{location:i({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},S):S}function be(){let e=Ce(),t=X(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=l.createElement(l.Fragment,null,l.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),l.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",l.createElement("code",{style:o},"ErrorBoundary")," or"," ",l.createElement("code",{style:o},"errorElement")," prop on your route.")),l.createElement(l.Fragment,null,l.createElement("h2",null,"Unexpected Application Error!"),l.createElement("h3",{style:{fontStyle:"italic"}},t),n?l.createElement("pre",{style:a},n):null,s)}var we=l.createElement(be,null),xe=class extends l.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?l.createElement(ce.Provider,{value:this.props.routeContext},l.createElement(ue.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Se(e){let{routeContext:t,match:n,children:r}=e,a=l.useContext(te);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),l.createElement(ce.Provider,{value:t},r)}function _e(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let a=e,o=null===n||void 0===n?void 0:n.errors;if(null!=o){let e=a.findIndex(e=>e.route.id&&void 0!==(null===o||void 0===o?void 0:o[e.route.id]));b(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(o).join(","))),a=a.slice(0,Math.min(a.length,e+1))}let s=!1,i=-1;if(n)for(let l=0;l<a.length;l++){let e=a[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(i=l),e.route.id){let{loaderData:t,errors:r}=n,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||o){s=!0,a=i>=0?a.slice(0,i+1):[a[0]];break}}}return a.reduceRight((e,c,u)=>{let d,h=!1,p=null,f=null;n&&(d=o&&c.route.id?o[c.route.id]:void 0,p=c.route.errorElement||we,s&&(i<0&&0===u?(Pe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):i===u&&(h=!0,f=c.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),g=()=>{let t;return t=d?p:h?f:c.route.Component?l.createElement(c.route.Component,null):c.route.element?c.route.element:e,l.createElement(Se,{match:c,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?l.createElement(xe,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):g()},null)}function ke(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ee(e){let t=l.useContext(te);return b(t,ke(e)),t}function Ne(e){let t=l.useContext(ne);return b(t,ke(e)),t}function je(e){let t=function(e){let t=l.useContext(ce);return b(t,ke(e)),t}(e),n=t.matches[t.matches.length-1];return b(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Ce(){var e;let t=l.useContext(ue),n=Ne("useRouteError"),r=je("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var Te={};function Pe(e,t,n){t||Te[e]||(Te[e]=!0,w(!1,n))}var Ae={};function Ie(e,t){e||Ae[t]||(Ae[t]=!0,console.warn(t))}l.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:a}=e;return ye(t,void 0,r,a,n)});function Re(e){let{to:t,replace:n,state:r,relative:a}=e;b(de(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=l.useContext(ie);w(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=l.useContext(ce),{pathname:i}=he(),c=me(),u=J(t,$(s),i,"path"===a),d=JSON.stringify(u);return l.useEffect(()=>{c(JSON.parse(d),{replace:n,state:r,relative:a})},[c,d,a,n,r]),null}function De(e){b(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Oe(e){let{basename:t="/",children:n=null,location:r,navigationType:a="POP",navigator:o,static:s=!1}=e;b(!de(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=t.replace(/^\/*/,"/"),c=l.useMemo(()=>({basename:i,navigator:o,static:s,future:{}}),[i,o,s]);"string"===typeof r&&(r=k(r));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:f="default"}=r,m=l.useMemo(()=>{let e=W(u,i);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:f},navigationType:a}},[i,u,d,h,p,f,a]);return w(null!=m,'<Router basename="'.concat(i,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:l.createElement(ie.Provider,{value:c},l.createElement(le.Provider,{children:n,value:m}))}function Le(e){let{children:t,location:n}=e;return ye(Ue(t),n)}l.Component;function Ue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return l.Children.forEach(e,(e,r)=>{if(!l.isValidElement(e))return;let a=[...t,r];if(e.type===l.Fragment)return void n.push.apply(n,Ue(e.props.children,a));b(e.type===De,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),b(!e.props.index||!e.props.children,"An index route cannot have child routes.");let o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Ue(e.props.children,a)),n.push(o)}),n}var Me="get",ze="application/x-www-form-urlencoded";function Fe(e){return null!=e&&"string"===typeof e.tagName}function He(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}var Be=null;var We=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ve(e){return null==e||We.has(e)?e:(w(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(ze,'"')),null)}function qe(e,t){let n,r,a,o,s;if(Fe(i=e)&&"form"===i.tagName.toLowerCase()){let s=e.getAttribute("action");r=s?W(s,t):null,n=e.getAttribute("method")||Me,a=Ve(e.getAttribute("enctype"))||ze,o=new FormData(e)}else if(function(e){return Fe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Fe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let s=e.form;if(null==s)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let i=e.getAttribute("formaction")||s.getAttribute("action");if(r=i?W(i,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Me,a=Ve(e.getAttribute("formenctype"))||Ve(s.getAttribute("enctype"))||ze,o=new FormData(s,e),!function(){if(null===Be)try{new FormData(document.createElement("form"),0),Be=!1}catch(e){Be=!0}return Be}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";o.append("".concat(e,"x"),"0"),o.append("".concat(e,"y"),"0")}else t&&o.append(t,r)}}else{if(Fe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Me,r=null,a=ze,s=e}var i;return o&&"text/plain"===a&&(s=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function $e(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Je(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===W(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function Ke(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Qe(e){return null!=e&&"string"===typeof e.page}function Ge(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ye(e,t,n,r,a,o){let s=(e,t)=>!n[t]||e.route.id!==n[t].route.id,i=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===o?t.filter((e,t)=>s(e,t)||i(e,t)):"data"===o?t.filter((t,o)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(s(t,o)||i(t,o))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function Xe(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1),[...new Set(r)];var r}function Ze(e,t){let n=new Set,r=new Set(t);return e.reduce((e,a)=>{if(t&&!Qe(a)&&"script"===a.as&&a.href&&r.has(a.href))return e;let o=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(a));return n.has(o)||(n.add(o),e.push({key:o,link:a})),e},[])}function et(e,t){return"lazy"===e.mode&&!0===t}function tt(){let e=l.useContext(te);return $e(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function nt(){let e=l.useContext(ne);return $e(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var rt=l.createContext(void 0);function at(){let e=l.useContext(rt);return $e(e,"You must render this element inside a <HydratedRouter> element"),e}function ot(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function st(e,t,n){if(n&&!ut)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}rt.displayName="FrameworkContext";function it(e){let{page:t}=e,n=u(e,h),{router:r}=tt(),a=l.useMemo(()=>j(r.routes,t,r.basename),[r.routes,t,r.basename]);return a?l.createElement(ct,i({page:t,matches:a},n)):null}function lt(e){let{manifest:t,routeModules:n}=at(),[r,a]=l.useState([]);return l.useEffect(()=>{let r=!1;return async function(e,t,n){return Ze((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await Ke(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Ge).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?i(i({},e),{},{rel:"prefetch",as:"style"}):i(i({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||a(e)}),()=>{r=!0}},[e,t,n]),r}function ct(e){let{page:t,matches:n}=e,r=u(e,p),a=he(),{manifest:o,routeModules:s}=at(),{basename:c}=tt(),{loaderData:d,matches:h}=nt(),f=l.useMemo(()=>Ye(t,n,h,o,a,"data"),[t,n,h,o,a]),m=l.useMemo(()=>Ye(t,n,h,o,a,"assets"),[t,n,h,o,a]),g=l.useMemo(()=>{if(t===a.pathname+a.search+a.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let a=o.routes[t.route.id];a&&a.hasLoader&&(!f.some(e=>e.route.id===t.route.id)&&t.route.id in d&&null!==(n=s[t.route.id])&&void 0!==n&&n.shouldRevalidate||a.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let i=Je(t,c,"data");return r&&e.size>0&&i.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[i.pathname+i.search]},[c,d,a,o,f,n,t,s]),v=l.useMemo(()=>Xe(m,o),[m,o]),y=lt(m);return l.createElement(l.Fragment,null,g.map(e=>l.createElement("link",i({key:e,rel:"prefetch",as:"fetch",href:e},r))),v.map(e=>l.createElement("link",i({key:e,rel:"modulepreload",href:e},r))),y.map(e=>{let{key:t,link:n}=e;return l.createElement("link",i({key:t,nonce:r.nonce},n))}))}var ut=!1;function dt(e){let{manifest:t,serverHandoffString:n,isSpaMode:r,renderMeta:a,routeDiscovery:o,ssr:s}=at(),{router:c,static:h,staticContext:p}=tt(),{matches:f}=nt(),m=l.useContext(re),g=et(o,s);a&&(a.didRenderScripts=!0);let v=st(f,null,r);l.useEffect(()=>{ut=!0},[]);let y=l.useMemo(()=>{var r;if(m)return null;let a=p?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=h?"".concat(null!==(r=t.hmr)&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let r="route".concat(n),a=t.routes[e.route.id];$e(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:o,clientLoaderModule:s,clientMiddlewareModule:i,hydrateFallbackModule:l,module:c}=a,u=[...o?[{module:o,varName:"".concat(r,"_clientAction")}]:[],...s?[{module:s,varName:"".concat(r,"_clientLoader")}]:[],...i?[{module:i,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=u(e,d),a=new Set(t.state.matches.map(e=>e.route.id)),o=t.state.location.pathname.split("/").filter(Boolean),s=["/"];for(o.pop();o.length>0;)s.push("/".concat(o.join("/"))),o.pop();s.forEach(e=>{let n=j(t.routes,e,t.basename);n&&n.forEach(e=>a.add(e.route.id))});let l=[...a].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return i(i({},r),{},{routes:l,sri:!!n||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return l.createElement(l.Fragment,null,l.createElement("script",i(i({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:void 0})),l.createElement("script",i(i({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),b=ut||m?[]:(w=t.entry.imports.concat(Xe(v,t,{includeHydrateFallback:!0})),[...new Set(w)]);var w;let x="object"===typeof t.sri?t.sri:{};return Ie(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),ut||m?null:l.createElement(l.Fragment,null,"object"===typeof t.sri?l.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:x})}}):null,g?null:l.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:x[t.url],suppressHydrationWarning:!0}),l.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:x[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>l.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:x[t],suppressHydrationWarning:!0})),y)}function ht(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}l.Component;function pt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,a=l.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(X(t))return l.createElement(ft,{title:"Unhandled Thrown Response!"},l.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),a);if(t instanceof Error)r=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);r=new Error(e)}return l.createElement(ft,{title:"Application Error!",isOutsideRemixApp:n},l.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),l.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),a)}function ft(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:a,children:o}=e,{routeModules:s}=at();return null!==(t=s.root)&&void 0!==t&&t.Layout&&!a?o:l.createElement("html",{lang:"en"},l.createElement("head",null,l.createElement("meta",{charSet:"utf-8"}),l.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),l.createElement("title",null,n)),l.createElement("body",null,l.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},o,r?l.createElement(dt,null):null)))}var mt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{mt&&(window.__reactRouterVersion="7.9.2")}catch(yo){}function gt(e){let{basename:t,children:n,window:r}=e,a=l.useRef();null==a.current&&(a.current=y({window:r,v5Compat:!0}));let o=a.current,[s,i]=l.useState({action:o.action,location:o.location}),c=l.useCallback(e=>{l.startTransition(()=>i(e))},[i]);return l.useLayoutEffect(()=>o.listen(c),[o,c]),l.createElement(Oe,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:o})}var vt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yt=l.forwardRef(function(e,t){let n,{onClick:r,discover:a="render",prefetch:o="none",relative:s,reloadDocument:c,replace:d,state:h,target:p,to:m,preventScrollReset:g,viewTransition:v}=e,y=u(e,f),{basename:x}=l.useContext(ie),S="string"===typeof m&&vt.test(m),k=!1;if("string"===typeof m&&S&&(n=m,mt))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=W(t.pathname,x);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:k=!0}catch(yo){w(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let E=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(de(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=l.useContext(ie),{hash:a,pathname:o,search:s}=ve(e,{relative:t}),i=o;return"/"!==n&&(i="/"===o?n:K([n,o])),r.createHref({pathname:i,search:s,hash:a})}(m,{relative:s}),[N,j,C]=function(e,t){let n=l.useContext(rt),[r,a]=l.useState(!1),[o,s]=l.useState(!1),{onFocus:i,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=l.useRef(null);l.useEffect(()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),l.useEffect(()=>{if(r){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[r]);let f=()=>{a(!0)},m=()=>{a(!1),s(!1)};return n?"intent"!==e?[o,p,{}]:[o,p,{onFocus:ot(i,f),onBlur:ot(c,m),onMouseEnter:ot(u,f),onMouseLeave:ot(d,m),onTouchStart:ot(h,f)}]:[!1,p,{}]}(o,y),T=function(e){let{target:t,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=me(),c=he(),u=ve(e,{relative:o});return l.useCallback(l=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(l,t)){l.preventDefault();let t=void 0!==n?n:_(c)===_(u);i(e,{replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:s})}},[c,i,u,n,r,t,e,a,o,s])}(m,{replace:d,state:h,target:p,preventScrollReset:g,relative:s,viewTransition:v});let P=l.createElement("a",i(i(i({},y),C),{},{href:n||E,onClick:k||c?r:function(e){r&&r(e),e.defaultPrevented||T(e)},ref:ht(t,j),target:p,"data-discover":S||"render"!==a?void 0:"true"}));return N&&!S?l.createElement(l.Fragment,null,P,l.createElement(it,{page:E})):P});yt.displayName="Link",l.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:o=!1,style:s,to:c,viewTransition:d,children:h}=e,p=u(e,m),f=ve(c,{relative:p.relative}),g=he(),v=l.useContext(ne),{navigator:y,basename:w}=l.useContext(ie),x=null!=v&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=l.useContext(ae);b(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=xt("useViewTransitionState"),a=ve(e,{relative:t});if(!n.isTransitioning)return!1;let o=W(n.currentLocation.pathname,r)||n.currentLocation.pathname,s=W(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=F(a.pathname,s)||null!=F(a.pathname,o)}(f)&&!0===d,S=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,_=g.pathname,k=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(_=_.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&w&&(k=W(k,w)||k);const E="/"!==S&&S.endsWith("/")?S.length-1:S.length;let N,j=_===S||!o&&_.startsWith(S)&&"/"===_.charAt(E),C=null!=k&&(k===S||!o&&k.startsWith(S)&&"/"===k.charAt(S.length)),T={isActive:j,isPending:C,isTransitioning:x},P=j?n:void 0;N="function"===typeof a?a(T):[a,j?"active":null,C?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let A="function"===typeof s?s(T):s;return l.createElement(yt,i(i({},p),{},{"aria-current":P,className:N,ref:t,style:A,to:c,viewTransition:d}),"function"===typeof h?h(T):h)}).displayName="NavLink";var bt=l.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:r,navigate:a,reloadDocument:o,replace:s,state:c,method:d=Me,action:h,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:v}=e,y=u(e,g),w=Et(),x=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=l.useContext(ie),r=l.useContext(ce);b(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o=i({},ve(e||".",{relative:t})),s=he();if(null==e){o.search=s.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();o.search=n?"?".concat(n):""}}e&&"."!==e||!a.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(o.pathname="/"===o.pathname?n:K([n,o.pathname]));return _(o)}(h,{relative:f}),S="get"===d.toLowerCase()?"get":"post",k="string"===typeof h&&vt.test(h);return l.createElement("form",i(i({ref:t,method:S,action:x,onSubmit:o?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;w(t||e.currentTarget,{fetcherKey:r,method:n,navigate:a,replace:s,state:c,relative:f,preventScrollReset:m,viewTransition:v})}},y),{},{"data-discover":k||"render"!==n?void 0:"true"}))});function wt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function xt(e){let t=l.useContext(te);return b(t,wt(e)),t}function St(e){w("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=l.useRef(He(e)),n=l.useRef(!1),r=he(),a=l.useMemo(()=>function(e,t){let n=He(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}(r.search,n.current?null:t.current),[r.search]),o=me(),s=l.useCallback((e,t)=>{const r=He("function"===typeof e?e(new URLSearchParams(a)):e);n.current=!0,o("?"+r,t)},[o,a]);return[a,s]}bt.displayName="Form";var _t=0,kt=()=>"__".concat(String(++_t),"__");function Et(){let{router:e}=xt("useSubmit"),{basename:t}=l.useContext(ie),n=je("useRouteId");return l.useCallback(async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:s,encType:i,formData:l,body:c}=qe(r,t);if(!1===a.navigate){let t=a.fetcherKey||kt();await e.fetch(t,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||i,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}class Nt extends Error{}function jt(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,(e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}(t)}catch(n){return atob(t)}}Nt.prototype.name="InvalidTokenError";const Ct=["timeoutInSeconds"],Tt=["grant_type","redirect_uri","client_id","client_secret","extraHeaders"],Pt=["grant_type","client_id","client_secret","scope"],At=["grant_type","client_id","client_secret","timeoutInSeconds","extraHeaders"],It=["url","authority","client_id","redirect_uri","response_type","scope","state_data","response_mode","request_type","client_secret","nonce","url_state","resource","skipUserInfo","extraQueryParams","extraTokenParams","disablePKCE","dpopJkt","omitScopeWhenRequesting"],Rt=["redirectMethod"],Dt=["popupWindowFeatures","popupWindowTarget","popupSignal"],Ot=["silentRequestTimeoutInSeconds"],Lt=["silentRequestTimeoutInSeconds"],Ut=["redirectMethod"],Mt=["popupWindowFeatures","popupWindowTarget","popupSignal"],zt=["silentRequestTimeoutInSeconds"];var Ft,Ht,Bt,Wt={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},Vt=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(Vt||{});(Bt=Vt||(Vt={})).reset=function(){Ft=3,Ht=Wt},Bt.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");Ft=e},Bt.setLogger=function(e){Ht=e};var qt=class e{constructor(e){this._name=e}debug(){if(Ft>=4){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.debug(e._format(this._name,this._method),...n)}}info(){if(Ft>=3){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.info(e._format(this._name,this._method),...n)}}warn(){if(Ft>=2){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.warn(e._format(this._name,this._method),...n)}}error(){if(Ft>=1){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Ht.error(e._format(this._name,this._method),...n)}}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(t,n){const r=new e("".concat(t,".").concat(n));return r.debug("begin"),r}static _format(e,t){const n="[".concat(e,"]");return t?"".concat(n," ").concat(t,":"):n}static debug(t){if(Ft>=4){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.debug(e._format(t),...r)}}static info(t){if(Ft>=3){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.info(e._format(t),...r)}}static warn(t){if(Ft>=2){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.warn(e._format(t),...r)}}static error(t){if(Ft>=1){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];Ht.error(e._format(t),...r)}}};Vt.reset();var $t=class{static decode(e){try{return function(e,t){if("string"!==typeof e)throw new Nt("Invalid token specified: must be a string");t||(t={});const n=!0===t.header?0:1,r=e.split(".")[n];if("string"!==typeof r)throw new Nt("Invalid token specified: missing part #".concat(n+1));let a;try{a=jt(r)}catch(yo){throw new Nt("Invalid token specified: invalid base64 for part #".concat(n+1," (").concat(yo.message,")"))}try{return JSON.parse(a)}catch(yo){throw new Nt("Invalid token specified: invalid json for part #".concat(n+1," (").concat(yo.message,")"))}}(e)}catch(t){throw qt.error("JwtUtils.decode",t),t}}static async generateSignedJwt(e,t,n){const r=Qt.encodeBase64Url((new TextEncoder).encode(JSON.stringify(e))),a=Qt.encodeBase64Url((new TextEncoder).encode(JSON.stringify(t))),o="".concat(r,".").concat(a),s=await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},n,(new TextEncoder).encode(o)),i=Qt.encodeBase64Url(new Uint8Array(s));return"".concat(o,".").concat(i)}},Jt=e=>btoa([...new Uint8Array(e)].map(e=>String.fromCharCode(e)).join("")),Kt=class e{static _randomWord(){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}static generateUUIDv4(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t=>(+t^e._randomWord()&15>>+t/4).toString(16)).replace(/-/g,"")}static generateCodeVerifier(){return e.generateUUIDv4()+e.generateUUIDv4()+e.generateUUIDv4()}static async generateCodeChallenge(e){if(!crypto.subtle)throw new Error("Crypto.subtle is available only in secure contexts (HTTPS).");try{const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Jt(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw qt.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const n=(new TextEncoder).encode([e,t].join(":"));return Jt(n)}static async hash(e,t){const n=(new TextEncoder).encode(t),r=await crypto.subtle.digest(e,n);return new Uint8Array(r)}static async customCalculateJwkThumbprint(t){let n;switch(t.kty){case"RSA":n={e:t.e,kty:t.kty,n:t.n};break;case"EC":n={crv:t.crv,kty:t.kty,x:t.x,y:t.y};break;case"OKP":n={crv:t.crv,kty:t.kty,x:t.x};break;case"oct":n={crv:t.k,kty:t.kty};break;default:throw new Error("Unknown jwk type")}const r=await e.hash("SHA-256",JSON.stringify(n));return e.encodeBase64Url(r)}static async generateDPoPProof(t){let n,r,{url:a,accessToken:o,httpMethod:s,keyPair:i,nonce:l}=t;const c={jti:window.crypto.randomUUID(),htm:null!=s?s:"GET",htu:a,iat:Math.floor(Date.now()/1e3)};o&&(n=await e.hash("SHA-256",o),r=e.encodeBase64Url(n),c.ath=r),l&&(c.nonce=l);try{const e=await crypto.subtle.exportKey("jwk",i.publicKey),t={alg:"ES256",typ:"dpop+jwt",jwk:{crv:e.crv,kty:e.kty,x:e.x,y:e.y}};return await $t.generateSignedJwt(t,c,i.privateKey)}catch(u){throw u instanceof TypeError?new Error("Error exporting dpop public key: ".concat(u.message)):u}}static async generateDPoPJkt(t){try{const n=await crypto.subtle.exportKey("jwk",t.publicKey);return await e.customCalculateJwkThumbprint(n)}catch(n){throw n instanceof TypeError?new Error("Could not retrieve dpop keys from storage: ".concat(n.message)):n}}static async generateDPoPKeys(){return await window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign","verify"])}};Kt.encodeBase64Url=e=>Jt(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");var Qt=Kt,Gt=class{constructor(e){this._name=e,this._callbacks=[],this._logger=new qt("Event('".concat(this._name,"')"))}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}async raise(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._logger.debug("raise:",...t);for(const r of this._callbacks)await r(...t)}},Yt=class{static center(e){let t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));var n;return null==t.width&&(t.width=null!=(n=[800,720,600,480].find(e=>e<=window.outerWidth/1.618))?n:360),null!=t.left||(t.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-t.width)/2))),null!=t.height&&(null!=t.top||(t.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-t.height)/2)))),t}static serialize(e){return Object.entries(e).filter(e=>{let[,t]=e;return null!=t}).map(e=>{let[t,n]=e;return"".concat(t,"=").concat("boolean"!==typeof n?n:n?"yes":"no")}).join(",")}},Xt=class e extends Gt{constructor(){super(...arguments),this._logger=new qt("Timer('".concat(this._name,"')")),this._timerHandle=null,this._expiration=0,this._callback=()=>{const t=this._expiration-e.getEpochTime();this._logger.debug("timer completes in",t),this._expiration<=e.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(t){const n=this._logger.create("init");t=Math.max(Math.floor(t),1);const r=e.getEpochTime()+t;if(this.expiration===r&&this._timerHandle)return void n.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),n.debug("using duration",t),this._expiration=r;const a=Math.min(t,5);this._timerHandle=setInterval(this._callback,1e3*a)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},Zt=class{static readParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"query";if(!e)throw new TypeError("Invalid URL");const n=new URL(e,"http://127.0.0.1")["fragment"===t?"hash":"search"];return new URLSearchParams(n.slice(1))}},en=";",tn=class extends Error{constructor(e,t){var n,r,a;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw qt.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(n=e.error_description)?n:null,this.error_uri=null!=(r=e.error_uri)?r:null,this.state=e.userState,this.session_state=null!=(a=e.session_state)?a:null,this.url_state=e.url_state}},nn=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},rn=class{constructor(e){this._logger=new qt("AccessTokenEvents"),this._expiringTimer=new Xt("Access token expiring"),this._expiredTimer=new Xt("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}async load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const n=e.expires_in;if(t.debug("access token present, remaining duration:",n),n>0){let e=n-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const r=n+1;t.debug("registering expired timer, raising in",r,"seconds"),this._expiredTimer.init(r)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}async unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}},an=class{constructor(e,t,n,r,a){this._callback=e,this._client_id=t,this._intervalInSeconds=r,this._stopOnError=a,this._logger=new qt("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const o=new URL(n);this._frame_origin=o.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=o.href}load(){return new Promise(e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)})}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},on=class{constructor(){this._logger=new qt("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create("getItem('".concat(e,"')")),this._data[e]}setItem(e,t){this._logger.create("setItem('".concat(e,"')")),this._data[e]=t}removeItem(e){this._logger.create("removeItem('".concat(e,"')")),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}},sn=class extends Error{constructor(e,t){super(t),this.name="ErrorDPoPNonce",this.nonce=e}},ln=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._jwtHandler=t,this._extraHeaders=n,this._logger=new qt("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{timeoutInSeconds:n}=t,r=u(t,Ct);if(!n)return await fetch(e,r);const a=new AbortController,o=setTimeout(()=>a.abort(),1e3*n);try{return await fetch(e,i(i({},t),{},{signal:a.signal}))}catch(s){if(s instanceof DOMException&&"AbortError"===s.name)throw new nn("Network timed out");throw s}finally{clearTimeout(o)}}async getJson(e){let{token:t,credentials:n,timeoutInSeconds:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=this._logger.create("getJson"),o={Accept:this._contentTypes.join(", ")};let s;t&&(a.debug("token passed, setting Authorization header"),o.Authorization="Bearer "+t),this._appendExtraHeaders(o);try{a.debug("url:",e),s=await this.fetchWithTimeout(e,{method:"GET",headers:o,timeoutInSeconds:r,credentials:n})}catch(c){throw a.error("Network Error"),c}a.debug("HTTP response received, status",s.status);const i=s.headers.get("Content-Type");if(i&&!this._contentTypes.find(e=>i.startsWith(e))&&a.throw(new Error("Invalid response Content-Type: ".concat(null!=i?i:"undefined",", from URL: ").concat(e))),s.ok&&this._jwtHandler&&(null==i?void 0:i.startsWith("application/jwt")))return await this._jwtHandler(await s.text());let l;try{l=await s.json()}catch(c){if(a.error("Error parsing JSON response",c),s.ok)throw c;throw new Error("".concat(s.statusText," (").concat(s.status,")"))}if(!s.ok){if(a.error("Error from server:",l),l.error)throw new tn(l);throw new Error("".concat(s.statusText," (").concat(s.status,"): ").concat(JSON.stringify(l)))}return l}async postForm(e,t){let{body:n,basicAuth:r,timeoutInSeconds:a,initCredentials:o,extraHeaders:s}=t;const l=this._logger.create("postForm"),c=i({Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"},s);let u;void 0!==r&&(c.Authorization="Basic "+r),this._appendExtraHeaders(c);try{l.debug("url:",e),u=await this.fetchWithTimeout(e,{method:"POST",headers:c,body:n,timeoutInSeconds:a,credentials:o})}catch(f){throw l.error("Network error"),f}l.debug("HTTP response received, status",u.status);const d=u.headers.get("Content-Type");if(d&&!this._contentTypes.find(e=>d.startsWith(e)))throw new Error("Invalid response Content-Type: ".concat(null!=d?d:"undefined",", from URL: ").concat(e));const h=await u.text();let p={};if(h)try{p=JSON.parse(h)}catch(f){if(l.error("Error parsing JSON response",f),u.ok)throw f;throw new Error("".concat(u.statusText," (").concat(u.status,")"))}if(!u.ok){if(l.error("Error from server:",p),u.headers.has("dpop-nonce")){const e=u.headers.get("dpop-nonce");throw new sn(e,"".concat(JSON.stringify(p)))}if(p.error)throw new tn(p,n);throw new Error("".concat(u.statusText," (").concat(u.status,"): ").concat(JSON.stringify(p)))}return p}_appendExtraHeaders(e){const t=this._logger.create("appendExtraHeaders"),n=Object.keys(this._extraHeaders),r=["accept","content-type"],a=["authorization"];0!==n.length&&n.forEach(n=>{if(r.includes(n.toLocaleLowerCase()))return void t.warn("Protected header could not be set",n,r);if(a.includes(n.toLocaleLowerCase())&&Object.keys(e).includes(n))return void t.warn("Header could not be overridden",n,a);const o="function"===typeof this._extraHeaders[n]?this._extraHeaders[n]():this._extraHeaders[n];o&&""!==o&&(e[n]=o)})}},cn=class{constructor(e){this._settings=e,this._logger=new qt("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new ln(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},t,this._settings.metadataSeed),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("_getMetadataProperty('".concat(e,"')")),r=await this.getMetadata();if(n.debug("resolved"),void 0===r[e]){if(!0===t)return void n.warn("Metadata does not contain optional property");n.throw(new Error("Metadata does not contain property "+e))}return r[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const n=await this._jsonService.getJson(t,{timeoutInSeconds:this._settings.requestTimeoutInSeconds});if(e.debug("got key set",n),!Array.isArray(n.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=n.keys,this._signingKeys}},un=class{constructor(){let{prefix:e="oidc.",store:t=localStorage}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._logger=new qt("WebStorageStateStore"),this._store=t,this._prefix=e}async set(e,t){this._logger.create("set('".concat(e,"')")),e=this._prefix+e,await this._store.setItem(e,t)}async get(e){this._logger.create("get('".concat(e,"')")),e=this._prefix+e;return await this._store.getItem(e)}async remove(e){this._logger.create("remove('".concat(e,"')")),e=this._prefix+e;const t=await this._store.getItem(e);return await this._store.removeItem(e),t}async getAllKeys(){this._logger.create("getAllKeys");const e=await this._store.length,t=[];for(let n=0;n<e;n++){const e=await this._store.key(n);e&&0===e.indexOf(this._prefix)&&t.push(e.substr(this._prefix.length))}return t}},dn="code",hn="openid",pn="client_secret_post",fn=900,mn=class{constructor(e){let{authority:t,metadataUrl:n,metadata:r,signingKeys:a,metadataSeed:o,client_id:s,client_secret:i,response_type:l=dn,scope:c=hn,redirect_uri:u,post_logout_redirect_uri:d,client_authentication:h=pn,prompt:p,display:f,max_age:m,ui_locales:g,acr_values:v,resource:y,response_mode:b,filterProtocolClaims:w=!0,loadUserInfo:x=!1,requestTimeoutInSeconds:S,staleStateAgeInSeconds:_=fn,mergeClaimsStrategy:k={array:"replace"},disablePKCE:E=!1,stateStore:N,revokeTokenAdditionalContentTypes:j,fetchRequestCredentials:C,refreshTokenAllowedScope:T,extraQueryParams:P={},extraTokenParams:A={},extraHeaders:I={},dpop:R,omitScopeWhenRequesting:D=!1}=e;var O;if(this.authority=t,n?this.metadataUrl=n:(this.metadataUrl=t,t&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=o,this.signingKeys=a,this.client_id=s,this.client_secret=i,this.response_type=l,this.scope=c,this.redirect_uri=u,this.post_logout_redirect_uri=d,this.client_authentication=h,this.prompt=p,this.display=f,this.max_age=m,this.ui_locales=g,this.acr_values=v,this.resource=y,this.response_mode=b,this.filterProtocolClaims=null==w||w,this.loadUserInfo=!!x,this.staleStateAgeInSeconds=_,this.mergeClaimsStrategy=k,this.omitScopeWhenRequesting=D,this.disablePKCE=!!E,this.revokeTokenAdditionalContentTypes=j,this.fetchRequestCredentials=C||"same-origin",this.requestTimeoutInSeconds=S,N)this.stateStore=N;else{const e="undefined"!==typeof window?window.localStorage:new on;this.stateStore=new un({store:e})}if(this.refreshTokenAllowedScope=T,this.extraQueryParams=P,this.extraTokenParams=A,this.extraHeaders=I,this.dpop=R,this.dpop&&!(null==(O=this.dpop)?void 0:O.store))throw new Error("A DPoPStore is required when dpop is enabled")}},gn=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new qt("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const n=$t.decode(e);return t.debug("JWT decoding successful"),n}catch(n){throw t.error("Error parsing JWT response"),n}},this._jsonService=new ln(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const n=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",n);const r=await this._jsonService.getJson(n,{token:e,credentials:this._settings.fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return t.debug("got claims",r),r}},vn=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new qt("TokenClient"),this._jsonService=new ln(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode(e){let{grant_type:t="authorization_code",redirect_uri:n=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:a=this._settings.client_secret,extraHeaders:o}=e,s=u(e,Tt);const i=this._logger.create("exchangeCode");r||i.throw(new Error("A client_id is required")),n||i.throw(new Error("A redirect_uri is required")),s.code||i.throw(new Error("A code is required"));const l=new URLSearchParams({grant_type:t,redirect_uri:n});for(const[u,p]of Object.entries(s))null!=p&&l.set(u,p);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(void 0===a||null===a)throw i.throw(new Error("A client_secret is required")),null;c=Qt.generateBasicAuth(r,a);break;case"client_secret_post":l.append("client_id",r),a&&l.append("client_secret",a)}const d=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const h=await this._jsonService.postForm(d,{body:l,basicAuth:c,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:o});return i.debug("got response"),h}async exchangeCredentials(e){let{grant_type:t="password",client_id:n=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:a=this._settings.scope}=e,o=u(e,Pt);const s=this._logger.create("exchangeCredentials");n||s.throw(new Error("A client_id is required"));const i=new URLSearchParams({grant_type:t});this._settings.omitScopeWhenRequesting||i.set("scope",a);for(const[u,h]of Object.entries(o))null!=h&&i.set(u,h);let l;switch(this._settings.client_authentication){case"client_secret_basic":if(void 0===r||null===r)throw s.throw(new Error("A client_secret is required")),null;l=Qt.generateBasicAuth(n,r);break;case"client_secret_post":i.append("client_id",n),r&&i.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);s.debug("got token endpoint");const d=await this._jsonService.postForm(c,{body:i,basicAuth:l,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials});return s.debug("got response"),d}async exchangeRefreshToken(e){let{grant_type:t="refresh_token",client_id:n=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:a,extraHeaders:o}=e,s=u(e,At);const i=this._logger.create("exchangeRefreshToken");n||i.throw(new Error("A client_id is required")),s.refresh_token||i.throw(new Error("A refresh_token is required"));const l=new URLSearchParams({grant_type:t});for(const[u,p]of Object.entries(s))Array.isArray(p)?p.forEach(e=>l.append(u,e)):null!=p&&l.set(u,p);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(void 0===r||null===r)throw i.throw(new Error("A client_secret is required")),null;c=Qt.generateBasicAuth(n,r);break;case"client_secret_post":l.append("client_id",n),r&&l.append("client_secret",r)}const d=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const h=await this._jsonService.postForm(d,{body:l,basicAuth:c,timeoutInSeconds:a,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:o});return i.debug("got response"),h}async revoke(e){var t;const n=this._logger.create("revoke");e.token||n.throw(new Error("A token is required"));const r=await this._metadataService.getRevocationEndpoint(!1);n.debug("got revocation endpoint, revoking ".concat(null!=(t=e.token_type_hint)?t:"default token type"));const a=new URLSearchParams;for(const[o,s]of Object.entries(e))null!=s&&a.set(o,s);a.set("client_id",this._settings.client_id),this._settings.client_secret&&a.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(r,{body:a,timeoutInSeconds:this._settings.requestTimeoutInSeconds}),n.debug("got response")}},yn=class{constructor(e,t,n){this._settings=e,this._metadataService=t,this._claimsService=n,this._logger=new qt("ResponseValidator"),this._userInfoService=new gn(this._settings,this._metadataService),this._tokenClient=new vn(this._settings,this._metadataService)}async validateSigninResponse(e,t,n){const r=this._logger.create("validateSigninResponse");this._processSigninState(e,t),r.debug("state processed"),await this._processCode(e,t,n),r.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),r.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(e,t){const n=this._logger.create("validateCredentialsResponse"),r=e.isOpenId&&!!e.id_token;r&&this._validateIdTokenAttributes(e),n.debug("tokens validated"),await this._processClaims(e,t,r),n.debug("claims processed")}async validateRefreshResponse(e,t){const n=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope),e.isOpenId&&e.id_token&&(this._validateIdTokenAttributes(e,t.id_token),n.debug("ID Token validated")),e.id_token||(e.id_token=t.id_token,e.profile=t.profile);const r=e.isOpenId&&!!e.id_token;await this._processClaims(e,!1,r),n.debug("claims processed")}validateSignoutResponse(e,t){const n=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&n.throw(new Error("State does not match")),n.debug("state validated"),e.userState=t.data,e.error)throw n.warn("Response was error",e.error),new tn(e)}_processSigninState(e,t){const n=this._logger.create("_processSigninState");if(t.id!==e.state&&n.throw(new Error("State does not match")),t.client_id||n.throw(new Error("No client_id on state")),t.authority||n.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&n.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&n.throw(new Error("client_id mismatch on settings vs. signin state")),n.debug("state validated"),e.userState=t.data,e.url_state=t.url_state,null!=e.scope||(e.scope=t.scope),e.error)throw n.warn("Response was error",e.error),new tn(e);t.code_verifier&&!e.code&&n.throw(new Error("Expected code in response"))}async _processClaims(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._logger.create("_processClaims");if(e.profile=this._claimsService.filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void r.debug("not loading user info");r.debug("loading user info");const a=await this._userInfoService.getClaims(e.access_token);r.debug("user info claims received from user info endpoint"),n&&a.sub!==e.profile.sub&&r.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._claimsService.mergeClaims(e.profile,this._claimsService.filterProtocolClaims(a)),r.debug("user info claims received, updated profile:",e.profile)}async _processCode(e,t,n){const r=this._logger.create("_processCode");if(e.code){r.debug("Validating code");const a=await this._tokenClient.exchangeCode(i({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,extraHeaders:n},t.extraTokenParams));Object.assign(e,a)}else r.debug("No code to process")}_validateIdTokenAttributes(e,t){var n;const r=this._logger.create("_validateIdTokenAttributes");r.debug("decoding ID Token JWT");const a=$t.decode(null!=(n=e.id_token)?n:"");if(a.sub||r.throw(new Error("ID Token is missing a subject claim")),t){const e=$t.decode(t);a.sub!==e.sub&&r.throw(new Error("sub in id_token does not match current sub")),a.auth_time&&a.auth_time!==e.auth_time&&r.throw(new Error("auth_time in id_token does not match original auth_time")),a.azp&&a.azp!==e.azp&&r.throw(new Error("azp in id_token does not match original azp")),!a.azp&&e.azp&&r.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=a}},bn=class e{constructor(e){this.id=e.id||Qt.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=Xt.getEpochTime(),this.request_type=e.request_type,this.url_state=e.url_state}toStorageString(){return new qt("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(t){return qt.createStatic("State","fromStorageString"),Promise.resolve(new e(JSON.parse(t)))}static async clearStaleState(t,n){const r=qt.createStatic("State","clearStaleState"),a=Xt.getEpochTime()-n,o=await t.getAllKeys();r.debug("got keys",o);for(let i=0;i<o.length;i++){const n=o[i],l=await t.get(n);let c=!1;if(l)try{const t=await e.fromStorageString(l);r.debug("got item from key:",n,t.created),t.created<=a&&(c=!0)}catch(s){r.error("Error parsing state for key:",n,s),c=!0}else r.debug("no item in storage for key:",n),c=!0;c&&(r.debug("removed item for key:",n),t.remove(n))}}},wn=class e extends bn{constructor(e){super(e),this.code_verifier=e.code_verifier,this.code_challenge=e.code_challenge,this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}static async create(t){const n=!0===t.code_verifier?Qt.generateCodeVerifier():t.code_verifier||void 0,r=n?await Qt.generateCodeChallenge(n):void 0;return new e(i(i({},t),{},{code_verifier:n,code_challenge:r}))}toStorageString(){return new qt("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(t){qt.createStatic("SigninState","fromStorageString");const n=JSON.parse(t);return e.create(n)}},xn=class e{constructor(e){this.url=e.url,this.state=e.state}static async create(t){let{url:n,authority:r,client_id:a,redirect_uri:o,response_type:s,scope:l,state_data:c,response_mode:d,request_type:h,client_secret:p,nonce:f,url_state:m,resource:g,skipUserInfo:v,extraQueryParams:y,extraTokenParams:b,disablePKCE:w,dpopJkt:x,omitScopeWhenRequesting:S}=t,_=u(t,It);if(!n)throw this._logger.error("create: No url passed"),new Error("url");if(!a)throw this._logger.error("create: No client_id passed"),new Error("client_id");if(!o)throw this._logger.error("create: No redirect_uri passed"),new Error("redirect_uri");if(!s)throw this._logger.error("create: No response_type passed"),new Error("response_type");if(!l)throw this._logger.error("create: No scope passed"),new Error("scope");if(!r)throw this._logger.error("create: No authority passed"),new Error("authority");const k=await wn.create({data:c,request_type:h,url_state:m,code_verifier:!w,client_id:a,authority:r,redirect_uri:o,response_mode:d,client_secret:p,scope:l,extraTokenParams:b,skipUserInfo:v}),E=new URL(n);E.searchParams.append("client_id",a),E.searchParams.append("redirect_uri",o),E.searchParams.append("response_type",s),S||E.searchParams.append("scope",l),f&&E.searchParams.append("nonce",f),x&&E.searchParams.append("dpop_jkt",x);let N=k.id;if(m&&(N="".concat(N).concat(en).concat(m)),E.searchParams.append("state",N),k.code_challenge&&(E.searchParams.append("code_challenge",k.code_challenge),E.searchParams.append("code_challenge_method","S256")),g){(Array.isArray(g)?g:[g]).forEach(e=>E.searchParams.append("resource",e))}for(const[e,u]of Object.entries(i(i({response_mode:d},_),y)))null!=u&&E.searchParams.append(e,u.toString());return new e({url:E.href,state:k})}};xn._logger=new qt("SigninRequest");var Sn=xn,_n=class{constructor(e){if(this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.state){const e=decodeURIComponent(this.state).split(en);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(en))}this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Xt.getEpochTime()}set expires_in(e){"string"===typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+Xt.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}},kn=class{constructor(e){let{url:t,state_data:n,id_token_hint:r,post_logout_redirect_uri:a,extraQueryParams:o,request_type:s,client_id:l,url_state:c}=e;if(this._logger=new qt("SignoutRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");const u=new URL(t);if(r&&u.searchParams.append("id_token_hint",r),l&&u.searchParams.append("client_id",l),a&&(u.searchParams.append("post_logout_redirect_uri",a),n||c)){this.state=new bn({data:n,request_type:s,url_state:c});let e=this.state.id;c&&(e="".concat(e).concat(en).concat(c)),u.searchParams.append("state",e)}for(const[d,h]of Object.entries(i({},o)))null!=h&&u.searchParams.append(d,h.toString());this.url=u.href}},En=class{constructor(e){if(this.state=e.get("state"),this.state){const e=decodeURIComponent(this.state).split(en);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(en))}this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}},Nn=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],jn=["sub","iss","aud","exp","iat"],Cn=class{constructor(e){this._settings=e,this._logger=new qt("ClaimsService")}filterProtocolClaims(e){const t=i({},e);if(this._settings.filterProtocolClaims){let e;e=Array.isArray(this._settings.filterProtocolClaims)?this._settings.filterProtocolClaims:Nn;for(const n of e)jn.includes(n)||delete t[n]}return t}mergeClaims(e,t){const n=i({},e);for(const[r,a]of Object.entries(t))if(n[r]!==a)if(Array.isArray(n[r])||Array.isArray(a))if("replace"==this._settings.mergeClaimsStrategy.array)n[r]=a;else{const e=Array.isArray(n[r])?n[r]:[n[r]];for(const t of Array.isArray(a)?a:[a])e.includes(t)||e.push(t);n[r]=e}else"object"===typeof n[r]&&"object"===typeof a?n[r]=this.mergeClaims(n[r],a):n[r]=a;return n}},Tn=class{constructor(e,t){this.keys=e,this.nonce=t}},Pn=class{constructor(e,t){this._logger=new qt("OidcClient"),this.settings=e instanceof mn?e:new mn(e),this.metadataService=null!=t?t:new cn(this.settings),this._claimsService=new Cn(this.settings),this._validator=new yn(this.settings,this.metadataService,this._claimsService),this._tokenClient=new vn(this.settings,this.metadataService)}async createSigninRequest(e){let{state:t,request:n,request_uri:r,request_type:a,id_token_hint:o,login_hint:s,skipUserInfo:i,nonce:l,url_state:c,response_type:u=this.settings.response_type,scope:d=this.settings.scope,redirect_uri:h=this.settings.redirect_uri,prompt:p=this.settings.prompt,display:f=this.settings.display,max_age:m=this.settings.max_age,ui_locales:g=this.settings.ui_locales,acr_values:v=this.settings.acr_values,resource:y=this.settings.resource,response_mode:b=this.settings.response_mode,extraQueryParams:w=this.settings.extraQueryParams,extraTokenParams:x=this.settings.extraTokenParams,dpopJkt:S,omitScopeWhenRequesting:_=this.settings.omitScopeWhenRequesting}=e;const k=this._logger.create("createSigninRequest");if("code"!==u)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const E=await this.metadataService.getAuthorizationEndpoint();k.debug("Received authorization endpoint",E);const N=await Sn.create({url:E,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:h,response_type:u,scope:d,state_data:t,url_state:c,prompt:p,display:f,max_age:m,ui_locales:g,id_token_hint:o,login_hint:s,acr_values:v,dpopJkt:S,resource:y,request:n,request_uri:r,extraQueryParams:w,extraTokenParams:x,request_type:a,response_mode:b,client_secret:this.settings.client_secret,skipUserInfo:i,nonce:l,disablePKCE:this.settings.disablePKCE,omitScopeWhenRequesting:_});await this.clearStaleState();const j=N.state;return await this.settings.stateStore.set(j.id,j.toStorageString()),N}async readSigninResponseState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("readSigninResponseState"),r=new _n(Zt.readParams(e,this.settings.response_mode));if(!r.state)throw n.throw(new Error("No state in response")),null;const a=await this.settings.stateStore[t?"remove":"get"](r.state);if(!a)throw n.throw(new Error("No matching state found in storage")),null;return{state:await wn.fromStorageString(a),response:r}}async processSigninResponse(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._logger.create("processSigninResponse"),{state:a,response:o}=await this.readSigninResponseState(e,n);if(r.debug("received state from storage; validating response"),this.settings.dpop&&this.settings.dpop.store){const e=await this.getDpopProof(this.settings.dpop.store);t=i(i({},t),{},{DPoP:e})}try{await this._validator.validateSigninResponse(o,a,t)}catch(s){if(!(s instanceof sn&&this.settings.dpop))throw s;{const e=await this.getDpopProof(this.settings.dpop.store,s.nonce);t.DPoP=e,await this._validator.validateSigninResponse(o,a,t)}}return o}async getDpopProof(e,t){let n,r;return(await e.getAllKeys()).includes(this.settings.client_id)?(r=await e.get(this.settings.client_id),r.nonce!==t&&t&&(r.nonce=t,await e.set(this.settings.client_id,r))):(n=await Qt.generateDPoPKeys(),r=new Tn(n,t),await e.set(this.settings.client_id,r)),await Qt.generateDPoPProof({url:await this.metadataService.getTokenEndpoint(!1),httpMethod:"POST",keyPair:r.keys,nonce:r.nonce})}async processResourceOwnerPasswordCredentials(e){let{username:t,password:n,skipUserInfo:r=!1,extraTokenParams:a={}}=e;const o=await this._tokenClient.exchangeCredentials(i({username:t,password:n},a)),s=new _n(new URLSearchParams);return Object.assign(s,o),await this._validator.validateCredentialsResponse(s,r),s}async useRefreshToken(e){let{state:t,redirect_uri:n,resource:r,timeoutInSeconds:a,extraHeaders:o,extraTokenParams:s}=e;var l;const c=this._logger.create("useRefreshToken");let u,d;if(void 0===this.settings.refreshTokenAllowedScope)u=t.scope;else{const e=this.settings.refreshTokenAllowedScope.split(" ");u=((null==(l=t.scope)?void 0:l.split(" "))||[]).filter(t=>e.includes(t)).join(" ")}if(this.settings.dpop&&this.settings.dpop.store){const e=await this.getDpopProof(this.settings.dpop.store);o=i(i({},o),{},{DPoP:e})}try{d=await this._tokenClient.exchangeRefreshToken(i({refresh_token:t.refresh_token,scope:u,redirect_uri:n,resource:r,timeoutInSeconds:a,extraHeaders:o},s))}catch(p){if(!(p instanceof sn&&this.settings.dpop))throw p;o.DPoP=await this.getDpopProof(this.settings.dpop.store,p.nonce),d=await this._tokenClient.exchangeRefreshToken(i({refresh_token:t.refresh_token,scope:u,redirect_uri:n,resource:r,timeoutInSeconds:a,extraHeaders:o},s))}const h=new _n(new URLSearchParams);return Object.assign(h,d),c.debug("validating response",h),await this._validator.validateRefreshResponse(h,i(i({},t),{},{scope:u})),h}async createSignoutRequest(){let{state:e,id_token_hint:t,client_id:n,request_type:r,url_state:a,post_logout_redirect_uri:o=this.settings.post_logout_redirect_uri,extraQueryParams:s=this.settings.extraQueryParams}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this._logger.create("createSignoutRequest"),l=await this.metadataService.getEndSessionEndpoint();if(!l)throw i.throw(new Error("No end session endpoint")),null;i.debug("Received end session endpoint",l),n||!o||t||(n=this.settings.client_id);const c=new kn({url:l,id_token_hint:t,client_id:n,post_logout_redirect_uri:o,state_data:e,extraQueryParams:s,request_type:r,url_state:a});await this.clearStaleState();const u=c.state;return u&&(i.debug("Signout request has state to persist"),await this.settings.stateStore.set(u.id,u.toStorageString())),c}async readSignoutResponseState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("readSignoutResponseState"),r=new En(Zt.readParams(e,this.settings.response_mode));if(!r.state){if(n.debug("No state in response"),r.error)throw n.warn("Response was error:",r.error),new tn(r);return{state:void 0,response:r}}const a=await this.settings.stateStore[t?"remove":"get"](r.state);if(!a)throw n.throw(new Error("No matching state found in storage")),null;return{state:await bn.fromStorageString(a),response:r}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:n,response:r}=await this.readSignoutResponseState(e,!0);return n?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(r,n)):t.debug("No state from storage; skipping response validation"),r}clearStaleState(){return this._logger.create("clearStaleState"),bn.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}},An=class{constructor(e){this._userManager=e,this._logger=new qt("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const n=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,n.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,n.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){n.debug("initializing check session iframe");const r=this._userManager.settings.client_id,a=this._userManager.settings.checkSessionIntervalInSeconds,o=this._userManager.settings.stopCheckSessionOnError,s=new an(this._callback,r,e,a,o);await s.load(),this._checkSessionIFrame=s,s.start(t)}else n.warn("no check session iframe found in the metadata")}catch(r){n.error("Error from getCheckSessionIframe:",r instanceof Error?r.message:r)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval(async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub?{sub:e.sub}:null};this._start(t)}}catch(n){e.error("error from querySessionStatus",n instanceof Error?n.message:n)}},1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let n=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(n=!1,this._checkSessionIFrame.start(t.session_state),e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),await this._userManager.events._raiseUserSessionChanged()):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),n?this._sub?await this._userManager.events._raiseUserSignedOut():await this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),await this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch(e=>{this._logger.error(e)})}async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub?{sub:e.sub}:null};this._start(t)}}}},In=class e{constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState,this.url_state=e.url_state}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-Xt.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+Xt.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new qt("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(t){return qt.createStatic("User","fromStorageString"),new e(JSON.parse(t))}},Rn="oidc-client",Dn=class{constructor(){this._abort=new Gt("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:n,keepOpen:r}=await new Promise((n,r)=>{const a=a=>{var o;const s=a.data,i=null!=(o=e.scriptOrigin)?o:window.location.origin;if(a.origin===i&&(null==s?void 0:s.source)===Rn){try{const n=Zt.readParams(s.url,e.response_mode).get("state");if(n||t.warn("no state found in response url"),a.source!==this._window&&n!==e.state)return}catch(l){this._dispose(),r(new Error("Invalid response from window"))}n(s)}};window.addEventListener("message",a,!1),this._disposeHandlers.add(()=>window.removeEventListener("message",a,!1));const o=new BroadcastChannel("oidc-client-popup-".concat(e.state));o.addEventListener("message",a,!1),this._disposeHandlers.add(()=>o.close()),this._disposeHandlers.add(this._abort.addHandler(e=>{this._dispose(),r(e)}))});return t.debug("got response from window"),this._dispose(),r||this.close(),{url:n}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.location.origin;const a={source:Rn,url:t,keepOpen:n},o=new qt("_notifyParent");if(e)o.debug("With parent. Using parent.postMessage."),e.postMessage(a,r);else{o.debug("No parent. Using BroadcastChannel.");const e=new URL(t).searchParams.get("state");if(!e)throw new Error("No parent and no state in URL. Can't complete notification.");const n=new BroadcastChannel("oidc-client-popup-".concat(e));n.postMessage(a),n.close()}}},On={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},Ln="_blank",Un=60,Mn=2,zn=10,Fn=class extends mn{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:n=e.post_logout_redirect_uri,popupWindowFeatures:r=On,popupWindowTarget:a=Ln,redirectMethod:o="assign",redirectTarget:s="self",iframeNotifyParentOrigin:i=e.iframeNotifyParentOrigin,iframeScriptOrigin:l=e.iframeScriptOrigin,requestTimeoutInSeconds:c,silent_redirect_uri:u=e.redirect_uri,silentRequestTimeoutInSeconds:d,automaticSilentRenew:h=!0,validateSubOnSilentRenew:p=!0,includeIdTokenInSilentRenew:f=!1,monitorSession:m=!1,monitorAnonymousSession:g=!1,checkSessionIntervalInSeconds:v=Mn,query_status_response_type:y="code",stopCheckSessionOnError:b=!0,revokeTokenTypes:w=["access_token","refresh_token"],revokeTokensOnSignout:x=!1,includeIdTokenInSilentSignout:S=!1,accessTokenExpiringNotificationTimeInSeconds:_=Un,userStore:k}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=n,this.popupWindowFeatures=r,this.popupWindowTarget=a,this.redirectMethod=o,this.redirectTarget=s,this.iframeNotifyParentOrigin=i,this.iframeScriptOrigin=l,this.silent_redirect_uri=u,this.silentRequestTimeoutInSeconds=d||c||zn,this.automaticSilentRenew=h,this.validateSubOnSilentRenew=p,this.includeIdTokenInSilentRenew=f,this.monitorSession=m,this.monitorAnonymousSession=g,this.checkSessionIntervalInSeconds=v,this.stopCheckSessionOnError=b,this.query_status_response_type=y,this.revokeTokenTypes=w,this.revokeTokensOnSignout=x,this.includeIdTokenInSilentSignout=S,this.accessTokenExpiringNotificationTimeInSeconds=_,k)this.userStore=k;else{const e="undefined"!==typeof window?window.sessionStorage:new on;this.userStore=new un({store:e})}}},Hn=class e extends Dn{constructor(t){let{silentRequestTimeoutInSeconds:n=zn}=t;super(),this._logger=new qt("IFrameWindow"),this._timeoutInSeconds=n,this._frame=e.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout(()=>{this._abort.raise(new nn("IFrame timed out without a response"))},1e3*this._timeoutInSeconds);return this._disposeHandlers.add(()=>clearTimeout(t)),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",e=>{var t;const n=e.target;null==(t=n.parentNode)||t.removeChild(n),this._abort.raise(new Error("IFrame removed from DOM"))},!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},Bn=class{constructor(e){this._settings=e,this._logger=new qt("IFrameNavigator")}async prepare(e){let{silentRequestTimeoutInSeconds:t=this._settings.silentRequestTimeoutInSeconds}=e;return new Hn({silentRequestTimeoutInSeconds:t})}async callback(e){this._logger.create("callback"),Hn.notifyParent(e,this._settings.iframeNotifyParentOrigin)}},Wn=class extends Dn{constructor(e){let{popupWindowTarget:t=Ln,popupWindowFeatures:n={},popupSignal:r}=e;super(),this._logger=new qt("PopupWindow");const a=Yt.center(i(i({},On),n));this._window=window.open(void 0,t,Yt.serialize(a)),r&&r.addEventListener("abort",()=>{var e;this._abort.raise(new Error(null!=(e=r.reason)?e:"Popup aborted"))}),n.closePopupWindowAfterInSeconds&&n.closePopupWindowAfterInSeconds>0&&setTimeout(()=>{this._window&&"boolean"===typeof this._window.closed&&!this._window.closed?this.close():this._abort.raise(new Error("Popup blocked by user"))},1e3*n.closePopupWindowAfterInSeconds)}async navigate(e){var t;null==(t=this._window)||t.focus();const n=setInterval(()=>{this._window&&!this._window.closed||(this._logger.debug("Popup closed by user or isolated by redirect"),r(),this._disposeHandlers.delete(r))},500),r=()=>clearInterval(n);return this._disposeHandlers.add(r),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){super._notifyParent(window.opener,e,t),t||window.opener||window.close()}},Vn=class{constructor(e){this._settings=e,this._logger=new qt("PopupNavigator")}async prepare(e){let{popupWindowFeatures:t=this._settings.popupWindowFeatures,popupWindowTarget:n=this._settings.popupWindowTarget,popupSignal:r}=e;return new Wn({popupWindowFeatures:t,popupWindowTarget:n,popupSignal:r})}async callback(e,t){let{keepOpen:n=!1}=t;this._logger.create("callback"),Wn.notifyOpener(e,n)}},qn=class{constructor(e){this._settings=e,this._logger=new qt("RedirectNavigator")}async prepare(e){let{redirectMethod:t=this._settings.redirectMethod,redirectTarget:n=this._settings.redirectTarget}=e;var r;this._logger.create("prepare");let a=window.self;"top"===n&&(a=null!=(r=window.top)?r:window.self);const o=a.location[t].bind(a.location);let s;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise((e,t)=>{s=t});return o(e.url),await t},close:()=>{this._logger.create("close"),null==s||s(new Error("Redirect aborted")),a.stop()}}}async callback(){}},$n=class extends rn{constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new qt("UserManagerEvents"),this._userLoaded=new Gt("User loaded"),this._userUnloaded=new Gt("User unloaded"),this._silentRenewError=new Gt("Silent renew error"),this._userSignedIn=new Gt("User signed in"),this._userSignedOut=new Gt("User signed out"),this._userSessionChanged=new Gt("User session changed")}async load(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];await super.load(e),t&&await this._userLoaded.raise(e)}async unload(){await super.unload(),await this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}async _raiseSilentRenewError(e){await this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}async _raiseUserSignedIn(){await this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}async _raiseUserSignedOut(){await this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}async _raiseUserSessionChanged(){await this._userSessionChanged.raise()}},Jn=class{constructor(e){this._userManager=e,this._logger=new qt("SilentRenewService"),this._isStarted=!1,this._retryTimer=new Xt("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof nn)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),await this._userManager.events._raiseSilentRenewError(t)}}}async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}},Kn=class{constructor(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.profile=e.profile,this.data=e.state}};const Qn=["children","onSigninCallback","skipSigninCallback","matchSignoutCallback","onSignoutCallback","onRemoveUser","userManager"];var Gn=l.createContext(void 0);Gn.displayName="AuthContext";var Yn={isLoading:!0,isAuthenticated:!1},Xn=(e,t)=>{switch(t.type){case"INITIALISED":case"USER_LOADED":return i(i({},e),{},{user:t.user,isLoading:!1,isAuthenticated:!!t.user&&!t.user.expired,error:void 0});case"USER_SIGNED_OUT":case"USER_UNLOADED":return i(i({},e),{},{user:void 0,isAuthenticated:!1});case"NAVIGATOR_INIT":return i(i({},e),{},{isLoading:!0,activeNavigator:t.method});case"NAVIGATOR_CLOSE":return i(i({},e),{},{isLoading:!1,activeNavigator:void 0});case"ERROR":{const n=t.error;return n.toString=()=>"".concat(n.name,": ").concat(n.message),i(i({},e),{},{isLoading:!1,error:n})}default:{const n=new TypeError("unknown type ".concat(t.type)),r={name:n.name,message:n.message,innerError:n,stack:n.stack,source:"unknown",toString:()=>"".concat(r.name,": ").concat(r.message)};return i(i({},e),{},{isLoading:!1,error:r})}}},Zn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location,t=new URLSearchParams(e.search);return!(!t.get("code")&&!t.get("error")||!t.get("state"))||(t=new URLSearchParams(e.hash.replace("#","?")),!(!t.get("code")&&!t.get("error")||!t.get("state")))},er=ar("signinCallback","Sign-in failed"),tr=ar("signoutCallback","Sign-out failed"),nr=ar("renewSilent","Renew silent failed");function rr(e,t){return{name:or(e,"name",()=>"Error"),message:or(e,"message",()=>t),stack:or(e,"stack",()=>(new Error).stack),innerError:e}}function ar(e,t){return n=>i(i({},rr(n,t)),{},{source:e})}function or(e,t,n){if(e&&"object"===typeof e){const n=e[t];if("string"===typeof n)return n}return n()}var sr=["clearStaleState","querySessionStatus","revokeTokens","startSilentRenew","stopSilentRenew"],ir=["signinPopup","signinSilent","signinRedirect","signinResourceOwnerCredentials","signoutPopup","signoutRedirect","signoutSilent"],lr=e=>()=>{throw new Error("UserManager#".concat(e," was called from an unsupported context. If this is a server-rendered page, defer this call with useEffect() or pass a custom UserManager implementation."))},cr="undefined"===typeof window?null:class{constructor(e,t,n,r){this._logger=new qt("UserManager"),this.settings=new Fn(e),this._client=new Pn(e),this._redirectNavigator=null!=t?t:new qn(this.settings),this._popupNavigator=null!=n?n:new Vn(this.settings),this._iframeNavigator=null!=r?r:new Bn(this.settings),this._events=new $n(this.settings),this._silentRenewService=new Jn(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new An(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this._logger.create("getUser"),n=await this._loadUser();return n?(t.info("user loaded"),await this._events.load(n,e),n):(t.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),await this._events.unload()}async signinRedirect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;this._logger.create("signinRedirect");const{redirectMethod:n}=e,r=u(e,Rt);let a;(null==(t=this.settings.dpop)?void 0:t.bind_authorization_code)&&(a=await this.generateDPoPJkt(this.settings.dpop));const o=await this._redirectNavigator.prepare({redirectMethod:n});await this._signinStart(i({request_type:"si:r",dpopJkt:a},r),o)}async signinRedirectCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signinRedirectCallback"),n=await this._signinEnd(e);return n.profile&&n.profile.sub?t.info("success, signed in subject",n.profile.sub):t.info("no subject"),n}async signinResourceOwnerCredentials(e){let{username:t,password:n,skipUserInfo:r=!1}=e;const a=this._logger.create("signinResourceOwnerCredential"),o=await this._client.processResourceOwnerPasswordCredentials({username:t,password:n,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});a.debug("got signin response");const s=await this._buildUser(o);return s.profile&&s.profile.sub?a.info("success, signed in subject",s.profile.sub):a.info("no subject"),s}async signinPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const n=this._logger.create("signinPopup");let r;(null==(t=this.settings.dpop)?void 0:t.bind_authorization_code)&&(r=await this.generateDPoPJkt(this.settings.dpop));const{popupWindowFeatures:a,popupWindowTarget:o,popupSignal:s}=e,l=u(e,Dt),c=this.settings.popup_redirect_uri;c||n.throw(new Error("No popup_redirect_uri configured"));const d=await this._popupNavigator.prepare({popupWindowFeatures:a,popupWindowTarget:o,popupSignal:s}),h=await this._signin(i({request_type:"si:p",redirect_uri:c,display:"popup",dpopJkt:r},l),d);return h&&(h.profile&&h.profile.sub?n.info("success, signed in subject",h.profile.sub):n.info("no subject")),h}async signinPopupCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,{keepOpen:t}),n.info("success")}async signinSilent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t,n;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:a}=e,o=u(e,Ot);let s,l=await this._loadUser();if(null==l?void 0:l.refresh_token){r.debug("using refresh token");const e=new Kn(l);return await this._useRefreshToken({state:e,redirect_uri:o.redirect_uri,resource:o.resource,extraTokenParams:o.extraTokenParams,timeoutInSeconds:a})}(null==(t=this.settings.dpop)?void 0:t.bind_authorization_code)&&(s=await this.generateDPoPJkt(this.settings.dpop));const c=this.settings.silent_redirect_uri;let d;c||r.throw(new Error("No silent_redirect_uri configured")),l&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",l.profile.sub),d=l.profile.sub);const h=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:a});return l=await this._signin(i({request_type:"si:s",redirect_uri:c,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==l?void 0:l.id_token:void 0,dpopJkt:s},o),h,d),l&&((null==(n=l.profile)?void 0:n.sub)?r.info("success, signed in subject",l.profile.sub):r.info("no subject")),l}async _useRefreshToken(e){const t=await this._client.useRefreshToken(i({timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds},e)),n=new In(i(i({},e.state),t));return await this.storeUser(n),await this._events.load(n),n}async signinSilentCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":await this.signinPopupCallback(e);break;case"si:s":await this.signinSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async signoutCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=await this._client.readSignoutResponseState(e);if(n)switch(n.request_type){case"so:r":return await this.signoutRedirectCallback(e);case"so:p":await this.signoutPopupCallback(e,t);break;case"so:s":await this.signoutSilentCallback(e);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:n}=e,r=u(e,Lt),a=this.settings.silent_redirect_uri;a||t.throw(new Error("No silent_redirect_uri configured"));const o=await this._loadUser(),s=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n}),l=await this._signinStart(i({request_type:"si:s",redirect_uri:a,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==o?void 0:o.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0},r),s);try{const e={},n=await this._client.processSigninResponse(l.url,e);return t.debug("got signin response"),n.session_state&&n.profile.sub?(t.info("success for subject",n.profile.sub),{session_state:n.session_state,sub:n.profile.sub}):(t.info("success, user not authenticated"),null)}catch(c){if(this.settings.monitorAnonymousSession&&c instanceof tn)switch(c.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:c.session_state}}throw c}}async _signin(e,t,n){const r=await this._signinStart(e,t);return await this._signinEnd(r.url,n)}async _signinStart(e,t){const n=this._logger.create("_signinStart");try{const r=await this._client.createSigninRequest(e);return n.debug("got signin request"),await t.navigate({url:r.url,state:r.state.id,response_mode:r.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(r){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),r}}async _signinEnd(e,t){const n=this._logger.create("_signinEnd"),r=await this._client.processSigninResponse(e,{});n.debug("got signin response");return await this._buildUser(r,t)}async _buildUser(e,t){const n=this._logger.create("_buildUser"),r=new In(e);if(t){if(t!==r.profile.sub)throw n.debug("current user does not match user returned from signin. sub from signin:",r.profile.sub),new tn(i(i({},e),{},{error:"login_required"}));n.debug("current user matches user returned from signin")}return await this.storeUser(r),n.debug("user stored"),await this._events.load(r),r}async signoutRedirect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("signoutRedirect"),{redirectMethod:n}=e,r=u(e,Ut),a=await this._redirectNavigator.prepare({redirectMethod:n});await this._signoutStart(i({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},r),a),t.info("success")}async signoutRedirectCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signoutRedirectCallback"),n=await this._signoutEnd(e);return t.info("success"),n}async signoutPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._logger.create("signoutPopup"),{popupWindowFeatures:n,popupWindowTarget:r,popupSignal:a}=e,o=u(e,Mt),s=this.settings.popup_post_logout_redirect_uri,l=await this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:r,popupSignal:a});await this._signout(i({request_type:"so:p",post_logout_redirect_uri:s,state:null==s?void 0:{}},o),l),t.info("success")}async signoutPopupCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,{keepOpen:t}),n.info("success")}async _signout(e,t){const n=await this._signoutStart(e,t);return await this._signoutEnd(n.url)}async _signoutStart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var n;const r=this._logger.create("_signoutStart");try{const a=await this._loadUser();r.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(a);const o=e.id_token_hint||a&&a.id_token;o&&(r.debug("setting id_token_hint in signout request"),e.id_token_hint=o),await this.removeUser(),r.debug("user removed, creating signout request");const s=await this._client.createSignoutRequest(e);return r.debug("got signout request"),await t.navigate({url:s.url,state:null==(n=s.state)?void 0:n.id,scriptOrigin:this.settings.iframeScriptOrigin})}catch(a){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),a}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),n=await this._client.processSignoutResponse(e);return t.debug("got signout response"),n}async signoutSilent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const n=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:r}=e,a=u(e,zt),o=this.settings.includeIdTokenInSilentSignout?null==(t=await this._loadUser())?void 0:t.id_token:void 0,s=this.settings.popup_post_logout_redirect_uri,l=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r});await this._signout(i({request_type:"so:s",post_logout_redirect_uri:s,id_token_hint:o},a),l),n.info("success")}async signoutSilentCallback(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;const t=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.settings.revokeTokenTypes;const n=this._logger.create("_revokeInternal");if(!e)return;const r=t.filter(t=>"string"===typeof e[t]);if(r.length){for(const t of r)await this._client.revokeToken(e[t],t),n.info("".concat(t," revoked successfully")),"access_token"!==t&&(e[t]=null);await this.storeUser(e),n.debug("user stored"),await this._events.load(e)}else n.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return"user:".concat(this.settings.authority,":").concat(this.settings.client_id)}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),In.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const n=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,n)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey),this.settings.dpop&&await this.settings.dpop.store.remove(this.settings.client_id)}async clearStaleState(){await this._client.clearStaleState()}async dpopProof(e,t,n,r){var a,o;const s=await(null==(o=null==(a=this.settings.dpop)?void 0:a.store)?void 0:o.get(this.settings.client_id));if(s)return await Qt.generateDPoPProof({url:e,accessToken:null==t?void 0:t.access_token,httpMethod:n,keyPair:s.keys,nonce:r})}async generateDPoPJkt(e){let t=await e.store.get(this.settings.client_id);if(!t){const n=await Qt.generateDPoPKeys();t=new Tn(n),await e.store.set(this.settings.client_id,t)}return await Qt.generateDPoPJkt(t.keys)}},ur=e=>{const{children:t,onSigninCallback:n,skipSigninCallback:r,matchSignoutCallback:a,onSignoutCallback:o,onRemoveUser:s,userManager:c=null}=e,d=u(e,Qn),[h]=l.useState(()=>null!=c?c:cr?new cr(d):{settings:d}),[p,f]=l.useReducer(Xn,Yn),m=l.useMemo(()=>Object.assign({settings:h.settings,events:h.events},Object.fromEntries(sr.map(e=>{var t,n;return[e,null!=(n=null==(t=h[e])?void 0:t.bind(h))?n:lr(e)]})),Object.fromEntries(ir.map(e=>[e,h[e]?async t=>{f({type:"NAVIGATOR_INIT",method:e});try{return await h[e](t)}catch(n){return f({type:"ERROR",error:i(i({},rr(n,"Unknown error while executing ".concat(e,"(...)."))),{},{source:e,args:t})}),null}finally{f({type:"NAVIGATOR_CLOSE"})}}:lr(e)]))),[h]),g=l.useRef(!1);l.useEffect(()=>{h&&!g.current&&(g.current=!0,(async()=>{try{let e=null;Zn()&&!r&&(e=await h.signinCallback(),n&&await n(e)),e=e||await h.getUser(),f({type:"INITIALISED",user:e})}catch(e){f({type:"ERROR",error:er(e)})}try{if(a&&a(h.settings)){const e=await h.signoutCallback();o&&await o(e)}}catch(e){f({type:"ERROR",error:tr(e)})}})())},[h,r,n,o,a]),l.useEffect(()=>{if(!h)return;const e=e=>{f({type:"USER_LOADED",user:e})};h.events.addUserLoaded(e);const t=()=>{f({type:"USER_UNLOADED"})};h.events.addUserUnloaded(t);const n=()=>{f({type:"USER_SIGNED_OUT"})};h.events.addUserSignedOut(n);const r=e=>{f({type:"ERROR",error:nr(e)})};return h.events.addSilentRenewError(r),()=>{h.events.removeUserLoaded(e),h.events.removeUserUnloaded(t),h.events.removeUserSignedOut(n),h.events.removeSilentRenewError(r)}},[h]);const v=l.useCallback(async()=>{h||lr("removeUser"),await h.removeUser(),s&&await s()},[h,s]),y=l.useMemo(()=>i(i(i({},p),m),{},{removeUser:v}),[p,m,v]);return l.createElement(Gn.Provider,{value:y},t)},dr=()=>{const e=l.useContext(Gn);return e||console.warn("AuthProvider context is undefined, please verify you are calling useAuth() as child of a <AuthProvider> component."),e};const hr={},pr={SCHEDULER_BASE:hr.VITE_SCHEDULER_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SCHEDULER_API_BASE||"http://3.91.52.109:8090",USERS_BASE:hr.VITE_USERS_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_USER_API_BASE||"http://54.210.217.249:8080/Api-user",USERS_PROFILE_PATH:hr.VITE_USERS_PROFILE_PATH||"/public/profile",PAYMENT_BASE:hr.VITE_PAYMENT_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_PAYMENT_API_BASE||"http://3.80.24.220:8081/api",CHAT_BASE:hr.VITE_CHAT_API_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CHAT_API_BASE||"http://3.90.235.238:8091",CALL_BASE:hr.VITE_CALL_API_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CALL_API_BASE||"http://54.88.120.20:8093",SEARCH_BASE:hr.VITE_SEARCH_API_BASE_URL||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SEARCH_API_BASE||"http://54.210.217.249:8080/Api-search"},fr=pr.USERS_BASE;class mr{static setToken(e){this.token=e,localStorage.setItem("uplearn_token",e)}static getToken(){return this.token||(this.token=localStorage.getItem("uplearn_token")),this.token}static clearToken(){this.token=null,localStorage.removeItem("uplearn_token")}static setCognitoToken(e){this.token=e,localStorage.setItem("uplearn_cognito_token",e)}static getCognitoToken(){return localStorage.getItem("uplearn_cognito_token")||this.token}static decodeToken(){const e=this.getToken();if(!e)return null;try{const t=e.split(".")[1];return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(yo){return console.error("Error decoding token:",yo),null}}static getCurrentUser(){const e=this.decodeToken();return e&&e?{userId:e.sub,role:e.role}:null}static async login(e,t){try{const n=await fetch("".concat(fr,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,password:t})});if(!n.ok){const e=await n.text();throw console.error("Error del servidor:",e),new Error("HTTP error! status: ".concat(n.status))}const r=await n.json();return r.authenticated&&r.token&&this.setToken(r.token),r}catch(n){throw console.error("Error en login:",n),new Error("Error de conexi\xf3n. Verifica que el servidor est\xe9 disponible.")}}static logout(){this.clearToken()}static async getStudentProfile(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(fr,"/student/profile"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error obteniendo perfil de estudiante:",t),t}}static async updateStudentProfile(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.getToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const n=await fetch("".concat(fr,"/student/profile"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!n.ok){const e=await n.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(n.status))}return await n.json()}catch(n){throw console.error("Error actualizando perfil de estudiante:",n),n}}static async removeStudentRole(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(fr,"/student/profile"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}const n=await t.json();return n.userDeleted&&this.clearToken(),n}catch(t){throw console.error("Error eliminando rol de estudiante:",t),t}}static async getTutorProfile(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(fr,"/tutor/profile"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error obteniendo perfil de tutor:",t),t}}static async updateTutorProfile(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.getToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const n=await fetch("".concat(fr,"/tutor/profile"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!n.ok){const e=await n.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(n.status))}return await n.json()}catch(n){throw console.error("Error actualizando perfil de tutor:",n),n}}static async removeTutorRole(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(fr,"/tutor/profile"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}const n=await t.json();return n.userDeleted&&this.clearToken(),n}catch(t){throw console.error("Error eliminando rol de tutor:",t),t}}static async getTutorTokensRate(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.getToken();if(!e)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(fr,"/tutor/tokens-rate"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor obteniendo tarifa de tokens:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return t.json()}catch(t){throw console.error("Error obteniendo tarifa de tokens del tutor:",t),t}}static async getTutorTokensRateBySubOrId(e){if(!e)throw new Error("idOrSub requerido");const t=async t=>{const n="".concat(fr,"/tutor/tokens-rate-by-sub?").concat(t,"=").concat(encodeURIComponent(e)),r=await fetch(n,{method:"GET",headers:{Accept:"application/json"}});if(!r.ok)return null;try{return await r.json()}catch(a){return null}},n=await t("sub");if(n&&"undefined"!==typeof n.tokensPerHour)return n;const r=await t("id");if(r&&"undefined"!==typeof r.tokensPerHour)return r;throw new Error("No se pudo obtener tokensPerHour del tutor")}static async getAllUsers(){const e=this.getToken();try{const t=await fetch("".concat(fr,"/users"),{method:"GET",headers:i({"Content-Type":"application/json"},e?{Authorization:"Bearer ".concat(e)}:{})});if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status));return t.json()}catch(t){throw console.error("Error obteniendo usuarios:",t),t}}static async getUserById(e){const t=this.getToken();try{const n=await fetch("".concat(fr,"/users/").concat(e),{method:"GET",headers:i({"Content-Type":"application/json"},t?{Authorization:"Bearer ".concat(t)}:{})});if(!n.ok)throw new Error("HTTP error! status: ".concat(n.status));return n.json()}catch(n){throw console.error("Error obteniendo usuario:",n),n}}static async processCognitoUser(e){try{const t=await fetch("".concat(fr,"/process-cognito-user"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(!t.ok){const e=await t.text();throw console.error("Error del servidor procesando Cognito:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error procesando usuario de Cognito:",t),t}}static async saveUserRole(e,t){try{const n=Array.isArray(t)?t:[t],r=await fetch("".concat(fr,"/save-user-role"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({roles:n})});if(!r.ok){const e=await r.text();throw console.error("Error del servidor guardando roles:",e),new Error(e||"HTTP error! status: ".concat(r.status))}return await r.json()}catch(n){throw console.error("Error guardando roles de usuario:",n),n}}static async getMyRoles(e){try{const t=await fetch("".concat(fr,"/my-roles"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("Error del servidor obteniendo roles:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Error obteniendo roles del usuario:",t),t}}static async getProfileStatus(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const n=t?"".concat(fr,"/profile-status?role=").concat(t):"".concat(fr,"/profile-status"),r=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!r.ok){const e=await r.text();throw console.error("Error del servidor obteniendo estado del perfil:",e),new Error(e||"HTTP error! status: ".concat(r.status))}return await r.json()}catch(n){throw console.error("Error obteniendo estado del perfil:",n),n}}static async addRoleToUser(e,t,n){try{const r=await fetch("".concat(fr,"/add-role"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({userId:t,role:n})});if(!r.ok){const e=await r.text();throw console.error("Error del servidor a\xf1adiendo rol:",e),new Error(e||"HTTP error! status: ".concat(r.status))}return await r.json()}catch(r){throw console.error("Error a\xf1adiendo rol al usuario:",r),r}}static async uploadTutorCredentials(e,t){if(!e)throw new Error("No hay token de autenticaci\xf3n");if(!t||0===t.length)throw new Error("Debe seleccionar al menos un archivo");const n=new FormData;for(const a of t)n.append("files",a);try{const t=await fetch("".concat(fr,"/tutor/credentials"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:n});if(!t.ok){const e=await t.text();throw console.error("Error subiendo credenciales:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return t.json()}catch(r){throw console.error("Error en uploadTutorCredentials:",r),r}}static async deleteTutorCredentials(e,t){if(!e)throw new Error("No hay token de autenticaci\xf3n");if(!t||0===t.length)throw new Error("Debe proporcionar al menos una URL para eliminar");try{const n=await fetch("".concat(fr,"/tutor/credentials"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({urls:t})});if(!n.ok){const e=await n.text();throw console.error("Error eliminando credenciales:",e),new Error(e||"HTTP error! status: ".concat(n.status))}return n.json()}catch(n){throw console.error("Error en deleteTutorCredentials:",n),n}}}mr.token=null;const gr=mr;let vr=null,yr=!1,br=null,wr=null;const xr=()=>{vr=null,yr=!1,br=null,wr=null},Sr=()=>{var e;const t=dr(),[n,r]=(me(),(0,l.useState)(()=>vr&&vr.isAuthenticated&&!vr.isLoading?vr:{isLoading:!0,isAuthenticated:!1,needsRoleSelection:!1,userRoles:null,error:null}));return(0,l.useEffect)(()=>{const e=async()=>{try{var e,n;const r=null===(e=t.user)||void 0===e?void 0:e.id_token;if(!r)throw new Error("Token de Cognito no disponible");const a=await gr.processCognitoUser(r),o=null===(n=a.user)||void 0===n?void 0:n.roles,s=!o||0===o.length||Array.isArray(o)&&o.every(e=>!e||""===e.trim())||null===o||void 0===o;if(a.isNewUser||s)return{isLoading:!1,isAuthenticated:!0,needsRoleSelection:!0,userRoles:null,error:null};return{isLoading:!1,isAuthenticated:!0,needsRoleSelection:!1,userRoles:a.user.roles,error:null}}catch(r){throw console.error("Error procesando flujo de autenticaci\xf3n:",r),r}};(async()=>{var n;const a=null===(n=t.user)||void 0===n?void 0:n.id_token;if(!t.isAuthenticated||!a){const e={isLoading:!1,isAuthenticated:!1,needsRoleSelection:!1,userRoles:null,error:null};return r(e),vr=e,void(wr=null)}if(vr&&vr.isAuthenticated&&!vr.isLoading&&wr===a)r(vr);else{if(wr&&wr!==a&&xr(),yr&&br&&wr===a)try{const e=await br;return void r(e)}catch(o){console.error("Error esperando proceso:",o)}yr=!0,wr=a,br=e();try{const e=await br;r(e),vr=e}catch(o){console.error("Error en el flujo de autenticaci\xf3n:",o);const e={isLoading:!1,isAuthenticated:!1,needsRoleSelection:!1,userRoles:null,error:o instanceof Error?o.message:"Error de autenticaci\xf3n"};r(e),vr=e}finally{yr=!1,br=null}}})()},[t.isAuthenticated,null===(e=t.user)||void 0===e?void 0:e.id_token]),i(i({},n),{},{auth:t})};var _r=n(579);const kr=()=>{var e,t;const n=me(),r=dr(),{userRoles:a,isAuthenticated:o}=Sr();return r.isLoading?(0,_r.jsx)("div",{className:"home-container",children:(0,_r.jsxs)("div",{className:"content",children:[(0,_r.jsx)("h1",{className:"title",children:"Cargando..."}),(0,_r.jsx)("p",{className:"subtitle",children:"Verificando estado de autenticaci\xf3n..."})]})}):(0,_r.jsx)("div",{className:"home-container",children:(0,_r.jsxs)("div",{className:"content",children:[(0,_r.jsx)("h1",{className:"title",children:"Bienvenido a UpLearn"}),(0,_r.jsx)("p",{className:"subtitle",children:"Tu plataforma de aprendizaje online"}),r.isAuthenticated?(0,_r.jsxs)("div",{className:"authenticated-section",children:[(0,_r.jsxs)("div",{className:"user-info",children:[(0,_r.jsxs)("p",{className:"welcome-message",children:["\xa1Hola, ",(null===(e=r.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.email)||"Usuario","! \ud83d\udc4b"]}),(0,_r.jsxs)("p",{className:"auth-status",children:["Estado: ",(0,_r.jsx)("strong",{children:"Autenticado con AWS Cognito"})]})]}),(0,_r.jsxs)("div",{className:"buttons-container",children:[(0,_r.jsx)("button",{className:"btn btn-dashboard",onClick:()=>{if(o&&a&&a.length>0){const e=a.includes("student")?"/student-dashboard":"/tutor-dashboard";n(e)}else n("/login")},children:"Ir al Dashboard"}),(0,_r.jsx)("button",{className:"btn btn-logout",onClick:async()=>{r.removeUser();window.location.href="".concat("https://us-east-18mvprkbvu.auth.us-east-1.amazoncognito.com","/logout?client_id=").concat("342s18a96gl2pbaroorqh316l8","&logout_uri=").concat(encodeURIComponent("http://localhost:3000"))},children:"Cerrar Sesi\xf3n"})]})]}):(0,_r.jsxs)("div",{className:"buttons-container",children:[(0,_r.jsx)("button",{className:"btn btn-login",onClick:()=>{r.signinRedirect()},children:"Iniciar Sesi\xf3n"}),(0,_r.jsx)("button",{className:"btn btn-register",onClick:()=>{r.signinRedirect({extraQueryParams:{signup:"true"}})},children:"Registrarse"})]}),r.error&&(0,_r.jsxs)("div",{className:"error-info",children:[(0,_r.jsx)("h3",{children:"Error de Autenticaci\xf3n"}),(0,_r.jsx)("p",{children:r.error.message})]})]})})},Er=()=>{var e,t,n,r;const a=dr(),o=he(),[s,i]=(0,l.useState)(null),[c,u]=(0,l.useState)(!0),[d,h]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{var e;if(!a.isAuthenticated||null===(e=a.user)||void 0===e||!e.id_token)return console.log("\ud83d\udd0d useProfileStatus: No autenticado o sin token"),void u(!1);try{let e;u(!0),h(null),o.pathname.includes("/student-dashboard")?e="STUDENT":o.pathname.includes("/tutor-dashboard")&&(e="TUTOR"),console.log("\ud83d\udd0d useProfileStatus: Verificando estado del perfil...",e?"para rol: ".concat(e):"sin rol espec\xedfico");const t=await gr.getProfileStatus(a.user.id_token,e);console.log("\u2705 useProfileStatus: Estado recibido:",t),i(t)}catch(t){console.error("\u274c useProfileStatus: Error verificando estado del perfil:",t),h(t instanceof Error?t.message:"Error verificando el perfil")}finally{u(!1)}})()},[a.isAuthenticated,null===(e=a.user)||void 0===e?void 0:e.id_token,o.pathname]);const p={profileStatus:s,isLoading:c,error:d,isProfileComplete:null===(t=null!==(n=null===s||void 0===s?void 0:s.complete)&&void 0!==n?n:null===s||void 0===s?void 0:s.isComplete)||void 0===t||t,missingFields:null!==(r=null===s||void 0===s?void 0:s.missingFields)&&void 0!==r?r:null};return console.log("\ud83d\udcca useProfileStatus: Retornando resultado:",p),p},Nr=(pr.SCHEDULER_BASE||"http://3.91.52.109:8090").replace(/\/$/,"");function jr(e){const t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}async function Cr(e){if(!e.ok){var t,n,r;let o=null;try{o=await e.json()}catch(a){o=await e.text().catch(()=>null)}const s="string"===typeof o?o:(null===(t=o)||void 0===t?void 0:t.message)||(null===(n=o)||void 0===n?void 0:n.error)||(null===(r=o)||void 0===r?void 0:r.path)||"HTTP ".concat(e.status),i="HTTP ".concat(e.status,": ").concat(s);throw new Error(i)}return 204===e.status?null:e.json()}async function Tr(e,t,n){const r="".concat(Nr,"/api/reservations/my?from=").concat(e,"&to=").concat(t);return Cr(await fetch(r,{method:"GET",headers:jr(n)}))}async function Pr(e,t,n){const r="".concat(Nr,"/api/reservations/for-me?from=").concat(e,"&to=").concat(t);return Cr(await fetch(r,{method:"GET",headers:jr(n)}))}async function Ar(e,t){const n="".concat(Nr,"/api/reservations/").concat(e,"/cancel");return Cr(await fetch(n,{method:"PATCH",headers:jr(t)}))}async function Ir(e,t,n){const r="".concat(Nr,"/api/schedule/tutor/").concat(encodeURIComponent(e),"?weekStart=").concat(t);return Cr(await fetch(r,{method:"GET",headers:jr(n)}))}async function Rr(e,t,n){const r="".concat(Nr,"/api/availability/add");return Cr(await fetch(r,{method:"POST",headers:jr(n),body:JSON.stringify({date:e,hours:t})}))}async function Dr(e,t){const n="".concat(Nr,"/api/availability/day/").concat(e),r=await fetch(n,{method:"PUT",headers:jr(t),body:JSON.stringify({hours:[]})});await Cr(r)}const Or=e=>{let{currentRole:t,className:n="",asMenuItem:r=!1}=e;const{switchToDashboard:a,canSwitchTo:o,isLoading:s,error:i}=(()=>{const e=me(),t=dr(),[n,r]=(0,l.useState)(!1),[a,o]=(0,l.useState)("");return{switchToDashboard:async n=>{var s;if(null===(s=t.user)||void 0===s||!s.id_token)return o("No hay token de autenticaci\xf3n disponible"),!1;r(!0),o("");try{return((await gr.getMyRoles(t.user.id_token)).roles||[]).includes(n)?(e("student"===n?"/student-dashboard":"/tutor-dashboard"),!0):(o("No tienes permisos para acceder como ".concat("student"===n?"estudiante":"tutor")),!1)}catch(a){return console.error("Error cambiando dashboard:",a),o(a instanceof Error?a.message:"Error al cambiar de dashboard"),!1}finally{r(!1)}},canSwitchTo:async e=>{var n;if(null===(n=t.user)||void 0===n||!n.id_token)return!1;try{return((await gr.getMyRoles(t.user.id_token)).roles||[]).includes(e)}catch(a){return console.error("Error verificando roles:",a),!1}},isLoading:n,error:a}})(),[c,u]=(0,l.useState)(!1),d="student"===t?"tutor":"student",h="student"===d?"Estudiante":"Tutor",p="student"===d?"\ud83d\udcda":"\ud83d\udc68\u200d\ud83c\udfeb";(0,l.useEffect)(()=>{const e=async()=>{const e=await o(d);u(e)};e();const t=setInterval(e,2e3);return()=>clearInterval(t)},[d,o]);const f=async()=>{await a(d)};return c?r?(0,_r.jsxs)("button",{className:"dropdown-item ".concat(n),onClick:f,disabled:s,children:[(0,_r.jsx)("span",{children:p})," ",s?"Cambiando...":"Ir a ".concat(h)]}):(0,_r.jsxs)("div",{className:"dashboard-switch-container",children:[(0,_r.jsxs)("button",{className:"dashboard-switch-btn ".concat(n),onClick:f,disabled:s,title:"Cambiar a dashboard de ".concat(h),children:[(0,_r.jsx)("span",{className:"switch-icon",children:p}),(0,_r.jsx)("span",{className:"switch-text",children:s?"Cambiando...":"Ir a ".concat(h)})]}),i&&(0,_r.jsx)("div",{className:"switch-error",style:{color:"red",fontSize:"12px",marginTop:"4px"},children:i})]}):null},Lr=e=>{let{currentRole:t,className:n="",asMenuItem:r=!1}=e;const{addRole:a,canAddRole:o,isLoading:s,error:i,success:c,clearMessages:u}=(()=>{const e=dr(),[t,n]=(0,l.useState)(!1),[r,a]=(0,l.useState)(""),[o,s]=(0,l.useState)("");return{addRole:async t=>{var o,i,l;if(null===(o=e.user)||void 0===o||!o.id_token)return a("No hay token de autenticaci\xf3n disponible"),!1;if(null===(i=e.user)||void 0===i||null===(l=i.profile)||void 0===l||!l.sub)return a("No se pudo obtener el ID del usuario"),!1;n(!0),a(""),s("");try{return((await gr.getMyRoles(e.user.id_token)).roles||[]).includes(t)?(a("Ya tienes el rol de ".concat("student"===t?"estudiante":"tutor")),!1):(await gr.addRoleToUser(e.user.id_token,e.user.profile.sub,t),s("\xa1Ahora tambi\xe9n eres ".concat("student"===t?"estudiante":"tutor","! Puedes cambiar entre dashboards.")),xr(),!0)}catch(r){return console.error("Error a\xf1adiendo rol:",r),a(r instanceof Error?r.message:"Error al a\xf1adir el rol"),!1}finally{n(!1)}},canAddRole:async t=>{var n;if(null===(n=e.user)||void 0===n||!n.id_token)return!1;try{return!((await gr.getMyRoles(e.user.id_token)).roles||[]).includes(t)}catch(r){return console.error("Error verificando roles:",r),!1}},isLoading:t,error:r,success:o,clearMessages:()=>{a(""),s("")}}})(),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),m="student"===t?"tutor":"student",g="student"===m?"Estudiante":"Tutor",v="student"===m?"\ud83d\udcda":"\ud83d\udc68\u200d\ud83c\udfeb";(0,l.useEffect)(()=>{(async()=>{const e=await o(m);h(e)})()},[m,o]);const y=async()=>{const e=await a(m);if((e||i)&&(f(!0),setTimeout(()=>{f(!1),u()},5e3),e)){const e=await o(m);h(e)}};return d?r?(0,_r.jsxs)("button",{className:"dropdown-item ".concat(n),onClick:y,disabled:s,children:[(0,_r.jsx)("span",{children:v})," ",s?"A\xf1adiendo...":"Ser ".concat(g)]}):(0,_r.jsxs)("div",{className:"add-role-container",children:[(0,_r.jsxs)("button",{className:"add-role-btn ".concat(n),onClick:y,disabled:s,title:"Convertirte tambi\xe9n en ".concat(g),children:[(0,_r.jsx)("span",{className:"add-role-icon",children:v}),(0,_r.jsx)("span",{className:"add-role-text",children:s?"A\xf1adiendo...":"Ser ".concat(g)})]}),p&&(c||i)&&(0,_r.jsx)("div",{className:"add-role-message ".concat(c?"success":"error"),children:(0,_r.jsxs)("div",{className:"message-content",children:[(0,_r.jsx)("span",{className:"message-icon",children:c?"\u2705":"\u274c"}),(0,_r.jsx)("span",{className:"message-text",children:c||i}),(0,_r.jsx)("button",{className:"message-close",onClick:()=>{f(!1),u()},title:"Cerrar mensaje",children:"\xd7"})]})})]}):null},Ur=e=>{let{missingFields:t,currentRole:n,onDismiss:r}=e;const a=me();return(0,_r.jsxs)("section",{className:"profile-incomplete-notification","aria-label":"Aviso de perfil incompleto","aria-live":"polite",children:[r&&(0,_r.jsx)("button",{type:"button",className:"btn-dismiss btn-dismiss-floating","aria-label":"Cerrar aviso de perfil incompleto",onClick:r,children:"\xd7"}),(0,_r.jsxs)("div",{className:"notification-content",children:[(0,_r.jsxs)("div",{className:"notification-text",children:[(0,_r.jsx)("h3",{children:"Perfil Incompleto"}),(0,_r.jsx)("p",{children:"Por favor completa tu perfil para aprovechar todas las funcionalidades."})]}),(0,_r.jsx)("div",{className:"notification-actions",children:(0,_r.jsx)("button",{className:"btn-complete-profile",onClick:()=>{a("/edit-profile",{state:{currentRole:n}})},type:"button",children:"Completar Perfil"})})]})]})},Mr=pr.PAYMENT_BASE;function zr(e){const t=[e.url,e.sessionUrl,e.session_url,e.checkoutUrl,e.checkout_url,e.redirectUrl,e.redirect_url].filter(Boolean);if(t.length>0)return t[0];for(const n of Object.values(e))if("string"===typeof n&&n.startsWith("http")&&n.includes("stripe.com"))return n;return null}const Fr=class{static getCognitoToken(){return localStorage.getItem("uplearn_cognito_token")}static async checkStudentTokens(e,t){if(e<=0)return{hasEnoughTokens:!0,requiredTokens:e,currentBalance:1/0,role:"STUDENT"};const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");const r=async e=>{const t=await fetch(e,{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});if(!t.ok)throw new Error(String(t.status));return t.json()},a="".concat(Mr,"/wallet/student/check/").concat(e),o="".concat(Mr,"/wallet/check/student/").concat(e);try{return await r(a)}catch(yo){if("404"===(null===yo||void 0===yo?void 0:yo.message))try{return await r(o)}catch(s){throw new Error("Error verificando tokens del estudiante")}if("500"===(null===yo||void 0===yo?void 0:yo.message))try{return await r(o)}catch(s){throw new Error("Error verificando tokens del estudiante")}throw new Error("Error verificando tokens del estudiante")}}static async createCheckoutSession(e,t){const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(Mr,"/stripe/checkout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({quantity:e.quantity,name:e.name||"Token",currency:e.currency||"cop"})});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}const r=await t.json(),a=zr(r);return console.log("[ApiPayment] createCheckoutSession raw response:",r),console.log("[ApiPayment] extracted checkoutUrl:",a),"success"===r.status&&a?i(i({},r),{},{url:a}):r}catch(r){throw console.error("Error creando sesi\xf3n de checkout:",r),r}}static async getStudentBalance(e){const t=e||this.getCognitoToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const e=await fetch("".concat(Mr,"/wallet/balance/student"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!e.ok){const t=await e.text();throw console.error("Error del servidor:",t),new Error(t||"HTTP error! status: ".concat(e.status))}return await e.json()}catch(n){throw console.error("Error obteniendo balance de estudiante:",n),n}}static async getTutorBalance(e){const t=e||this.getCognitoToken();if(!t)throw new Error("No hay token de autenticaci\xf3n");try{const e=await fetch("".concat(Mr,"/wallet/balance/tutor"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!e.ok){const t=await e.text();throw console.error("Error del servidor:",t),new Error(t||"HTTP error! status: ".concat(e.status))}return await e.json()}catch(n){throw console.error("Error obteniendo balance de tutor:",n),n}}static async handlePaymentSuccess(e,t){const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(Mr,"/stripe/webhook/success"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(r){throw console.error("Error procesando pago exitoso:",r),r}}static async confirmPayment(e){if(!e)throw new Error("sessionId requerido");try{const n=await fetch("".concat(Mr,"/stripe/confirm-payment"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e})}),r=await n.text();let a={};try{a=r?JSON.parse(r):{}}catch(t){}if(!n.ok)throw new Error(a.message||r||"Error HTTP ".concat(n.status));if(!a.success)throw new Error(a.message||"Pago no confirmado por el servidor");return a}catch(yo){if("Failed to fetch"===(null===yo||void 0===yo?void 0:yo.message))throw new Error("No se pudo conectar al servicio de pagos para confirmar.");throw yo}}static async transferTokens(e,t,n,r,a){const o=a||this.getCognitoToken();if(!o)throw new Error("No hay token de autenticaci\xf3n");try{const a=await fetch("".concat(Mr,"/wallet/transfer"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({fromUserId:e,toUserId:t,tokens:n,reservationId:r})});if(!a.ok){const e=await a.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(a.status))}return await a.json()}catch(s){throw console.error("Error transfiriendo tokens:",s),s}}static async refundOnCancellation(e,t){const n=t||this.getCognitoToken();if(!n)throw new Error("No hay token de autenticaci\xf3n");try{const t=await fetch("".concat(Mr,"/wallet/refund"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(e)});if(!t.ok){const e=await t.text();throw console.error("Error del servidor:",e),new Error(e||"HTTP error! status: ".concat(t.status))}return t.json()}catch(r){throw console.error("Error procesando cancelaci\xf3n (refund):",r),r}}},Hr=[{tokens:10,price:2e4,popular:!1},{tokens:25,price:5e4,popular:!0},{tokens:50,price:1e5,popular:!1},{tokens:100,price:2e5,popular:!1}],Br=e=>{let{isOpen:t,onClose:n,currentBalance:r,cognitoToken:a}=e;const[o,s]=(0,l.useState)(null),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)(!1),[h,p]=(0,l.useState)(null);if(!t)return null;const f=2e3,m=2e3,g=e=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(e),v=o||parseInt(i,10)||0,y=v*m;return(0,_r.jsx)("div",{className:"modal-overlay",onClick:n,children:(0,_r.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,_r.jsxs)("div",{className:"modal-header",children:[(0,_r.jsxs)("h2",{children:[(0,_r.jsx)("img",{src:"/coin-icon.png",alt:"Moneda",className:"coin-icon"}),"Comprar Tokens"]}),(0,_r.jsx)("button",{className:"close-button",onClick:n,type:"button",children:"\u2715"})]}),(0,_r.jsxs)("div",{className:"modal-body",children:[(0,_r.jsxs)("div",{className:"current-balance",children:[(0,_r.jsx)("span",{className:"balance-label",children:"Balance actual:"}),(0,_r.jsxs)("span",{className:"balance-amount",children:[r," tokens"]})]}),(0,_r.jsxs)("div",{className:"packages-section",children:[(0,_r.jsx)("h3",{children:"Paquetes de tokens"}),(0,_r.jsxs)("p",{className:"conversion-rate",children:["1 Token = ",g(m)," (m\xednimo total ",g(f),")"]}),(0,_r.jsx)("div",{className:"packages-grid",children:Hr.map(e=>(0,_r.jsxs)("button",{className:"package-card ".concat(o===e.tokens?"selected":""," ").concat(e.popular?"popular":""),onClick:()=>{return t=e.tokens,s(t),c(""),void p(null);var t},disabled:u,type:"button",children:[e.popular&&(0,_r.jsx)("span",{className:"popular-badge",children:"M\xe1s popular"}),(0,_r.jsxs)("div",{className:"package-tokens",children:[e.tokens," tokens"]}),(0,_r.jsx)("div",{className:"package-price",children:g(e.price)})]},e.tokens))})]}),(0,_r.jsxs)("div",{className:"custom-amount-section",children:[(0,_r.jsx)("h3",{children:"Cantidad personalizada"}),(0,_r.jsxs)("div",{className:"custom-input-wrapper",children:[(0,_r.jsx)("input",{type:"text",className:"custom-input",placeholder:"Ingresa cantidad de tokens",value:i,onChange:e=>{const t=e.target.value;(""===t||/^\d+$/.test(t))&&(c(t),s(null),p(null))},disabled:u}),(0,_r.jsx)("span",{className:"input-suffix",children:"tokens"})]}),i&&parseInt(i,10)>0&&(0,_r.jsxs)("p",{className:"custom-price",children:["Total: ",g(parseInt(i,10)*m)]})]}),h&&(0,_r.jsxs)("div",{className:"error-message",children:["\u26a0\ufe0f ",h]}),(0,_r.jsx)("div",{className:"purchase-summary",children:v>0&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)("div",{className:"summary-row",children:[(0,_r.jsx)("span",{children:"Tokens a comprar:"}),(0,_r.jsx)("strong",{children:v})]}),(0,_r.jsxs)("div",{className:"summary-row total",children:[(0,_r.jsx)("span",{children:"Total a pagar:"}),(0,_r.jsx)("strong",{children:g(y)})]}),y<f&&(0,_r.jsxs)("div",{className:"summary-row",style:{color:"#dc2626"},children:[(0,_r.jsx)("span",{children:"Falta para m\xednimo:"}),(0,_r.jsx)("strong",{children:g(f-y)})]})]})})]}),(0,_r.jsxs)("div",{className:"modal-footer",children:[(0,_r.jsx)("button",{className:"btn-secondary",onClick:n,disabled:u,type:"button",children:"Cancelar"}),(0,_r.jsx)("button",{className:"btn-primary",onClick:()=>{const e=o||parseInt(i,10);!e||e<=0?p("Por favor selecciona un paquete o ingresa una cantidad v\xe1lida"):e>1e3?p("La cantidad m\xe1xima es 1000 tokens"):(async e=>{d(!0),p(null);try{const t=e*m;if(t<f){const e=f-t;return p("El total debe ser \u2265 ".concat(f," COP. Faltan ").concat(e," COP.")),void d(!1)}const n={quantity:e,name:"Token",currency:"cop"},r=await Fr.createCheckoutSession(n,a);console.log("[BuyTokensModal] checkout response:",r);const o=zr(r);if("success"===r.status&&o)return void(window.location.href=o);if("success"===r.status&&!o)throw new Error("Respuesta exitosa sin URL. Claves recibidas: ".concat(Object.keys(r).join(", ")));throw new Error(r.message||"Error desconocido del backend de pagos")}catch(t){console.error("Error al crear sesi\xf3n de pago:",t),p(t instanceof Error?t.message:"Error al procesar la compra"),d(!1)}})(e)},disabled:u||v<=0,type:"button",children:u?"\u23f3 Procesando...":"\ud83d\udd12 Pagar con Stripe"})]}),(0,_r.jsxs)("div",{className:"payment-info",children:[(0,_r.jsx)("p",{children:"\ud83d\udd12 Pago seguro procesado por Stripe"}),(0,_r.jsx)("p",{children:"Los tokens se agregar\xe1n a tu cuenta despu\xe9s del pago exitoso"}),(0,_r.jsxs)("p",{style:{fontSize:"12px",color:"#6b7280"},children:["Cantidad seleccionada: ",v]})]})]})})};function Wr(e,t){switch(t){case"dashboard":e("/student-dashboard");break;case"find-tutors":e("/student-finds-tutors");break;case"my-reservations":e("/student-reservations");break;case"my-tasks":e("/student-dashboard?section=my-tasks");break;case"post-task":e("/student-dashboard?section=post-task")}}function Vr(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function qr(e,t){const n=new Date(e+"T00:00:00");return n.setDate(n.getDate()+t),Vr(n)}function $r(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}const Jr=e=>{var t,n;let{currentUser:r,activeSection:a="none",onSectionChange:o=()=>{},tokenBalance:s=0,onBuyTokensClick:i=()=>{}}=e;const c=me(),u=dr(),[d,h]=(0,l.useState)(!1);return(0,_r.jsx)("header",{className:"dashboard-header",children:(0,_r.jsxs)("div",{className:"header-content",children:[(0,_r.jsx)("div",{className:"logo",children:(0,_r.jsx)("h2",{children:"UpLearn Student"})}),(0,_r.jsxs)("nav",{className:"main-nav",children:[(0,_r.jsxs)("button",{className:"nav-item ".concat("dashboard"===a?"active":""),onClick:()=>o("dashboard"),type:"button",children:[(0,_r.jsx)("span",{children:"\ud83d\udcca"})," Dashboard"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("find-tutors"===a?"active":""),onClick:()=>o("find-tutors"),type:"button",children:[(0,_r.jsx)("span",{children:"\ud83d\udd0d"})," Buscar Tutores"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("my-reservations"===a?"active":""),onClick:()=>o("my-reservations"),type:"button",children:[(0,_r.jsx)("span",{children:"\ud83d\uddd3\ufe0f"})," Mis Reservas"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("my-tasks"===a?"active":""),onClick:()=>o("my-tasks"),type:"button",children:[(0,_r.jsx)("span",{children:"\ud83d\udccb"})," Mis Tareas"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("post-task"===a?"active":""),onClick:()=>o("post-task"),type:"button",children:[(0,_r.jsx)("span",{children:"\u2795"})," Publicar Tarea"]})]}),(0,_r.jsxs)("div",{className:"header-actions",style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,_r.jsxs)("div",{className:"token-display",onClick:i,style:{cursor:"pointer"},children:[(0,_r.jsx)("img",{src:"/coin-icon.png",alt:"Moneda",className:"token-icon",style:{width:"24px",height:"24px",objectFit:"contain"}}),(0,_r.jsx)("span",{className:"token-amount",children:s}),(0,_r.jsx)("span",{className:"token-label",children:"tokens"})]}),(0,_r.jsxs)("div",{className:"user-menu-container",children:[(0,_r.jsxs)("button",{className:"user-avatar",onClick:()=>h(!d),type:"button",children:[(0,_r.jsx)("span",{className:"avatar-icon",children:"\ud83d\udc64"}),(0,_r.jsx)("span",{className:"user-name",children:null!==(t=null===r||void 0===r?void 0:r.name)&&void 0!==t?t:"Usuario"}),(0,_r.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),d&&(0,_r.jsxs)("div",{className:"user-dropdown",children:[(0,_r.jsxs)("div",{className:"user-info",children:[(0,_r.jsx)("p",{className:"user-email",children:null!==(n=null===r||void 0===r?void 0:r.email)&&void 0!==n?n:"No email"}),(0,_r.jsxs)("p",{className:"user-role",children:["Estudiante",null!==r&&void 0!==r&&r.educationLevel?" - ".concat(r.educationLevel):""]})]}),(0,_r.jsx)("div",{className:"dropdown-divider"}),(0,_r.jsxs)("button",{className:"dropdown-item",onClick:()=>{c("/edit-profile",{state:{currentRole:"student"}})},type:"button",children:[(0,_r.jsx)("span",{children:"\u270f\ufe0f"})," Editar Perfil"]}),(0,_r.jsx)(Lr,{currentRole:"student",asMenuItem:!0}),(0,_r.jsx)(Or,{currentRole:"student",asMenuItem:!0}),(0,_r.jsxs)("button",{className:"dropdown-item logout",onClick:async()=>{u.removeUser();globalThis.location.href="".concat("https://us-east-18mvprkbvu.auth.us-east-1.amazoncognito.com","/logout?client_id=").concat("342s18a96gl2pbaroorqh316l8","&logout_uri=").concat(encodeURIComponent("http://localhost:3000"))},type:"button",children:[(0,_r.jsx)("span",{children:"\ud83d\udeaa"})," Cerrar Sesi\xf3n"]})]})]})]})]})})},Kr=e=>{let{tasks:t,setTasks:n}=e;const[r,a]=(0,l.useState)({title:"",description:"",subject:"",dueDate:"",priority:"medium"});return(0,_r.jsx)("div",{className:"task-form-container",children:(0,_r.jsxs)("div",{className:"task-form",children:[(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{htmlFor:"task-title",children:"T\xedtulo"}),(0,_r.jsx)("input",{id:"task-title",type:"text",value:r.title,onChange:e=>a(i(i({},r),{},{title:e.target.value})),placeholder:"Ej: Ayuda con c\xe1lculo",className:"form-input"})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{htmlFor:"task-description",children:"Descripci\xf3n"}),(0,_r.jsx)("textarea",{id:"task-description",value:r.description,onChange:e=>a(i(i({},r),{},{description:e.target.value})),placeholder:"Describe lo que necesitas...",className:"form-textarea",rows:4})]}),(0,_r.jsxs)("div",{className:"form-row",children:[(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{htmlFor:"task-subject",children:"Materia"}),(0,_r.jsxs)("select",{id:"task-subject",value:r.subject,onChange:e=>a(i(i({},r),{},{subject:e.target.value})),className:"form-select",children:[(0,_r.jsx)("option",{value:"",children:"Seleccionar materia"}),["Matem\xe1ticas","F\xedsica","Qu\xedmica","Programaci\xf3n","Ingl\xe9s","Historia","Biolog\xeda"].map(e=>(0,_r.jsx)("option",{value:e,children:e},e))]})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{htmlFor:"task-due-date",children:"Fecha L\xedmite"}),(0,_r.jsx)("input",{id:"task-due-date",type:"date",value:r.dueDate,onChange:e=>a(i(i({},r),{},{dueDate:e.target.value})),className:"form-input"})]})]}),(0,_r.jsxs)("fieldset",{className:"form-group",children:[(0,_r.jsx)("legend",{children:"Prioridad"}),(0,_r.jsx)("div",{className:"priority-options",children:["low","medium","high"].map(e=>(0,_r.jsxs)("label",{className:"priority-option",htmlFor:"priority-".concat(e),children:[(0,_r.jsx)("input",{id:"priority-".concat(e),type:"radio",name:"priority",value:e,checked:r.priority===e,onChange:e=>a(i(i({},r),{},{priority:e.target.value}))}),(0,_r.jsx)("span",{className:"priority-label",children:e.charAt(0).toUpperCase()+e.slice(1)})]},e))})]}),(0,_r.jsxs)("div",{className:"form-actions",children:[(0,_r.jsx)("button",{className:"btn-primary btn-large",onClick:()=>{if(r.title&&r.description&&r.subject){const e=i(i({id:Date.now().toString()},r),{},{status:"pending"});n(t=>[...t,e]),a({title:"",description:"",subject:"",dueDate:"",priority:"medium"}),alert("Tarea publicada exitosamente!")}},type:"button",children:"Publicar Tarea"}),(0,_r.jsx)("button",{className:"btn-secondary",onClick:()=>a({title:"",description:"",subject:"",dueDate:"",priority:"medium"}),type:"button",children:"Limpiar"})]})]})})},Qr=()=>{var e;const t=me(),n=he(),r=dr(),[a,o]=(0,l.useState)(void 0);(0,l.useEffect)(()=>{var e,t,n;r.isAuthenticated&&r.user?o(null!==(e=null===(t=r.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=r.user)||void 0===n?void 0:n.access_token):o(void 0)},[r.isAuthenticated,r.user]);const{userRoles:s,isAuthenticated:i,needsRoleSelection:c}=Sr(),{isProfileComplete:u,missingFields:d}=Er(),[h,p]=(0,l.useState)(!0),[f,m]=(0,l.useState)(null),[g,v]=(0,l.useState)("dashboard"),[y,b]=(0,l.useState)(0),[w,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!a)return;const e=async()=>{try{const e=await Fr.getStudentBalance(a);b(e.tokenBalance)}catch(e){console.error("Error cargando balance de tokens:",e),b(0)}};e();const t=setInterval(e,3e4),n=()=>{e()};return window.addEventListener("tokens:refresh",n),()=>{clearInterval(t),window.removeEventListener("tokens:refresh",n)}},[a]),(0,l.useEffect)(()=>{const e=new URLSearchParams(n.search).get("section");e&&e!==g&&v(e)},[n.search]),(0,l.useEffect)(()=>{var e,n,a,o;null!==i&&null!==s&&(i?c?t("/role-selection"):null!==s&&void 0!==s&&s.includes("student")?r.user&&m({userId:(null===(e=r.user.profile)||void 0===e?void 0:e.sub)||"unknown",name:(null===(n=r.user.profile)||void 0===n?void 0:n.name)||(null===(a=r.user.profile)||void 0===a?void 0:a.nickname)||"Usuario",email:(null===(o=r.user.profile)||void 0===o?void 0:o.email)||"No email",role:"student"}):t("/"):t("/login"))},[i,s,c,t,r.user]);const[S,_]=(0,l.useState)([{id:"1",title:"Tarea de C\xe1lculo",description:"Resolver ejercicios de derivadas",subject:"Matem\xe1ticas",dueDate:"2025-10-01",priority:"high",status:"pending"},{id:"2",title:"Proyecto de Programaci\xf3n",description:"Crear una aplicaci\xf3n web con React",subject:"Programaci\xf3n",dueDate:"2025-10-05",priority:"medium",status:"in_progress"}]),[k]=(0,l.useState)(()=>function(e){const t=new Date(e+"T00:00:00"),n=t.getDay(),r=(0===n?-6:1)-n;return t.setDate(t.getDate()+r),Vr(t)}(Vr(new Date))),[E,N]=(0,l.useState)([]);(0,l.useEffect)(()=>{a&&(async()=>{const e=qr(k,-35),t=qr(k,35);try{const n=await Tr(e,t,a);N(n)}catch(n){N([])}})()},[a,k]);const j=(0,l.useMemo)(()=>E.filter(e=>"CANCELADO"!==e.status&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return new Date("".concat(e.date,"T").concat($r(e.end))).getTime()>=t.getTime()}(e)).length,[E]),C=(0,l.useMemo)(()=>{const e=new Set;for(const t of E)t.tutorId&&e.add(t.tutorId);return e.size},[E]);if(r.isLoading)return(0,_r.jsx)("div",{className:"full-center",children:"\u23f3 Verificando acceso..."});if(!f)return(0,_r.jsx)("div",{className:"full-center",children:"\ud83d\udd0d Cargando informaci\xf3n..."});return(0,_r.jsxs)("div",{className:"dashboard-container",children:[!u&&d&&h&&(0,_r.jsx)(Ur,{missingFields:d,currentRole:"student",onDismiss:()=>p(!1)}),(0,_r.jsx)(Br,{isOpen:w,onClose:()=>x(!1),currentBalance:y,cognitoToken:a}),(0,_r.jsx)(Jr,{currentUser:f,activeSection:g,onSectionChange:e=>{"find-tutors"!==e&&"my-reservations"!==e||Wr(t,e),"my-tasks"!==e&&"post-task"!==e&&"dashboard"!==e||v(e)},tokenBalance:y,onBuyTokensClick:()=>x(!0)}),(0,_r.jsxs)("main",{className:"dashboard-main",children:["dashboard"===g&&(0,_r.jsxs)("div",{className:"dashboard-content",children:[(0,_r.jsxs)("h1",{children:["\xa1Bienvenido, ",f.name,"! \ud83d\udc4b"]}),(0,_r.jsxs)("div",{className:"stats-grid",children:[(0,_r.jsxs)("button",{type:"button",className:"stat-card stat-card--action",onClick:()=>v("my-tasks"),"aria-label":"Ir a Mis Tareas",children:[(0,_r.jsx)("span",{className:"stat-icon",children:"\ud83d\udcda"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:S.filter(e=>"completed"===e.status).length}),(0,_r.jsx)("p",{children:"Tareas Activas"})]})]}),(0,_r.jsxs)("button",{type:"button",className:"stat-card stat-card--action",onClick:()=>Wr(t,"find-tutors"),"aria-label":"Ir a Mis Reservas",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83e\uddd1\u200d\ud83c\udfeb"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:C}),(0,_r.jsx)("p",{children:"Tutores Encontrados"})]})]}),(0,_r.jsxs)("button",{type:"button",className:"stat-card stat-card--action",onClick:()=>v("my-tasks"),"aria-label":"Ir a Mis Tareas",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\u2705"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:S.filter(e=>"completed"===e.status).length}),(0,_r.jsx)("p",{children:"Tareas Completadas"})]})]}),(0,_r.jsxs)("button",{type:"button",className:"stat-card stat-card--action",onClick:()=>Wr(t,"my-reservations"),"aria-label":"Ir a Mis Reservas",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83d\uddd3\ufe0f"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:j}),(0,_r.jsx)("p",{children:"Reservas Pr\xf3ximas"})]})]})]}),(0,_r.jsxs)("div",{className:"recent-activity",children:[(0,_r.jsx)("h2",{children:"Actividad Reciente"}),(0,_r.jsxs)("div",{className:"activity-list",children:[S.length>0&&(0,_r.jsxs)("div",{className:"activity-item",children:[(0,_r.jsx)("span",{className:"activity-icon",children:"\ud83d\udcdd"}),(0,_r.jsxs)("div",{className:"activity-content",children:[(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Nueva tarea:"})," ",null===(e=S[0])||void 0===e?void 0:e.title]}),(0,_r.jsx)("small",{children:"Hace 2 horas"})]})]}),E.length>0&&(0,_r.jsxs)("div",{className:"activity-item",children:[(0,_r.jsx)("span",{className:"activity-icon",children:"\ud83d\uddd3\ufe0f"}),(0,_r.jsxs)("div",{className:"activity-content",children:[(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Reserva:"})," ",E[0].date," a las ",$r(E[0].start)]}),(0,_r.jsx)("small",{children:"Ayer"})]})]})]})]})]}),"my-tasks"===g&&(0,_r.jsxs)("div",{className:"tasks-section",children:[(0,_r.jsx)("h1",{children:"Mis Tareas \ud83d\udccb"}),(0,_r.jsx)("div",{className:"tasks-grid",children:S.map(e=>(0,_r.jsxs)("div",{className:"task-card",children:[(0,_r.jsxs)("div",{className:"task-header",children:[(0,_r.jsx)("h3",{children:e.title}),(0,_r.jsxs)("div",{className:"task-meta",children:[(0,_r.jsx)("span",{className:"priority-badge",style:{backgroundColor:{high:"#ef4444",medium:"#f59e0b",low:"#10b981"}[e.priority]},children:e.priority.toUpperCase()}),(0,_r.jsx)("span",{className:"status-badge",style:{color:{completed:"#10b981",in_progress:"#3b82f6",pending:"#6b7280"}[e.status]},children:e.status.replace("_"," ").toUpperCase()})]})]}),(0,_r.jsx)("p",{className:"task-description",children:e.description}),(0,_r.jsxs)("div",{className:"task-details",children:[(0,_r.jsxs)("span",{className:"task-subject",children:["\ud83d\udcda ",e.subject]}),(0,_r.jsxs)("span",{className:"task-due-date",children:["\ud83d\udcc5 ",e.dueDate]})]}),(0,_r.jsxs)("div",{className:"task-actions",children:[(0,_r.jsx)("button",{className:"btn-primary",type:"button",children:"Ver Detalles"}),(0,_r.jsx)("button",{className:"btn-secondary",type:"button",children:"Editar"})]})]},e.id))})]}),"post-task"===g&&(0,_r.jsxs)("div",{className:"post-task-section",children:[(0,_r.jsx)("h1",{children:"Publicar Nueva Tarea \u2795"}),(0,_r.jsx)(Kr,{tasks:S,setTasks:_})]})]})]})};function Gr(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}const Yr=Array.from({length:24},(e,t)=>"".concat(String(t).padStart(2,"0"),":00"));function Xr(e,t){return function(e,t){const[n,r]=Gr(t).split(":").map(Number),a=new Date(e+"T00:00:00");return a.setHours(n,r,0,0),a}(e,Gr(t)).getTime()<function(){const e=new Date;e.setSeconds(0,0);const t=new Date(e);return t.setMinutes(0,0,0),t.setHours(t.getHours()+(e.getMinutes()>0?1:0)),t}().getTime()}function Zr(e){const t=(null!==e&&void 0!==e?e:"").toString().toUpperCase();return"DISPONIBLE"===t?"cell available":"PENDIENTE"===t||"ACTIVA"===t?"cell pending":"ACEPTADO"===t||"ACEPTADA"===t?"cell accepted":"CANCELADO"===t||"CANCELADA"===t?"cell canceled":"VENCIDA"===t||"EXPIRED"===t||"INCUMPLIDA"===t||"FINALIZADA"===t?"cell expired":"cell disabled"}const ea=e=>{let{weekStart:t,cells:n,mode:r,selectedKeys:a,onToggle:o,onSinglePick:s}=e;const c=(0,l.useMemo)(()=>Array.from({length:7},(e,n)=>function(e,t){const[n,r,a]=e.split("-").map(Number),o=new Date(Date.UTC(n,r-1,a));return o.setUTCDate(o.getUTCDate()+t),o.toISOString().slice(0,10)}(t,n)),[t]),u=(0,l.useMemo)(()=>{const e={ACEPTADO:5,ACEPTADA:5,PENDIENTE:4,ACTIVA:4,DISPONIBLE:3,CANCELADO:2,CANCELADA:2,INCUMPLIDA:1,FINALIZADA:1,VENCIDA:1,EXPIRED:1},t=t=>{var n;return null!==(n=e[(null!==t&&void 0!==t?t:"").toString().toUpperCase()])&&void 0!==n?n:0},r=new Map;for(const a of n||[]){const e=Gr(a.hour),n="".concat(a.date,"_").concat(e),o=i(i({},a),{},{hour:e}),s=r.get(n);(!s||t(o.status)>=t(s.status))&&r.set(n,o)}return r},[n]),d=(0,l.useRef)(!1),h=(0,l.useRef)(null),p=(0,l.useRef)(new Set),f=()=>{d.current=!1,h.current=null,p.current.clear()};l.useEffect(()=>{const e=()=>{d.current&&f()};return globalThis.addEventListener("mouseup",e),globalThis.addEventListener("touchend",e),()=>{globalThis.removeEventListener("mouseup",e),globalThis.removeEventListener("touchend",e)}},[]);const m=(e,t)=>{var n,i,l;const c="".concat(e,"_").concat(t),m=u.get(c)||{date:e,hour:t,status:null};let g=null!==(n=m.status)&&void 0!==n?n:null;const v=(null!==(i=g)&&void 0!==i?i:"").toString().toUpperCase();!Xr(e,t)||"DISPONIBLE"!==v&&"PENDIENTE"!==v&&"ACTIVA"!==v||(g="VENCIDA");const y=!(null===a||void 0===a||!a.has(c)),b="student"!==r||"DISPONIBLE"===(null!==(l=g)&&void 0!==l?l:"").toString().toUpperCase(),w=[Zr(g),y?"selected":"",b?"can-pick":"not-pickable"].join(" ").trim(),x=function(e){const t=(null!==e&&void 0!==e?e:"").toString().toUpperCase();return"DISPONIBLE"===t?"Disponible":"PENDIENTE"===t||"ACTIVA"===t?"Pendiente":"ACEPTADO"===t||"ACEPTADA"===t?"Aceptada":"CANCELADO"===t||"CANCELADA"===t?"Cancelada":"VENCIDA"===t||"EXPIRED"===t?"Vencida":"INCUMPLIDA"===t?"Incumplida":"FINALIZADA"===t?"Finalizada":""}(g);return(0,_r.jsxs)("button",{type:"button",className:w,onMouseDown:e=>{e.preventDefault(),((e,t)=>{if("tutor"!==r||!o)return;d.current=!0,p.current=new Set;const n=(null===a||void 0===a?void 0:a.has(e))||!1;h.current=n?"deselect":"select",p.current.add(e),o(e,t)})(c,m)},onMouseEnter:()=>((e,t)=>{if(!d.current||"tutor"!==r||!o)return;if(p.current.has(e))return;p.current.add(e);const n=(null===a||void 0===a?void 0:a.has(e))||!1;("select"===h.current&&!n||"deselect"===h.current&&n)&&o(e,t)})(c,m),onMouseUp:f,onClick:()=>((e,t)=>{var n;"student"===r&&"DISPONIBLE"===(null!==(n=t.status)&&void 0!==n?n:"").toString().toUpperCase()&&s&&s(t)})(0,m),title:"".concat(e," ").concat(t," ").concat(g||""),style:{cursor:"pointer",userSelect:"none"},children:[x&&(0,_r.jsx)("span",{children:x}),x&&(0,_r.jsx)("span",{className:"dot"})]},c)};return(0,_r.jsx)("fieldset",{className:"calendar-wrapper","aria-label":"Week calendar",children:(0,_r.jsxs)("div",{className:"calendar-grid",children:[(0,_r.jsxs)("div",{className:"col hour-col",children:[(0,_r.jsx)("div",{className:"head-cell",children:"Hora"}),Yr.map(e=>(0,_r.jsx)("div",{className:"hour-cell",children:e},e))]}),c.map((e,t)=>(0,_r.jsxs)("div",{className:"col",children:[(0,_r.jsxs)("div",{className:"head-cell",children:[["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"][t],(0,_r.jsx)("br",{}),e]}),Yr.map(t=>m(e,t))]},e))]})})};function ta(e,t){const[n,r,a]=e.split("-").map(Number),o=new Date(Date.UTC(n,r-1,a));return o.setUTCDate(o.getUTCDate()+t),o.toISOString().slice(0,10)}const na=e=>{const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)};function ra(){const e=new Date;e.setSeconds(0,0);const t=new Date(e);return t.setMinutes(0,0,0),t.setHours(t.getHours()+(e.getMinutes()>0?1:0)),t}function aa(e,t){const n=ra(),r=function(e,t){const[n,r]=t.split(":").map(Number),a=new Date(e+"T00:00:00");return a.setHours(n,r,0,0),a}(e,na(t));return r.getTime()>=n.getTime()}const oa=()=>{var e,t,n,r,a;const o=dr(),s=null!==(e=null===(t=o.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=o.user)||void 0===n?void 0:n.access_token,c=(null===(r=o.user)||void 0===r||null===(a=r.profile)||void 0===a?void 0:a.sub)||"",[u,d]=(0,l.useState)(()=>function(e){const[t,n,r]=e.split("-").map(Number),a=new Date(Date.UTC(t,n-1,r)),o=a.getUTCDay(),s=(0===o?-6:1)-o;return a.setUTCDate(a.getUTCDate()+s),a.toISOString().slice(0,10)}((new Date).toISOString().slice(0,10))),[h,p]=(0,l.useState)([]),[f,m]=(0,l.useState)(new Set),[g,v]=(0,l.useState)(!1),[y,b]=(0,l.useState)(null),[w,x]=(0,l.useState)("add"),S=(0,l.useCallback)(async()=>{if(c&&s){v(!0);try{const e=await Ir(c,u,s);p(e)}catch(yo){console.error(yo),b("\u274c "+(yo.message||"Error cargando disponibilidad"))}finally{v(!1)}}},[c,u,s]);(0,l.useEffect)(()=>{S()},[S]);const _=(0,l.useMemo)(()=>{const e=new Map;for(const t of h){const n="".concat(t.date,"_").concat(na(t.hour));e.set(n,t)}return e},[h]),k=()=>{m(new Set),b(null)},E=(0,l.useMemo)(()=>{const e=new Map;return f.forEach(t=>{const[n,r]=t.split("_");if(aa(n,r)){const t=e.get(n)||[];t.push(na(r)),e.set(n,t)}}),e.forEach(e=>e.sort((e,t)=>e.localeCompare(t))),e},[f]),N=(0,l.useMemo)(()=>h.map(e=>{var t;const n=na(e.hour),r=((e,t)=>!aa(e,t))(e.date,n),a=(null!==(t=e.status)&&void 0!==t?t:"").toUpperCase();return!r||"DISPONIBLE"!==a&&"PENDIENTE"!==a?e:i(i({},e),{},{status:"EXPIRED"})}),[h]),j=()=>{d(ta(u,-7)),m(new Set)},C=()=>{d(ta(u,7)),m(new Set)},T=(0,l.useMemo)(()=>ra().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),[u]);return(0,_r.jsxs)("div",{className:"page",style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,_r.jsx)("h1",{style:{marginBottom:"8px"},children:"Mi disponibilidad"}),(0,_r.jsxs)("p",{className:"instruction-text",children:["add"===w?"Haz clic y arrastra para seleccionar horas vac\xedas y agregarlas a tu disponibilidad.":"Haz clic y arrastra para seleccionar horas con disponibilidad existente y eliminarlas.",(0,_r.jsx)("br",{}),(0,_r.jsx)("strong",{children:"Regla:"})," Solo puedes seleccionar horas ",(0,_r.jsxs)("u",{children:["a partir de ",T]}),"."]}),y&&(()=>{let e="#FFF7ED";y.includes("\u2705")?e="#ECFDF5":y.includes("\u274c")&&(e="#FEF2F2");let t="#FED7AA";y.includes("\u2705")?t="#A7F3D0":y.includes("\u274c")&&(t="#FECACA");let n="#92400E";return y.includes("\u2705")?n="#065F46":y.includes("\u274c")&&(n="#991B1B"),(0,_r.jsx)("div",{style:{margin:"12px 0",padding:"12px 16px",background:e,border:"1px solid ".concat(t),borderRadius:"8px",color:n,fontWeight:500},children:y})})(),(0,_r.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"12px",padding:"8px",background:"#F9FAFB",borderRadius:"8px",border:"1px solid #E5E7EB"},children:[(0,_r.jsx)("span",{style:{fontWeight:600,marginRight:"8px",alignSelf:"center"},children:"Modo:"}),(0,_r.jsx)("button",{className:"btn-modern ".concat("add"===w?"btn-primary-modern":"btn-secondary-modern"),onClick:()=>{x("add"),k()},style:{fontSize:"13px",padding:"6px 12px"},children:"\u2795 Agregar disponibilidad"}),(0,_r.jsx)("button",{className:"btn-modern ".concat("delete"===w?"btn-primary-modern":"btn-secondary-modern"),onClick:()=>{x("delete"),k()},style:{fontSize:"13px",padding:"6px 12px"},children:"\ud83d\uddd1\ufe0f Eliminar disponibilidad"})]}),(0,_r.jsxs)("div",{className:"action-buttons",children:[(0,_r.jsx)("button",{className:"btn-modern btn-secondary-modern",onClick:k,disabled:0===f.size,children:"Limpiar selecci\xf3n"}),"add"===w?(0,_r.jsx)("button",{className:"btn-modern btn-primary-modern",onClick:async()=>{if(0===E.size)return void b("\u26a0\ufe0f Selecciona una o m\xe1s horas FUTURAS para agregar.");const e=[];for(const[n,r]of Array.from(E.entries())){const t=r.filter(e=>{const t="".concat(n,"_").concat(e),r=_.get(t);return aa(n,e)&&!("PENDIENTE"===(null===r||void 0===r?void 0:r.status)||"ACEPTADO"===(null===r||void 0===r?void 0:r.status))});t.length&&e.push([n,t])}if(0===e.length)return void b("\u26a0\ufe0f La selecci\xf3n no contiene horas v\xe1lidas para agregar.");const t=e.reduce((e,t)=>{let[,n]=t;return e+n.length},0);if(globalThis.confirm("\xbfAgregar disponibilidad en ".concat(e.length," d\xeda(s) con ").concat(t," hora(s) seleccionada(s)?"))){v(!0);try{let t=0,n=0;const r=[];for(const[a,o]of e)try{t+=(await Rr(a,o,s)).addedCount}catch(yo){n+=o.length,r.push("".concat(a,": ").concat(yo.message||"Error"))}b(0===n?"\u2705 ".concat(t," hora(s) de disponibilidad agregadas correctamente."):t>0?"\u26a0\ufe0f ".concat(t," agregadas, ").concat(n," fallaron.\n").concat(r.join("\n")):"\u274c No se pudo agregar disponibilidad.\n".concat(r.join("\n"))),m(new Set),await new Promise(e=>setTimeout(e,500)),await S()}catch(yo){b("\u274c "+(yo.message||"Error agregando disponibilidad"))}finally{v(!1)}}},disabled:g||0===f.size,children:g?"Agregando...":"\u2713 Confirmar agregar disponibilidad"}):(0,_r.jsx)("button",{className:"btn-modern",onClick:async()=>{if(0===f.size)return void b("\u26a0\ufe0f Selecciona una o m\xe1s horas DISPONIBLES futuras para eliminar.");const e=Array.from(f).map(e=>{const[t,n]=e.split("_");if(!aa(t,n))return null;const r=h.find(e=>e.date===t&&na(e.hour)===na(n));return r&&"DISPONIBLE"===r.status?r:null}).filter(Boolean);if(0===e.length)return void b("\u26a0\ufe0f No hay disponibilidad FUTURA para eliminar en la selecci\xf3n.");if(globalThis.confirm("\xbfEliminar ".concat(e.length," hora(s) de disponibilidad?"))){v(!0);try{const t=new Map;for(const n of e){const e=t.get(n.date)||[];e.push(na(n.hour)),t.set(n.date,e)}for(const[e,n]of Array.from(t.entries())){const t=h.filter(t=>t.date===e&&"DISPONIBLE"===t.status).map(e=>na(e.hour)).filter(e=>!n.includes(e));if(t.length>0){const n=await fetch("http://3.91.52.109:8090/api/availability/day/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({hours:t})});if(!n.ok)throw new Error(await n.text())}else await Dr(e,s)}b("\u2705 ".concat(e.length," hora(s) eliminada(s) correctamente.")),m(new Set),await new Promise(e=>setTimeout(e,500)),await S()}catch(yo){b("\u274c "+((null===yo||void 0===yo?void 0:yo.message)||"Error eliminando disponibilidad"))}finally{v(!1)}}},disabled:g||0===f.size,style:{background:"#EF4444",color:"white",border:"none"},children:g?"Eliminando...":"\ud83d\uddd1\ufe0f Confirmar eliminar disponibilidad"})]}),(0,_r.jsxs)("div",{className:"week-nav",style:{marginBottom:"16px"},children:[(0,_r.jsx)("button",{className:"btn-ghost",onClick:j,children:"\u25c0 Semana anterior"}),(0,_r.jsxs)("div",{className:"week-nav__title",children:["Semana ",u," \u2014 ",ta(u,6)]}),(0,_r.jsx)("button",{className:"btn-ghost",onClick:C,children:"Siguiente semana \u25b6"})]}),g&&(0,_r.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:"\u23f3 Cargando..."}),(0,_r.jsx)(ea,{weekStart:u,cells:N,mode:"tutor",selectedKeys:f,onToggle:e=>{const[t,n]=e.split("_");if(!aa(t,n))return void b("\u26a0\ufe0f No puedes seleccionar horas en el pasado. Solo a partir de ".concat(ra().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"."));const r=_.get(e);"add"!==w||"PENDIENTE"!==(null===r||void 0===r?void 0:r.status)&&"ACEPTADO"!==(null===r||void 0===r?void 0:r.status)?"delete"!==w||"DISPONIBLE"===(null===r||void 0===r?void 0:r.status)?m(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}):b("\u26a0\ufe0f Solo puedes eliminar disponibilidad existente (DISPONIBLE) en futuro."):b("\u26a0\ufe0f Esa hora ya est\xe1 reservada.")},onPrevWeek:j,onNextWeek:C}),(0,_r.jsxs)("div",{style:{marginTop:"20px",padding:"12px",background:"#F3F4F6",borderRadius:"8px",fontSize:"12px"},children:[(0,_r.jsx)("strong",{children:"Debug:"})," ",N.length," celdas cargadas para semana ",u]})]})},sa=pr.CHAT_BASE.replace(/\/$/,"");async function ia(e,t){const n="".concat(sa,"/api/chat/chat-id/with/").concat(encodeURIComponent(e)),r=await fetch(n,{headers:{Authorization:"Bearer ".concat(t)}});if(!r.ok)throw new Error("No se pudo calcular chatId");return(await r.json()).chatId}async function la(e,t){const n="".concat(sa,"/api/chat/history/").concat(encodeURIComponent(e)),r=await fetch(n,{headers:{Authorization:"Bearer ".concat(t)}});if(!r.ok)throw new Error("No se pudo cargar el historial del chat");return r.json()}async function ca(e,t){const[n,r]=[e,t].sort((e,t)=>e.localeCompare(t)),a="".concat(n,":").concat(r);try{const e=(new TextEncoder).encode(a);return function(e){const t=new Uint8Array(e);let n="";for(let r=0;r<t.length;r++){const e=t[r];n+=(e<16?"0":"")+e.toString(16)}return n}(await crypto.subtle.digest("SHA-256",e))}catch(o){return a}}const ua=pr.CHAT_BASE.replace(/^http/,"ws").replace(/\/$/,"");class da{constructor(){this.ws=null,this.onMessageCb=null,this.onStateCb=null,this.keepAliveTimer=null,this.outbox=[],this.lastUrl=null,this.wasEverOpen=!1,this.suppressClose=!1,this.cancelled=!1}connect(e,t,n){var r;this.onMessageCb=t,this.onStateCb=n;const a="".concat(ua,"/ws/chat?token=").concat(encodeURIComponent(e));if(!this.ws||this.ws.readyState!==WebSocket.OPEN&&this.ws.readyState!==WebSocket.CONNECTING||this.lastUrl!==a){if(this.ws&&this.ws.readyState===WebSocket.OPEN&&this.lastUrl!==a)try{this.ws.close(1e3,"switch transport")}catch(o){}this.ws=new WebSocket(a),this.lastUrl=a,this.wasEverOpen=!1,this.suppressClose=!1,this.cancelled=!1,null===(r=this.onStateCb)||void 0===r||r.call(this,"connecting"),this.ws.onopen=()=>{var e;if(this.wasEverOpen=!0,this.cancelled)try{var t;null===(t=this.ws)||void 0===t||t.close(1e3,"cancelled before open")}catch(r){}else{if(null===(e=this.onStateCb)||void 0===e||e.call(this,"open"),this.outbox.length){for(const e of this.outbox)try{var n;null===(n=this.ws)||void 0===n||n.send(e)}catch(a){}this.outbox=[]}this.keepAliveTimer=setInterval(()=>{try{var e;null===(e=this.ws)||void 0===e||e.send(JSON.stringify({type:"ping",ts:Date.now()}))}catch(t){}},25e3)}},this.ws.onerror=()=>{var e;this.cancelled||null===(e=this.onStateCb)||void 0===e||e.call(this,"error")},this.ws.onclose=()=>{var e;this.suppressClose||null===(e=this.onStateCb)||void 0===e||e.call(this,"closed"),this.keepAliveTimer&&(clearInterval(this.keepAliveTimer),this.keepAliveTimer=setInterval(()=>{try{var e;null===(e=this.ws)||void 0===e||e.send("ping")}catch(t){}},25e3)),this.ws=null,this.lastUrl=null,this.wasEverOpen=!1,this.suppressClose=!1},this.ws.onmessage=e=>{var t;return null===(t=this.onMessageCb)||void 0===t?void 0:t.call(this,e)}}}sendMessage(e,t){const n=JSON.stringify({toUserId:e,content:t});this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(n):(this.outbox.push(n),console.warn("WebSocket no listo, mensaje encolado."))}disconnect(){if(this.cancelled=!0,this.keepAliveTimer&&(clearInterval(this.keepAliveTimer),this.keepAliveTimer=null),this.ws){if(this.ws.readyState===WebSocket.CONNECTING){this.suppressClose=!0,this.ws.onmessage=null,this.ws.onerror=null;const e=this.ws;return e.onopen=()=>{try{e.close(1e3,"cancelled on open")}catch(t){}},this.ws=null,this.lastUrl=null,void(this.outbox=[])}try{this.suppressClose=!this.wasEverOpen,this.ws.readyState!==WebSocket.CLOSED&&this.ws.close(1e3,"client closing")}catch(e){}this.ws=null,this.lastUrl=null,this.outbox=[]}}isConnected(){return!!this.ws&&this.ws.readyState===WebSocket.OPEN}}function ha(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function pa(e){let t;if("string"===typeof e){const n=10===e.length?"T00:00:00":"";t=new Date(e+n)}else t=e;return t.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}function fa(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function ma(e){const t=new Date,n=new Date("".concat(e.date,"T").concat(fa(e.start))).getTime(),r=new Date("".concat(e.date,"T").concat(fa(e.end))).getTime(),a=t.getTime(),o=(e.status||"").toUpperCase();return"CANCELADO"===o?"CANCELADO":"FINALIZADA"===o?"FINALIZADA":"INCUMPLIDA"===o?"INCUMPLIDA":"PENDIENTE"===o?a>r?"VENCIDA":"PENDIENTE":"ACEPTADO"===o?a>=n&&a<=r?"ACTIVA":a>r?!1===e.attended?"INCUMPLIDA":"FINALIZADA":"ACEPTADO":o||"DESCONOCIDO"}const ga=(e,t)=>{var n,r,a,o,s,i,l,c,u,d,h,p,f,m,g;return{id:String(null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:va()),chatId:String(null!==(r=null===e||void 0===e?void 0:e.chatId)&&void 0!==r?r:t),fromUserId:String(null!==(a=null!==(o=null!==(s=null!==(i=null===e||void 0===e?void 0:e.fromUserId)&&void 0!==i?i:null===e||void 0===e?void 0:e.senderId)&&void 0!==s?s:null===e||void 0===e?void 0:e.from)&&void 0!==o?o:null===e||void 0===e?void 0:e.userId)&&void 0!==a?a:""),toUserId:String(null!==(l=null!==(c=null!==(u=null===e||void 0===e?void 0:e.toUserId)&&void 0!==u?u:null===e||void 0===e?void 0:e.recipientId)&&void 0!==c?c:null===e||void 0===e?void 0:e.to)&&void 0!==l?l:""),content:String(null!==(d=null!==(h=null===e||void 0===e?void 0:e.content)&&void 0!==h?h:null===e||void 0===e?void 0:e.text)&&void 0!==d?d:""),createdAt:String(null!==(p=null!==(f=null===e||void 0===e?void 0:e.createdAt)&&void 0!==f?f:null===e||void 0===e?void 0:e.timestamp)&&void 0!==p?p:(new Date).toISOString()),delivered:Boolean(null!==(m=null===e||void 0===e?void 0:e.delivered)&&void 0!==m&&m),read:Boolean(null!==(g=null===e||void 0===e?void 0:e.read)&&void 0!==g&&g)}};function va(){try{return crypto.getRandomValues(new Uint32Array(4)).join("-")}catch(e){return"".concat(Date.now(),"-").concat(Math.random())}}const ya=e=>{let{message:t,isMine:n}=e;const r=n?"chat-bubble mine":"chat-bubble theirs",a=function(e){if(e&&"object"===typeof e){var t,n;const r=e;return null!==(t=null!==(n=r.createdAt)&&void 0!==n?n:r.timestamp)&&void 0!==t?t:(new Date).toISOString()}return(new Date).toISOString()}(t);return(0,_r.jsxs)("div",{className:r,children:[(0,_r.jsx)("p",{children:t.content}),(0,_r.jsx)("span",{className:"timestamp",children:new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},ba=e=>{let{contact:t,myUserId:n,token:r,onClose:a}=e;const[o,s]=(0,l.useState)([]),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)(""),h=(0,l.useRef)(null),p=(0,l.useRef)(null),f=(0,l.useRef)(null),m=(0,l.useRef)(0),g=(0,l.useRef)(!1),v=e=>{const t=Date.now();if("connecting"===e&&"connecting"===f.current)return;"closed"===e&&"connecting"===f.current&&t-m.current<500||(console.log("Socket state: ".concat(e)),f.current=e,m.current=t,"closed"!==e&&"error"!==e||g.current||(g.current=!0,a()))};(0,l.useEffect)(()=>(p.current=new da,p.current.connect(r,e=>{const t=e&&"string"===typeof e.data?JSON.parse(e.data):e,n=ga(t,u||"unknown");u&&n.chatId!==u||s(e=>[...e,n])},v),()=>{var e;null===(e=p.current)||void 0===e||e.disconnect(),p.current=null}),[r]),(0,l.useEffect)(()=>{let e=!0;return(async()=>{let a="";try{a=await ia(t.id,r)}catch(o){a=await ca(n,t.id),console.warn("getChatIdWith fall\xf3. Usando chatId local (sha256):",a)}if(e){d(a);try{const t=await la(a,r);if(!e)return;s(t.map(e=>ga(e,a||"unknown")))}catch(yo){if(console.error("Error cargando historial:",yo),!e)return;s([])}}})(),()=>{e=!1}},[t.id,n,r]),(0,l.useEffect)(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[o]);return(0,_r.jsxs)("div",{className:"chat-side-panel",children:[(0,_r.jsxs)("div",{className:"chat-window-header",children:[(0,_r.jsx)("h4",{children:t.name}),(0,_r.jsx)("button",{onClick:a,className:"close-chat-btn",children:"\xd7"})]}),(0,_r.jsxs)("div",{className:"chat-messages",children:[o.map(e=>(0,_r.jsx)(ya,{message:e,isMine:e.fromUserId===n},e.id)),(0,_r.jsx)("div",{ref:h})]}),(0,_r.jsxs)("form",{className:"chat-input-form",onSubmit:e=>{var n;e.preventDefault(),i.trim()&&(null===(n=p.current)||void 0===n||n.sendMessage(t.id,i),c(""))},children:[(0,_r.jsx)("input",{value:i,onChange:e=>c(e.target.value),placeholder:"Escribe un mensaje..."}),(0,_r.jsx)("button",{type:"submit",children:"Enviar"})]})]})},wa=pr.USERS_BASE,xa=pr.USERS_PROFILE_PATH;const Sa=()=>{var e,t,n,r;const a=dr(),o=null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token,s=null===(r=a.user)||void 0===r?void 0:r.profile.sub,[c,u]=(0,l.useState)([]),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)(null),[m,g]=(0,l.useState)("all"),[v,y]=(0,l.useState)(""),[b,w]=(0,l.useState)(!1),[x,S]=(0,l.useState)({}),[_,k]=(0,l.useState)(1),[E,N]=(0,l.useState)(5),[j,C]=(0,l.useState)(null),T=(0,l.useRef)(new Set),P=e=>(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),A=(0,l.useCallback)(async()=>{if(o){h(!0);try{const e=new Date;e.setDate(e.getDate()-30);const t=new Date;t.setDate(t.getDate()+60);const n=ha(e),r=ha(t),a=await Pr(n,r,o);u(a.filter(e=>"CANCELADO"!==e.status))}catch(yo){f("\u274c "+(yo.message||"Error cargando clases"))}finally{h(!1)}}},[o]);(0,l.useEffect)(()=>{A()},[A]);const I=async(e,t)=>{if(o&&s)try{await async function(e,t,n){const r="".concat(Nr,"/api/reservations/").concat(e,"/accept"),a=t?JSON.stringify({studentId:t}):void 0;return Cr(await fetch(r,{method:"PATCH",headers:jr(n),body:a}))}(e,t,o);let n=1;try{const e=await gr.getTutorTokensRate(o),t=Number(null===e||void 0===e?void 0:e.tokensPerHour);!Number.isNaN(t)&&t>0&&(n=t)}catch(yo){console.warn("No se pudo obtener tokensPerHour, usando 1 por defecto. Detalle:",yo)}await Fr.transferTokens(t,s,n,e,o),f("\u2705 Clase aceptada y tokens transferidos");try{await Fr.getTutorBalance(o);window.dispatchEvent(new CustomEvent("tokens:refresh"))}catch(yo){console.warn("No se pudo refrescar balance tras aceptaci\xf3n:",yo)}await A()}catch(yo){f("\u274c "+(yo.message||"Error al aceptar"))}},R=e=>({PENDIENTE:"#F59E0B",ACEPTADO:"#10B981",ACTIVA:"#6366F1",FINALIZADA:"#0EA5E9",INCUMPLIDA:"#F97316",VENCIDA:"#9CA3AF"}[String(e||"").toUpperCase()]||"#6B7280"),D=(0,l.useMemo)(()=>c.map(e=>i(i({},e),{},{effectiveStatus:ma(e)})).filter(e=>{if("all"!==m&&e.effectiveStatus!==m)return!1;if(!b){return new Date("".concat(e.date,"T").concat(fa(e.end))).getTime()>=Date.now()}return!0}).sort((e,t)=>new Date("".concat(e.date,"T").concat(e.start)).getTime()-new Date("".concat(t.date,"T").concat(t.start)).getTime()),[c,m,b]);(0,l.useEffect)(()=>{if(!o)return;const e=Array.from(new Set(c.map(e=>e.studentId).filter(Boolean))).filter(e=>!x[e]&&!T.current.has(e));if(0!==e.length){for(const t of e)T.current.add(t);(async()=>{const t={},n=await Promise.allSettled(e.map(async e=>{const t=await async function(e,t,n,r){const a={Accept:"application/json"};r&&(a.Authorization="Bearer ".concat(r));const o=async r=>{const o="".concat(e).concat(t,"?").concat(r,"=").concat(encodeURIComponent(n)),s=await fetch(o,{headers:a});return s.ok?{ok:!0,raw:await s.json()}:{ok:!1,status:s.status}};let s=await o("id");if(s.ok||(s=await o("sub")),!s.ok)throw Object.assign(new Error("PROFILE_FETCH_FAILED"),{status:s.status});return s.raw}(wa,xa,e,o);return{id:e,prof:t}}));for(const e of n)if("fulfilled"===e.status){var r;const n=e.value.id,a=e.value.prof;t[n]={id:n,sub:null!==(r=null===a||void 0===a?void 0:a.sub)&&void 0!==r?r:n,name:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.fullName)||"Estudiante",email:(null===a||void 0===a?void 0:a.email)||"N/A",avatarUrl:null===a||void 0===a?void 0:a.avatarUrl}}else{var a;const n=(null===(a=e.reason)||void 0===a?void 0:a.id)||"unknown";t[n]={id:n,sub:n,name:"Estudiante",email:"N/A"}}Object.keys(t).length>0&&S(e=>i(i({},e),t))})()}},[c,x,o]);const O=(0,l.useMemo)(()=>{const e={};for(const t of D){const n=t.studentId,r=x[n],a=t.studentName||(null===r||void 0===r?void 0:r.name)||"Estudiante",o=t.studentAvatar||(null===r||void 0===r?void 0:r.avatarUrl);e[n]||(e[n]={studentId:n,studentName:a,studentAvatar:o,reservations:[]}),e[n].reservations.push(t)}return Object.values(e).sort((e,t)=>e.studentName.localeCompare(t.studentName,"es"))},[D,x]),L=(0,l.useMemo)(()=>{if(!v.trim())return O;const e=P(v);return O.filter(t=>P(t.studentName).includes(e))},[O,v]),U=Math.max(1,Math.ceil(L.length/E)),M=Math.min(_,U),z=L.slice((M-1)*E,M*E);return(0,l.useEffect)(()=>{k(1)},[m,v,E,b]),(0,_r.jsxs)("div",{className:"page-with-chat-container",children:[(0,_r.jsxs)("div",{className:"main-content ".concat(j?"chat-open":""),children:[(0,_r.jsx)("h1",{style:{marginBottom:8},children:"Solicitudes"}),p&&(0,_r.jsx)("output",{className:"status-message","aria-live":"polite",children:p}),(0,_r.jsx)("div",{className:"filters-card",children:(0,_r.jsxs)("div",{className:"filters-row",children:[(0,_r.jsxs)("div",{className:"search-input",children:[(0,_r.jsx)("input",{placeholder:"Buscar estudiante\u2026",value:v,onChange:e=>y(e.target.value)}),(0,_r.jsx)("span",{className:"search-icon",children:"\ud83d\udd0e"})]}),(0,_r.jsxs)("select",{className:"status-select",value:m,onChange:e=>g(e.target.value),children:[(0,_r.jsx)("option",{value:"all",children:"Todos"}),(0,_r.jsx)("option",{value:"PENDIENTE",children:"Pendiente"}),(0,_r.jsx)("option",{value:"ACEPTADO",children:"Aceptado"}),(0,_r.jsx)("option",{value:"ACTIVA",children:"Activa"}),(0,_r.jsx)("option",{value:"FINALIZADA",children:"Finalizada"}),(0,_r.jsx)("option",{value:"INCUMPLIDA",children:"Incumplida"}),(0,_r.jsx)("option",{value:"VENCIDA",children:"Vencida"})]}),(0,_r.jsxs)("label",{className:"past-toggle",children:[(0,_r.jsx)("input",{type:"checkbox",checked:b,onChange:e=>w(e.target.checked)}),(0,_r.jsx)("span",{children:"Mostrar pasadas"})]})]})}),d&&(0,_r.jsx)("p",{children:"Cargando\u2026"}),!d&&0===z.length&&(0,_r.jsx)("p",{children:"No hay solicitudes."}),z.map(e=>(0,_r.jsxs)("div",{className:"student-group-card",children:[(0,_r.jsxs)("div",{className:"student-group-header",children:[e.studentAvatar?(0,_r.jsx)("img",{src:e.studentAvatar,alt:e.studentName}):(0,_r.jsx)("div",{className:"avatar-neutral","aria-hidden":"true"}),(0,_r.jsx)("h3",{children:e.studentName})]}),(0,_r.jsx)("div",{className:"reservations-container",children:e.reservations.map(t=>{const n=t.effectiveStatus,r="PENDIENTE"===n,a=(new Date("".concat(t.date,"T").concat(fa(t.start))).getTime()-Date.now())/36e5,i=("PENDIENTE"===n||"ACEPTADO"===n)&&a>=12,l="ACEPTADO"===n||"INCUMPLIDA"===n;return(0,_r.jsxs)("div",{className:"reservation-row",children:[(0,_r.jsxs)("div",{className:"reservation-info",children:[(0,_r.jsxs)("p",{className:"reservation-datetime",children:["\ud83d\udcc5 ",pa(t.date)," \u2022 \ud83d\udd50 ",fa(t.start)," - ",fa(t.end)]}),(0,_r.jsxs)("p",{className:"reservation-id",children:["ID: ",String(t.id).slice(0,8),"..."]})]}),(0,_r.jsx)("div",{className:"reservation-meta",children:(0,_r.jsx)("span",{className:"status-badge",style:{backgroundColor:"".concat(R(n),"20"),color:R(n)},children:(c=n,(c||"").toUpperCase()||"\u2014")})}),(0,_r.jsxs)("div",{className:"reservation-actions",children:[(0,_r.jsx)("button",{className:"btn-action btn-accept",onClick:()=>I(t.id,e.studentId),disabled:!r,children:"\u2713 Aceptar"}),(0,_r.jsx)("button",{className:"btn-action btn-cancel",onClick:()=>(async(e,t)=>{if(o&&s)try{await Ar(e,o),await Fr.refundOnCancellation({fromUserId:t,toUserId:s,reservationId:e,cancelledBy:"TUTOR",reason:"Cancelaci\xf3n realizada por tutor"},o),f("\u2705 Clase cancelada");try{await Fr.getTutorBalance(o),window.dispatchEvent(new CustomEvent("tokens:refresh"))}catch(yo){console.warn("No se pudo refrescar balance tras cancelaci\xf3n:",yo)}await A()}catch(yo){const t=String((null===yo||void 0===yo?void 0:yo.message)||"");if(t.includes("409")||/Conflict/i.test(t)){const e="No se puede cancelar: solo PENDIENTE o ACEPTADO y con 12+ horas de antelaci\xf3n.";alert(e),f("\u274c "+e)}else f("\u274c "+(yo.message||"Error al cancelar"))}})(t.id,e.studentId),disabled:!i,title:i?"Cancelar esta reserva":"No se puede cancelar en este estado",children:"\u2717 Cancelar"}),(0,_r.jsx)("button",{className:"btn-action btn-contact",onClick:()=>((e,t,n)=>{var r;C({id:e,sub:e,name:t,email:(null===(r=x[e])||void 0===r?void 0:r.email)||"N/A",avatarUrl:n})})(e.studentId,e.studentName,e.studentAvatar),disabled:!l,title:l?"Contactar al estudiante":"Solo puedes contactar para clases aceptadas",children:"\ud83d\udcac Contactar"})]})]},t.id);var c})})]},e.studentId)),U>1&&(0,_r.jsxs)("div",{className:"pagination",children:[(0,_r.jsx)("button",{disabled:1===M,onClick:()=>k(e=>Math.max(1,e-1)),children:"\u2190"}),(0,_r.jsxs)("span",{children:[M,"/",U]}),(0,_r.jsx)("button",{disabled:M===U,onClick:()=>k(e=>Math.min(U,e+1)),children:"\u2192"}),(0,_r.jsxs)("select",{value:E,onChange:e=>N(Number(e.target.value)),children:[(0,_r.jsx)("option",{value:5,children:"5"}),(0,_r.jsx)("option",{value:10,children:"10"}),(0,_r.jsx)("option",{value:20,children:"20"})]})]})]}),j&&s&&o&&(0,_r.jsx)(ba,{contact:j,myUserId:s,token:o,onClose:()=>C(null)})]})};function _a(e){if(!e)return"";const t=e.trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function ka(e){if(!e)return"";return new Date(10===e.length?"".concat(e,"T00:00:00"):e).toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"})}const Ea=e=>{let{reservations:t}=e;const[n,r]=(0,l.useState)(1),a=Math.max(1,Math.ceil(t.length/5)),o=t.slice(5*(n-1),5*n),s=e=>{const t=e.toUpperCase();let n="#6b7280";return["FINALIZADA","ACEPTADO","ACTIVA"].includes(t)&&(n="#10b981"),"INCUMPLIDA"!==t&&"CANCELADO"!==t||(n="#ef4444"),"PENDIENTE"===t&&(n="#f59e0b"),(0,_r.jsx)("span",{className:"history-status-badge",style:{backgroundColor:"".concat(n,"20"),color:n},children:t})};return(0,_r.jsxs)("div",{className:"student-history-panel",children:[(0,_r.jsx)("h4",{children:"Historial de Clases"}),t.length>0?(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)("div",{className:"history-list",children:o.map(e=>(0,_r.jsxs)("div",{className:"history-item",children:[(0,_r.jsxs)("span",{className:"history-date",children:["\ud83d\udcc5 ",ka(e.date)," a las ",_a(e.start)]}),s(e.status)]},e.id))}),a>1&&(0,_r.jsxs)("div",{className:"pagination-controls",children:[(0,_r.jsx)("button",{onClick:()=>r(e=>Math.max(1,e-1)),disabled:1===n,children:"Anterior"}),(0,_r.jsxs)("span",{children:["P\xe1gina ",n," de ",a]}),(0,_r.jsx)("button",{onClick:()=>r(e=>Math.min(a,e+1)),disabled:n===a,children:"Siguiente"})]})]}):(0,_r.jsx)("p",{children:"No hay clases en el historial de este estudiante."})]})},Na=()=>{const{user:e,isLoading:t}=dr(),n=null===e||void 0===e?void 0:e.id_token,r=null===e||void 0===e?void 0:e.profile.sub,[a,o]=(0,l.useState)([]),[s,i]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),[d,h]=(0,l.useState)(null);(0,l.useEffect)(()=>{if(!n||!r)return;(async()=>{i(!0),u(null);try{const e="2020-01-01",t=new Date((new Date).setFullYear((new Date).getFullYear()+1)).toISOString().split("T")[0],r=(e=>{const t={};for(const n of e)t[n.studentId]||(t[n.studentId]=[]),t[n.studentId].push(n);return t})(await Pr(e,t,n)),a=Object.keys(r);if(0===a.length)return void o([]);const s=await(async(e,t)=>{const n=e.map(e=>fetch("".concat(pr.USERS_BASE).concat(pr.USERS_PROFILE_PATH,"?id=").concat(e),{headers:{Authorization:"Bearer ".concat(t)}}).then(t=>t.ok?t.json():Promise.reject(new Error("Failed to fetch profile for ".concat(e))))),r=await Promise.allSettled(n),a={};return r.forEach((t,n)=>{"fulfilled"===t.status&&(a[e[n]]=t.value)}),a})(a,n),i=((e,t)=>Object.keys(e).map(n=>{var r,a;const o=e[n].slice();o.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());const s=null===(r=o.find(e=>"FINALIZADA"===e.status))||void 0===r?void 0:r.date,i=!!s&&Date.now()-new Date(s).getTime()<2592e6;return{studentId:n,profile:t[n]||{name:"Estudiante Desconocido",email:"N/A"},reservations:o,sessionsCompleted:o.filter(e=>"FINALIZADA"===e.status).length,firstSessionDate:(null===(a=o[o.length-1])||void 0===a?void 0:a.date)||"N/A",status:i?"active":"inactive"}}))(r,s);i.sort((e,t)=>e.status===t.status?e.profile.name.localeCompare(t.profile.name):"active"===e.status?-1:1),o(i)}catch(e){u(e.message||"No se pudo cargar la informaci\xf3n de los estudiantes."),console.error(e)}finally{i(!1)}})()},[n,r]);return s||t?(0,_r.jsx)("div",{className:"full-center",children:"Cargando tus estudiantes..."}):c?(0,_r.jsx)("div",{className:"full-center error-message",children:c}):(0,_r.jsxs)("div",{className:"students-section",children:[(0,_r.jsx)("h1",{children:"Mis Estudiantes \ud83d\udc65"}),(0,_r.jsxs)("div",{className:"students-grid",children:[0===a.length&&!s&&(0,_r.jsx)("p",{children:"A\xfan no tienes estudiantes en tu historial."}),a.map(e=>(0,_r.jsxs)("div",{className:"student-card-container",children:[(0,_r.jsxs)("div",{className:"student-card",children:[(0,_r.jsxs)("div",{className:"student-header",children:[(0,_r.jsx)("div",{className:"student-avatar",style:{backgroundColor:e.profile.avatarUrl?"transparent":"#667eea"},children:e.profile.avatarUrl?(0,_r.jsx)("img",{src:e.profile.avatarUrl,alt:e.profile.name}):(0,_r.jsx)("span",{children:(e.profile.name||"E").charAt(0)})}),(0,_r.jsxs)("div",{className:"student-info",children:[(0,_r.jsx)("h3",{children:e.profile.name}),(0,_r.jsx)("p",{className:"student-email",children:e.profile.email}),(0,_r.jsx)("span",{className:"status-badge-student ".concat(e.status),children:"active"===e.status?"Activo":"Inactivo"})]})]}),(0,_r.jsxs)("div",{className:"student-details",children:[(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Nivel:"})," Pregrado"]}),(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Se uni\xf3:"})," ",ka(e.firstSessionDate)]}),(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Sesiones completadas:"})," ",e.sessionsCompleted]})]}),(0,_r.jsx)("div",{className:"student-actions",children:(0,_r.jsx)("button",{className:"btn-secondary",onClick:()=>{return t=e.studentId,void h(e=>e===t?null:t);var t},children:d===e.studentId?"Ocultar Historial":"Ver Historial"})})]}),d===e.studentId&&(0,_r.jsx)(Ea,{reservations:e.reservations})]},e.studentId))]})]})},ja=pr.CALL_BASE;async function Ca(e,t){const n=await fetch("".concat(ja,"/api/calls/session"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({reservationId:e})});if(!n.ok){const e=await n.text();throw new Error("Error ".concat(n.status,": ").concat(e||"No se pudo crear la sesi\xf3n"))}return n.json()}function Ta(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function Pa(e){let t;if("string"===typeof e){const n=10===e.length?"T00:00:00":"";t=new Date(e+n)}else t=e;return t.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}function Aa(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function Ia(e){const t=new Date,n=new Date("".concat(e.date,"T").concat(Aa(e.start))).getTime(),r=new Date("".concat(e.date,"T").concat(Aa(e.end))).getTime(),a=t.getTime(),o=(e.status||"").toUpperCase();return"CANCELADO"===o?"CANCELADO":"FINALIZADA"===o?"FINALIZADA":"INCUMPLIDA"===o?"INCUMPLIDA":"PENDIENTE"===o?a>r?"VENCIDA":"PENDIENTE":"ACEPTADO"===o?a>=n&&a<=r?"ACTIVA":a>r?!1===e.attended?"INCUMPLIDA":"FINALIZADA":"ACEPTADO":o||"DESCONOCIDO"}const Ra=(e,t)=>{var n,r,a,o,s,i,l,c,u,d,h,p,f,m,g;return{id:String(null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:Da()),chatId:String(null!==(r=null===e||void 0===e?void 0:e.chatId)&&void 0!==r?r:t),fromUserId:String(null!==(a=null!==(o=null!==(s=null!==(i=null===e||void 0===e?void 0:e.fromUserId)&&void 0!==i?i:null===e||void 0===e?void 0:e.senderId)&&void 0!==s?s:null===e||void 0===e?void 0:e.from)&&void 0!==o?o:null===e||void 0===e?void 0:e.userId)&&void 0!==a?a:""),toUserId:String(null!==(l=null!==(c=null!==(u=null===e||void 0===e?void 0:e.toUserId)&&void 0!==u?u:null===e||void 0===e?void 0:e.recipientId)&&void 0!==c?c:null===e||void 0===e?void 0:e.to)&&void 0!==l?l:""),content:String(null!==(d=null!==(h=null===e||void 0===e?void 0:e.content)&&void 0!==h?h:null===e||void 0===e?void 0:e.text)&&void 0!==d?d:""),createdAt:String(null!==(p=null!==(f=null===e||void 0===e?void 0:e.createdAt)&&void 0!==f?f:null===e||void 0===e?void 0:e.timestamp)&&void 0!==p?p:(new Date).toISOString()),delivered:Boolean(null!==(m=null===e||void 0===e?void 0:e.delivered)&&void 0!==m&&m),read:Boolean(null!==(g=null===e||void 0===e?void 0:e.read)&&void 0!==g&&g)}};function Da(){try{return crypto.getRandomValues(new Uint32Array(4)).join("-")}catch(e){return"".concat(Date.now(),"-").concat(Math.random())}}const Oa=e=>{let{message:t,isMine:n}=e;const r=n?"chat-bubble mine":"chat-bubble theirs",a=function(e){if(e&&"object"===typeof e){var t,n;const r=e;return null!==(t=null!==(n=r.createdAt)&&void 0!==n?n:r.timestamp)&&void 0!==t?t:(new Date).toISOString()}return(new Date).toISOString()}(t);return(0,_r.jsxs)("div",{className:r,children:[(0,_r.jsx)("p",{children:t.content}),(0,_r.jsx)("span",{className:"timestamp",children:new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},La=e=>{let{contact:t,myUserId:n,token:r,onClose:a}=e;const[o,s]=(0,l.useState)([]),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)(""),h=(0,l.useRef)(null),p=(0,l.useRef)(null),f=(0,l.useRef)(null),m=(0,l.useRef)(0),g=(0,l.useRef)(!1),v=e=>{const t=Date.now();if("connecting"===e&&"connecting"===f.current)return;"closed"===e&&"connecting"===f.current&&t-m.current<500||(f.current=e,m.current=t,"closed"!==e&&"error"!==e||g.current||(g.current=!0,a()))};(0,l.useEffect)(()=>(p.current=new da,p.current.connect(r,e=>{const t=e&&"string"===typeof e.data?JSON.parse(e.data):e,n=Ra(t,u||"unknown");u&&n.chatId!==u||s(e=>[...e,n])},v),()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.disconnect()}),[r]),(0,l.useEffect)(()=>{let e=!0;return(async()=>{let a="";try{a=await ia(t.id,r)}catch(o){a=await ca(n,t.id)}if(e){d(a);try{const t=await la(a,r);if(!e)return;s(t.map(e=>Ra(e,a||"unknown")))}catch(i){e&&s([])}}})(),()=>{e=!1}},[t.id,n,r]),(0,l.useEffect)(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[o]);return(0,_r.jsxs)("div",{className:"chat-side-panel",children:[(0,_r.jsxs)("div",{className:"chat-window-header",children:[(0,_r.jsx)("h4",{children:t.name}),(0,_r.jsx)("button",{onClick:a,className:"close-chat-btn",children:"\xd7"})]}),(0,_r.jsxs)("div",{className:"chat-messages",children:[o.map(e=>(0,_r.jsx)(Oa,{message:e,isMine:e.fromUserId===n},e.id)),(0,_r.jsx)("div",{ref:h})]}),(0,_r.jsxs)("form",{className:"chat-input-form",onSubmit:e=>{var n;e.preventDefault(),i.trim()&&(null===(n=p.current)||void 0===n||n.sendMessage(t.id,i),c(""))},children:[(0,_r.jsx)("input",{value:i,onChange:e=>c(e.target.value),placeholder:"Escribe un mensaje..."}),(0,_r.jsx)("button",{type:"submit",children:"Enviar"})]})]})},Ua=pr.USERS_BASE,Ma=pr.USERS_PROFILE_PATH;const za=()=>{var e,t,n,r;const a=dr(),o=me(),s=null!==(e=null===(t=a.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=a.user)||void 0===n?void 0:n.access_token,c=null===(r=a.user)||void 0===r?void 0:r.profile.sub,[u,d]=(0,l.useState)([]),[h,p]=(0,l.useState)(!1),[f,m]=(0,l.useState)(null),[g,v]=(0,l.useState)("all"),[y,b]=(0,l.useState)(""),[w,x]=(0,l.useState)(!1),[S,_]=(0,l.useState)({}),[k,E]=(0,l.useState)(1),[N,j]=(0,l.useState)(10),[C,T]=(0,l.useState)(null),P=(0,l.useRef)(new Set),A=e=>(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),I=(0,l.useCallback)(async()=>{if(s){p(!0);try{const e=new Date;e.setDate(e.getDate()-30);const t=new Date;t.setDate(t.getDate()+60);const n=Ta(e),r=Ta(t),a=await Pr(n,r,s);d(a.filter(e=>"CANCELADO"!==e.status))}catch(yo){m("\u274c "+(yo.message||"Error cargando clases"))}finally{p(!1)}}},[s]);(0,l.useEffect)(()=>{I()},[I]);const R=e=>({PENDIENTE:"#F59E0B",ACEPTADO:"#10B981",ACTIVA:"#6366F1",FINALIZADA:"#0EA5E9",INCUMPLIDA:"#F97316",VENCIDA:"#9CA3AF"}[String(e||"").toUpperCase()]||"#6B7280"),D=(0,l.useMemo)(()=>u.map(e=>i(i({},e),{},{effectiveStatus:Ia(e)})).filter(e=>{if("all"!==g&&e.effectiveStatus!==g)return!1;if(!w){return new Date("".concat(e.date,"T").concat(Aa(e.end))).getTime()>=Date.now()}return!0}).sort((e,t)=>new Date("".concat(e.date,"T").concat(e.start)).getTime()-new Date("".concat(t.date,"T").concat(t.start)).getTime()),[u,g,w]);(0,l.useEffect)(()=>{if(!s)return;const e=Array.from(new Set(u.map(e=>e.studentId).filter(Boolean))).filter(e=>!S[e]&&!P.current.has(e));if(0!==e.length){for(const t of e)P.current.add(t);(async()=>{const t={},n=await Promise.allSettled(e.map(async e=>{const t=await async function(e,t,n,r){const a={Accept:"application/json"};r&&(a.Authorization="Bearer ".concat(r));const o=async r=>{const o="".concat(e).concat(t,"?").concat(r,"=").concat(encodeURIComponent(n)),s=await fetch(o,{headers:a});return s.ok?{ok:!0,raw:await s.json()}:{ok:!1,status:s.status}};let s=await o("id");if(s.ok||(s=await o("sub")),!s.ok)throw Object.assign(new Error("PROFILE_FETCH_FAILED"),{status:s.status});return s.raw}(Ua,Ma,e,s);return{id:e,prof:t}}));for(const e of n)if("fulfilled"===e.status){var r;const n=e.value.id,a=e.value.prof;t[n]={id:n,sub:null!==(r=null===a||void 0===a?void 0:a.sub)&&void 0!==r?r:n,name:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.fullName)||"Estudiante",email:(null===a||void 0===a?void 0:a.email)||"N/A",avatarUrl:null===a||void 0===a?void 0:a.avatarUrl}}else{var a;const n=(null===(a=e.reason)||void 0===a?void 0:a.id)||"unknown";t[n]={id:n,sub:n,name:"Estudiante",email:"N/A"}}Object.keys(t).length>0&&_(e=>i(i({},e),t))})()}},[u,S,s]);const O=(0,l.useMemo)(()=>{const e={};for(const t of D){const n=t.studentId,r=S[n],a=t.studentName||(null===r||void 0===r?void 0:r.name)||"Estudiante",o=t.studentAvatar||(null===r||void 0===r?void 0:r.avatarUrl);e[n]||(e[n]={studentId:n,studentName:a,studentAvatar:o,reservations:[]}),e[n].reservations.push(t)}return Object.values(e).sort((e,t)=>e.studentName.localeCompare(t.studentName,"es"))},[D,S]),L=(0,l.useMemo)(()=>{if(!y.trim())return O;const e=A(y);return O.filter(t=>A(t.studentName).includes(e))},[O,y]),U=Math.max(1,Math.ceil(L.length/N)),M=Math.min(k,U),z=L.slice((M-1)*N,M*N);return(0,l.useEffect)(()=>{E(1)},[g,y,N,w]),(0,_r.jsxs)("div",{className:"page-with-chat-container",children:[(0,_r.jsxs)("div",{className:"main-content ".concat(C?"chat-open":""),children:[(0,_r.jsx)("h1",{style:{marginBottom:8},children:"Mis Clases \ud83c\udf93"}),(0,_r.jsx)("p",{style:{marginTop:-8,opacity:.7},children:"(Contenido de clases programadas y completadas)"}),f&&(0,_r.jsx)("output",{className:"status-message","aria-live":"polite",children:f}),(0,_r.jsx)("div",{className:"filters-card",children:(0,_r.jsxs)("div",{className:"filters-row",children:[(0,_r.jsxs)("div",{className:"search-input",children:[(0,_r.jsx)("input",{placeholder:"Buscar estudiante\u2026",value:y,onChange:e=>b(e.target.value)}),(0,_r.jsx)("span",{className:"search-icon",children:"\ud83d\udd0e"})]}),(0,_r.jsxs)("select",{className:"status-select",value:g,onChange:e=>v(e.target.value),children:[(0,_r.jsx)("option",{value:"all",children:"Todos"}),(0,_r.jsx)("option",{value:"PENDIENTE",children:"Pendiente"}),(0,_r.jsx)("option",{value:"ACEPTADO",children:"Aceptado"}),(0,_r.jsx)("option",{value:"ACTIVA",children:"Activa"}),(0,_r.jsx)("option",{value:"FINALIZADA",children:"Finalizada"}),(0,_r.jsx)("option",{value:"INCUMPLIDA",children:"Incumplida"}),(0,_r.jsx)("option",{value:"VENCIDA",children:"Vencida"})]}),(0,_r.jsxs)("label",{className:"past-toggle",children:[(0,_r.jsx)("input",{type:"checkbox",checked:w,onChange:e=>x(e.target.checked)}),(0,_r.jsx)("span",{children:"Mostrar pasadas"})]})]})}),h&&(0,_r.jsx)("p",{children:"Cargando\u2026"}),!h&&0===z.length&&(0,_r.jsx)("p",{children:"No hay clases para mostrar."}),z.map(e=>(0,_r.jsxs)("div",{className:"student-group-card",children:[(0,_r.jsxs)("div",{className:"student-group-header",children:[e.studentAvatar?(0,_r.jsx)("img",{src:e.studentAvatar,alt:e.studentName}):(0,_r.jsx)("div",{className:"avatar-neutral","aria-hidden":"true"}),(0,_r.jsx)("h3",{children:e.studentName})]}),(0,_r.jsx)("div",{className:"reservations-container",children:e.reservations.map(t=>{const n=t.effectiveStatus,r=["ACTIVA"].includes(n),a=["ACEPTADO","INCUMPLIDA","ACTIVA"].includes(n),i=r;return(0,_r.jsxs)("div",{className:"reservation-row",children:[(0,_r.jsxs)("div",{className:"reservation-info",children:[(0,_r.jsxs)("p",{className:"reservation-datetime",children:["\ud83d\udcc5 ",Pa(t.date)," \u2022 \ud83d\udd50 ",Aa(t.start)," - ",Aa(t.end)]}),(0,_r.jsxs)("p",{className:"reservation-id",children:["ID: ",String(t.id).slice(0,8),"..."]})]}),(0,_r.jsx)("div",{className:"reservation-meta",children:(0,_r.jsx)("span",{className:"status-badge",style:{backgroundColor:"".concat(R(n),"20"),color:R(n)},children:(l=n,(l||"").toUpperCase()||"\u2014")})}),(0,_r.jsxs)("div",{className:"reservation-actions",children:[(0,_r.jsx)("button",{className:"btn-action btn-join",onClick:()=>(async e=>{try{if(!s)return void m("\u274c Error: No hay sesi\xf3n activa (falta token).");const{sessionId:t}=await Ca(e.id,s);sessionStorage.setItem("call:reservation:"+t,String(e.id)),o("/call/".concat(t))}catch(yo){var t;m("\u274c No se pudo iniciar la reuni\xf3n: "+(null!==(t=null===yo||void 0===yo?void 0:yo.message)&&void 0!==t?t:"error"))}})(t),disabled:!i,title:i?"Iniciar/Reanudar tutor\xeda":"Disponible para ACEPTADO, INCUMPLIDA y ACTIVA",children:"\u25b6 Reunirse ahora"}),(0,_r.jsx)("button",{className:"btn-action btn-contact",onClick:()=>((e,t,n)=>{var r;T({id:e,sub:e,name:t,email:(null===(r=S[e])||void 0===r?void 0:r.email)||"N/A",avatarUrl:n})})(e.studentId,e.studentName,e.studentAvatar),disabled:!a,title:a?"Contactar":"Disponible para ACEPTADO, INCUMPLIDA y ACTIVA",children:"\u25cf Contactar"})]})]},t.id);var l})})]},e.studentId)),U>1&&(0,_r.jsxs)("div",{className:"pagination",children:[(0,_r.jsx)("button",{disabled:1===M,onClick:()=>E(e=>Math.max(1,e-1)),children:"\u2190"}),(0,_r.jsxs)("span",{children:[M,"/",U]}),(0,_r.jsx)("button",{disabled:M===U,onClick:()=>E(e=>Math.min(U,e+1)),children:"\u2192"}),(0,_r.jsxs)("select",{value:N,onChange:e=>j(Number(e.target.value)),children:[(0,_r.jsx)("option",{value:5,children:"5"}),(0,_r.jsx)("option",{value:10,children:"10"}),(0,_r.jsx)("option",{value:20,children:"20"})]})]})]}),C&&c&&s&&(0,_r.jsx)(La,{contact:C,myUserId:c,token:s,onClose:()=>T(null)})]})},Fa=()=>{const e=me(),t=dr(),{userRoles:n,isAuthenticated:r}=Sr(),{isProfileComplete:a,missingFields:o}=Er(),[s,i]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)("dashboard"),[m,g]=(0,l.useState)(0),[v]=(0,l.useState)([{id:"1",name:"Ana Garc\xeda",email:"ana@student.com",educationLevel:"Pregrado",joinDate:"2025-09-01",status:"active",sessionsCompleted:8},{id:"2",name:"Carlos Mendoza",email:"carlos@student.com",educationLevel:"Secundaria",joinDate:"2025-08-15",status:"active",sessionsCompleted:12},{id:"3",name:"Luc\xeda Torres",email:"lucia@student.com",educationLevel:"Pregrado",joinDate:"2025-09-10",status:"inactive",sessionsCompleted:3}]),[y,b]=(0,l.useState)([{id:"1",studentName:"Mar\xeda L\xf3pez",subject:"Matem\xe1ticas",description:"Necesito ayuda con c\xe1lculo integral",requestDate:"2025-09-25",status:"pending",priority:"high"},{id:"2",studentName:"Pedro Ruiz",subject:"Programaci\xf3n",description:"Ayuda con React y TypeScript",requestDate:"2025-09-24",status:"pending",priority:"medium"}]),[w,x]=(0,l.useState)([{id:"1",title:"Introducci\xf3n al C\xe1lculo",description:"Conceptos b\xe1sicos",subject:"Matem\xe1ticas",date:"2025-09-28",time:"14:00",duration:60,price:25e3,maxStudents:5,enrolledStudents:3,status:"scheduled"},{id:"2",title:"React Avanzado",description:"Hooks y optimizaci\xf3n",subject:"Programaci\xf3n",date:"2025-09-30",time:"16:00",duration:90,price:35e3,maxStudents:8,enrolledStudents:6,status:"scheduled"}]),[S,_]=(0,l.useState)({title:"",description:"",subject:"",date:"",time:"",duration:60,price:25e3,maxStudents:5});(0,l.useEffect)(()=>{if(r)if(!n||n.includes("tutor")){if(t.user){var a,o,s,i;u({userId:(null===(a=t.user.profile)||void 0===a?void 0:a.sub)||"unknown",name:(null===(o=t.user.profile)||void 0===o?void 0:o.name)||(null===(s=t.user.profile)||void 0===s?void 0:s.nickname)||"Tutor",email:(null===(i=t.user.profile)||void 0===i?void 0:i.email)||"No email",role:"tutor"});const e=async()=>{try{var e,n,r;const a=null!==(e=null===(n=t.user)||void 0===n?void 0:n.id_token)&&void 0!==e?e:null===(r=t.user)||void 0===r?void 0:r.access_token;if(!a)return;const o=await Fr.getTutorBalance(a);g(o.tokenBalance)}catch(yo){g(0)}};e();const n=setInterval(e,3e4),r=()=>{e()};return window.addEventListener("tokens:refresh",r),()=>clearInterval(n)}}else e("/");else e("/login")},[r,n,e,t.user]),(0,l.useEffect)(()=>()=>{window.removeEventListener("tokens:refresh",()=>{})},[]);return t.isLoading||!c?(0,_r.jsx)("div",{className:"full-center",children:"Cargando..."}):(0,_r.jsxs)("div",{className:"tutor-dashboard-container",children:[!a&&s&&o&&(0,_r.jsx)(Ur,{missingFields:o,currentRole:"tutor",onDismiss:()=>i(!1)}),(0,_r.jsx)("header",{className:"dashboard-header",children:(0,_r.jsxs)("div",{className:"header-content",children:[(0,_r.jsx)("div",{className:"logo",children:(0,_r.jsx)("h2",{children:"UpLearn Tutor"})}),(0,_r.jsxs)("nav",{className:"main-nav",children:[(0,_r.jsxs)("button",{className:"nav-item ".concat("dashboard"===p?"active":""),onClick:()=>f("dashboard"),children:[(0,_r.jsx)("span",{children:"\ud83d\udcca"})," Dashboard"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("my-students"===p?"active":""),onClick:()=>f("my-students"),children:[(0,_r.jsx)("span",{children:"\ud83d\udc65"})," Mis Estudiantes"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("sessions"===p?"active":""),onClick:()=>f("sessions"),children:[(0,_r.jsx)("span",{children:"\ud83d\udcec"})," Solicitudes"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("availability"===p?"active":""),onClick:()=>f("availability"),children:[(0,_r.jsx)("span",{children:"\ud83d\uddd3\ufe0f"})," Disponibilidad"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("requests"===p?"active":""),onClick:()=>f("requests"),children:[(0,_r.jsx)("span",{children:"\ud83c\udf93"})," Mis Clases"]}),(0,_r.jsxs)("button",{className:"nav-item ".concat("create-session"===p?"active":""),onClick:()=>f("create-session"),children:[(0,_r.jsx)("span",{children:"\u2795"})," Nueva Clase"]})]}),(0,_r.jsxs)("div",{className:"header-actions",style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,_r.jsxs)("div",{className:"token-display",children:[(0,_r.jsx)("img",{src:"/coin-icon.png",alt:"Moneda",className:"token-icon",style:{width:"24px",height:"24px",objectFit:"contain"}}),(0,_r.jsx)("span",{className:"token-amount",children:m}),(0,_r.jsx)("span",{className:"token-label",children:"tokens"})]}),(0,_r.jsxs)("div",{className:"user-menu-container",children:[(0,_r.jsxs)("button",{className:"user-avatar",onClick:()=>h(!d),children:[(0,_r.jsx)("span",{className:"avatar-icon",children:"\ud83d\udc68\u200d\ud83c\udfeb"}),(0,_r.jsx)("span",{className:"user-name",children:c.name}),(0,_r.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),d&&(0,_r.jsxs)("div",{className:"user-dropdown",children:[(0,_r.jsxs)("div",{className:"user-info",children:[(0,_r.jsx)("p",{className:"user-email",children:c.email}),(0,_r.jsx)("p",{className:"user-role",children:"Tutor Profesional"})]}),(0,_r.jsx)("div",{className:"dropdown-divider"}),(0,_r.jsxs)("button",{className:"dropdown-item",onClick:()=>{e("/edit-profile",{state:{currentRole:"tutor"}})},children:[(0,_r.jsx)("span",{children:"\u270f\ufe0f"})," Editar Perfil"]}),(0,_r.jsx)(Lr,{currentRole:"tutor",asMenuItem:!0}),(0,_r.jsx)(Or,{currentRole:"tutor",asMenuItem:!0}),(0,_r.jsxs)("button",{className:"dropdown-item logout",onClick:async()=>{t.removeUser();globalThis.location.href="".concat("https://us-east-18mvprkbvu.auth.us-east-1.amazoncognito.com","/logout?client_id=").concat("342s18a96gl2pbaroorqh316l8","&logout_uri=").concat(encodeURIComponent("http://localhost:3000"))},children:[(0,_r.jsx)("span",{children:"\ud83d\udeaa"})," Cerrar Sesi\xf3n"]})]})]})]})]})}),(0,_r.jsxs)("main",{className:"dashboard-main",children:["dashboard"===p&&(0,_r.jsxs)("div",{className:"dashboard-content",children:[(0,_r.jsxs)("h1",{children:["\xa1Bienvenido, ",c.name,"! \ud83d\udc68\u200d\ud83c\udfeb"]}),(0,_r.jsxs)("div",{className:"stats-grid",children:[(0,_r.jsxs)("div",{className:"stat-card",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83d\udc65"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:v.length}),(0,_r.jsx)("p",{children:"Estudiantes Totales"})]})]}),(0,_r.jsxs)("div",{className:"stat-card",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83d\udcec"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:y.filter(e=>"pending"===e.status).length}),(0,_r.jsx)("p",{children:"Solicitudes Pendientes"})]})]}),(0,_r.jsxs)("div",{className:"stat-card",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83c\udf93"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:w.filter(e=>"scheduled"===e.status).length}),(0,_r.jsx)("p",{children:"Clases Programadas"})]})]}),(0,_r.jsxs)("div",{className:"stat-card",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83d\udcb0"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:w.reduce((e,t)=>e+t.price*t.enrolledStudents,0).toLocaleString()}),(0,_r.jsx)("p",{children:"Ingresos Estimados"})]})]})]}),(0,_r.jsxs)("div",{className:"recent-activity",children:[(0,_r.jsx)("h2",{children:"Actividad Reciente"}),(0,_r.jsxs)("div",{className:"activity-list",children:[y[0]&&(0,_r.jsxs)("div",{className:"activity-item",children:[(0,_r.jsx)("span",{className:"activity-icon",children:"\ud83d\udcdd"}),(0,_r.jsxs)("div",{className:"activity-content",children:[(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Nueva solicitud:"})," ",y[0].studentName," - ",y[0].subject]}),(0,_r.jsx)("small",{children:"Hace 1 hora"})]})]}),(0,_r.jsxs)("div",{className:"activity-item",children:[(0,_r.jsx)("span",{className:"activity-icon",children:"\u2705"}),(0,_r.jsxs)("div",{className:"activity-content",children:[(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Sesi\xf3n completada:"})," Introducci\xf3n al C\xe1lculo"]}),(0,_r.jsx)("small",{children:"Ayer"})]})]}),v[2]&&(0,_r.jsxs)("div",{className:"activity-item",children:[(0,_r.jsx)("span",{className:"activity-icon",children:"\ud83d\udc64"}),(0,_r.jsxs)("div",{className:"activity-content",children:[(0,_r.jsxs)("p",{children:[(0,_r.jsx)("strong",{children:"Nuevo estudiante:"})," ",v[2].name," se uni\xf3"]}),(0,_r.jsx)("small",{children:"Hace 2 d\xedas"})]})]})]})]})]}),"my-students"===p&&(0,_r.jsx)(Na,{}),"sessions"===p&&(0,_r.jsx)(Sa,{}),"requests"===p&&(0,_r.jsx)(za,{}),"availability"===p&&(0,_r.jsx)(oa,{}),"create-session"===p&&(0,_r.jsx)("div",{className:"create-session-section",children:(0,_r.jsx)("h1",{children:"Crear Nueva Clase \u2795"})})]})]})},Ha=()=>{var e;const t=me(),n=he(),r=dr(),{userRoles:a,isAuthenticated:o}=Sr(),s=(null===(e=n.state)||void 0===e?void 0:e.currentRole)||(null===a||void 0===a?void 0:a[0]),[c,u]=(0,l.useState)(null),[d,h]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),[m,g]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!1),[b,w]=(0,l.useState)({}),[x,S]=(0,l.useState)(""),[_,k]=(0,l.useState)({name:"",email:"",phoneNumber:"",idType:"",idNumber:"",educationLevel:"",bio:"",specializations:[],credentials:[],tokensPerHour:""}),[E,N]=(0,l.useState)(""),[j,C]=(0,l.useState)([]),[T,P]=(0,l.useState)(!1),[A,I]=(0,l.useState)(""),R=(0,l.useRef)(null),[D,O]=(0,l.useState)([]),[L,U]=(0,l.useState)(null),M=e=>{try{const t=new URL(e).pathname.split("/").filter(Boolean).pop();if(!t)return"Archivo";const n=decodeURIComponent(t);return n.replace(/^[a-f0-9-]+_/i,"")||n}catch(t){const n=e.split("?")[0].split("#")[0].split("/").filter(Boolean).pop();if(!n)return"Archivo";const r=decodeURIComponent(n);return r.replace(/^[a-f0-9-]+_/i,"")||r}};(0,l.useEffect)(()=>{(async()=>{if(o)if(a&&0!==a.length){h(!0);try{var e,n,i;if(null===(e=r.user)||void 0===e||!e.id_token)throw new Error("No hay token disponible");if(null===a||void 0===a||!a.includes(s))throw console.error("\u274c Rol no v\xe1lido o no autorizado:",s),new Error("No tienes permisos para editar el perfil de ".concat(s));let t;if("student"===s)t=await gr.getStudentProfile(r.user.id_token);else{if("tutor"!==s)throw new Error("Rol de usuario no v\xe1lido");t=await gr.getTutorProfile(r.user.id_token)}const o={userId:(null===(n=r.user.profile)||void 0===n?void 0:n.sub)||"unknown",name:t.name||"",email:t.email||"",phoneNumber:t.phoneNumber||"",role:s.toUpperCase(),idType:t.idType||"",idNumber:t.idNumber||"",educationLevel:t.educationLevel||"",bio:t.bio||"",specializations:t.specializations||[],credentials:t.credentials||[],tokensPerHour:null!==(i=t.tokensPerHour)&&void 0!==i?i:null};u(o),k({name:t.name||"",email:t.email||"",phoneNumber:t.phoneNumber||"",idType:t.idType||"",idNumber:t.idNumber||"",educationLevel:t.educationLevel||"",bio:t.bio||"",specializations:t.specializations||[],credentials:t.credentials||[],tokensPerHour:null!=t.tokensPerHour?String(t.tokensPerHour):""}),O((t.credentials||[]).map(e=>M(e)))}catch(l){console.error("Error cargando perfil:",l),w({general:l instanceof Error?l.message:"Error cargando el perfil"}),l instanceof Error&&l.message.includes("401")&&t("/login")}finally{h(!1)}}else t("/login");else t("/login")})()},[t,r.isAuthenticated,r.user,a,s]);const z=e=>{const{name:t,value:n}=e.target;k(e=>i(i({},e),{},{[t]:n})),b[t]&&w(e=>i(i({},e),{},{[t]:""}))},F=()=>{const e=E.trim();if(e&&!_.specializations.some(t=>t.name===e)){const t={name:e,verified:!1,source:"MANUAL",verifiedAt:null,documentUrl:null};k(e=>i(i({},e),{},{specializations:[...e.specializations,t]})),N("")}},H=()=>{y(!1)};return d?(0,_r.jsx)("div",{className:"loading-container",children:(0,_r.jsxs)("div",{className:"loading-spinner",children:[(0,_r.jsx)("div",{className:"spinner-icon",children:"\u23f3"}),(0,_r.jsx)("p",{children:"Cargando datos del perfil..."})]})}):c||d?(0,_r.jsx)("div",{className:"edit-profile-container",children:(0,_r.jsxs)("div",{className:"edit-profile-content",children:[(0,_r.jsxs)("div",{className:"profile-header",children:[(0,_r.jsx)("h1",{children:"Editar Perfil"}),(0,_r.jsx)("p",{children:"Actualiza tu informaci\xf3n personal"}),(0,_r.jsx)("div",{className:"user-role-badge",children:"student"===s?"\ud83c\udf93 Estudiante":"\ud83d\udc68\u200d\ud83c\udfeb Tutor"})]}),(0,_r.jsxs)("form",{className:"profile-form",onSubmit:async e=>{var n;if(e.preventDefault(),(()=>{const e={};if(_.name.trim()||(e.name="El nombre es requerido"),_.email.trim()?/\S+@\S+\.\S+/.test(_.email)||(e.email="Email inv\xe1lido"):e.email="El email es requerido",_.phoneNumber.trim()||(e.phoneNumber="El tel\xe9fono es requerido"),"student"!==s||_.educationLevel.trim()||(e.educationLevel="El nivel educativo es requerido"),"tutor"===s&&(_.bio.trim()||(e.bio="La biograf\xeda es requerida"),0===_.specializations.length&&(e.specializations="Debe tener al menos una especializaci\xf3n"),""!==String(_.tokensPerHour).trim())){const t=parseInt(String(_.tokensPerHour),10);(isNaN(t)||t<=0)&&(e.tokensPerHour="Ingresa un n\xfamero v\xe1lido (>0)")}return w(e),0===Object.keys(e).length})())if(null!==(n=r.user)&&void 0!==n&&n.id_token){f(!0),w({}),S("");try{const e={name:_.name,email:_.email,phoneNumber:_.phoneNumber,idType:_.idType,idNumber:_.idNumber};if("student"===s)e.educationLevel=_.educationLevel;else if("tutor"===s)if(e.bio=_.bio,e.specializations=_.specializations,e.credentials=_.credentials,""!==String(_.tokensPerHour).trim()){const t=parseInt(String(_.tokensPerHour),10);!isNaN(t)&&t>0&&(e.tokensPerHour=t)}else e.tokensPerHour=null;let n;if("student"===s)n=await gr.updateStudentProfile(e,r.user.id_token);else{if("tutor"!==s)throw new Error("Rol de usuario no v\xe1lido para actualizaci\xf3n");n=await gr.updateTutorProfile(e,r.user.id_token)}S("\xa1Perfil actualizado exitosamente!"),setTimeout(()=>{t("student"===s?"/student-dashboard":"tutor"===s?"/tutor-dashboard":"/")},2e3)}catch(a){console.error("Error actualizando perfil:",a),w({general:a instanceof Error?a.message:"Error actualizando el perfil"})}finally{f(!1)}}else w({general:"No hay token de autenticaci\xf3n v\xe1lido"})},children:[b.general&&(0,_r.jsx)("div",{className:"alert alert-error",children:b.general}),x&&(0,_r.jsx)("div",{className:"alert alert-success",children:x}),(0,_r.jsxs)("div",{className:"form-section",children:[(0,_r.jsx)("h2",{children:"Informaci\xf3n Personal"}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Nombre Completo"}),(0,_r.jsx)("input",{type:"text",name:"name",className:"form-input ".concat(b.name?"error":""),placeholder:"Tu nombre completo",value:_.name,onChange:z,disabled:p}),b.name&&(0,_r.jsx)("span",{className:"error-message",children:b.name})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Email"}),(0,_r.jsx)("input",{type:"email",name:"email",className:"form-input ".concat(b.email?"error":""),placeholder:"tu@email.com",value:_.email,onChange:z,disabled:p}),b.email&&(0,_r.jsx)("span",{className:"error-message",children:b.email})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Tel\xe9fono"}),(0,_r.jsx)("input",{type:"tel",name:"phoneNumber",className:"form-input ".concat(b.phoneNumber?"error":""),placeholder:"N\xfamero de tel\xe9fono",value:_.phoneNumber,onChange:z,disabled:p}),b.phoneNumber&&(0,_r.jsx)("span",{className:"error-message",children:b.phoneNumber})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Tipo de Identificaci\xf3n"}),(0,_r.jsxs)("select",{name:"idType",className:"form-input ".concat(b.idType?"error":""),value:_.idType,onChange:z,disabled:p,children:[(0,_r.jsx)("option",{value:"",children:"Selecciona tipo de identificaci\xf3n"}),(0,_r.jsx)("option",{value:"CC",children:"C\xe9dula de Ciudadan\xeda"}),(0,_r.jsx)("option",{value:"CE",children:"C\xe9dula de Extranjer\xeda"}),(0,_r.jsx)("option",{value:"TI",children:"Tarjeta de Identidad"}),(0,_r.jsx)("option",{value:"PP",children:"Pasaporte"}),(0,_r.jsx)("option",{value:"RC",children:"Registro Civil"})]}),b.idType&&(0,_r.jsx)("span",{className:"error-message",children:b.idType})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"N\xfamero de Identificaci\xf3n"}),(0,_r.jsx)("input",{type:"text",name:"idNumber",className:"form-input ".concat(b.idNumber?"error":""),placeholder:"N\xfamero de identificaci\xf3n",value:_.idNumber,onChange:z,disabled:p}),b.idNumber&&(0,_r.jsx)("span",{className:"error-message",children:b.idNumber})]})]}),"student"===s&&(0,_r.jsxs)("div",{className:"form-section",children:[(0,_r.jsx)("h2",{children:"Informaci\xf3n Acad\xe9mica"}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Nivel Educativo"}),(0,_r.jsxs)("select",{name:"educationLevel",className:"form-input ".concat(b.educationLevel?"error":""),value:_.educationLevel,onChange:z,disabled:p,children:[(0,_r.jsx)("option",{value:"",children:"Selecciona tu nivel educativo"}),(0,_r.jsx)("option",{value:"PRIMARIA",children:"Primaria"}),(0,_r.jsx)("option",{value:"SECUNDARIA",children:"Secundaria"}),(0,_r.jsx)("option",{value:"PREGRADO",children:"Pregrado"}),(0,_r.jsx)("option",{value:"POSTGRADO",children:"Postgrado"}),(0,_r.jsx)("option",{value:"OTRO",children:"Otro"})]}),b.educationLevel&&(0,_r.jsx)("span",{className:"error-message",children:b.educationLevel})]})]}),"tutor"===s&&(0,_r.jsxs)("div",{className:"form-section",children:[(0,_r.jsx)("h2",{children:"Informaci\xf3n Profesional"}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Biograf\xeda"}),(0,_r.jsx)("textarea",{name:"bio",className:"form-input form-textarea ".concat(b.bio?"error":""),placeholder:"Cu\xe9ntanos sobre tu experiencia y enfoque como tutor...",rows:4,value:_.bio,onChange:z,disabled:p}),b.bio&&(0,_r.jsx)("span",{className:"error-message",children:b.bio})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Tokens por Hora"}),(0,_r.jsx)("input",{type:"number",name:"tokensPerHour",min:1,className:"form-input ".concat(b.tokensPerHour?"error":""),placeholder:"Ej: 50",value:_.tokensPerHour,onChange:z,disabled:p}),b.tokensPerHour&&(0,_r.jsx)("span",{className:"error-message",children:b.tokensPerHour}),(0,_r.jsx)("p",{className:"help-text",children:"Tarifa en tokens que cobrar\xe1s por cada hora de tutor\xeda. D\xe9jalo vac\xedo si a\xfan no decides."})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Especializaciones"}),(0,_r.jsxs)("div",{className:"array-input-container",children:[(0,_r.jsxs)("div",{className:"array-input-row",children:[(0,_r.jsx)("input",{type:"text",className:"form-input",placeholder:"Ej: Matem\xe1ticas, F\xedsica, Programaci\xf3n...",value:E,onChange:e=>N(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),F()),disabled:p}),(0,_r.jsx)("button",{type:"button",className:"add-button",onClick:F,disabled:p,children:"Agregar"})]}),(0,_r.jsx)("div",{className:"tags-container",children:_.specializations.map((e,t)=>(0,_r.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA el ".concat(new Date(e.verifiedAt||"").toLocaleDateString()):"Agregado manualmente",children:[e.verified&&(0,_r.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name,(0,_r.jsx)("button",{type:"button",onClick:()=>{return e=t,void(_.specializations[e].verified?alert("No puedes eliminar especializaciones verificadas. Elimina el documento asociado para quitarla."):k(t=>{const n=t.specializations.filter((t,n)=>n!==e);return i(i({},t),{},{specializations:n})}));var e},disabled:p||e.verified,className:e.verified?"disabled-remove":"",children:"\xd7"})]},t))}),b.specializations&&(0,_r.jsx)("span",{className:"error-message",children:b.specializations}),(0,_r.jsx)("p",{className:"help-text",children:"Las especializaciones con \u2713 fueron verificadas autom\xe1ticamente. Para eliminarlas, elimina el documento asociado."})]})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",children:"Credenciales (Archivos)"}),(0,_r.jsxs)("div",{className:"upload-credentials-container",children:[(0,_r.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,.doc,.docx",ref:R,onChange:e=>{I("");const t=e.target.files?Array.from(e.target.files):[];if(0!==t.length&&(C(e=>{const n=new Set(e.map(e=>"".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified))),r=t.filter(e=>!n.has("".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified)));return[...e,...r]}),e.target))try{e.target.value=""}catch(n){}},disabled:p||T}),j.length>0&&(0,_r.jsxs)("div",{className:"pending-files",children:[(0,_r.jsx)("p",{children:(0,_r.jsx)("strong",{children:"Archivos seleccionados:"})}),(0,_r.jsx)("ul",{children:j.map((e,t)=>(0,_r.jsxs)("li",{children:[e.name,(0,_r.jsx)("button",{type:"button",className:"remove-credential-btn",onClick:()=>C(e=>e.filter((e,n)=>n!==t)),disabled:T,children:"\xd7"})]},"".concat(e.name,"-").concat(e.size,"-").concat(e.lastModified)))}),(0,_r.jsx)("button",{type:"button",className:"add-button",onClick:async()=>{var e;if(null!==(e=r.user)&&void 0!==e&&e.id_token)if(0!==j.length){P(!0),I("");try{const e=await gr.uploadTutorCredentials(r.user.id_token,j),t=e.savedCredentials||[];k(e=>i(i({},e),{},{credentials:[...e.credentials||[],...t]}));const n=(e.details||[]).filter(e=>e.saved),a=n.map(e=>e.fileName||M(e.uploadedUrl));O(e=>[...e,...a]),C([]),R.current&&(R.current.value="");const o=n.filter(e=>e.addedSpecialization).map(e=>e.addedSpecialization);if(o.length>0){const e=o.join(", ");I("\u2713 Credenciales subidas exitosamente. Se a\xf1adieron especializaciones verificadas: ".concat(e));try{const e=await gr.getTutorProfile(r.user.id_token);k(t=>i(i({},t),{},{specializations:e.specializations||[]}))}catch(yo){console.error("Error recargando especializaciones:",yo)}}if(e.rejected&&e.rejected>0){const t=(e.details||[]).filter(e=>"rejected"===e.status).map(e=>"".concat(e.fileName,": ").concat(e.reason)).join(", ");I("".concat(e.validated," archivo(s) validado(s), ").concat(e.rejected," rechazado(s): ").concat(t))}}catch(t){I(t instanceof Error?t.message:"Error subiendo credenciales")}finally{P(!1)}}else I("Seleccione uno o m\xe1s archivos");else I("No hay token de autenticaci\xf3n v\xe1lido")},disabled:T,children:T?"Subiendo...":"Subir Credenciales"})]}),A&&(0,_r.jsx)("span",{className:"error-message",children:A}),(0,_r.jsxs)("div",{className:"uploaded-credentials",children:[(0,_r.jsx)("p",{children:(0,_r.jsx)("strong",{children:"Credenciales Subidas:"})}),0===_.credentials.length&&(0,_r.jsx)("p",{className:"muted",children:"No hay credenciales a\xfan."}),(0,_r.jsx)("ul",{className:"credentials-list",children:_.credentials.map((e,t)=>(0,_r.jsxs)("li",{children:[(0,_r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:D[t]||M(e)||"Credencial ".concat(t+1)}),(0,_r.jsx)("button",{type:"button",className:"remove-credential-btn",onClick:()=>(async e=>{var t;if(I(""),null===(t=r.user)||void 0===t||!t.id_token)return void I("No hay token de autenticaci\xf3n v\xe1lido");const n=_.credentials[e];if(n)try{U(e);const t=await gr.deleteTutorCredentials(r.user.id_token,[n]),a=(null===t||void 0===t?void 0:t.remainingCredentials)||[];if(k(e=>i(i({},e),{},{credentials:a})),O(a.map(e=>M(e))),t.removedSpecializations&&t.removedSpecializations.length>0){const e=t.removedSpecializations.join(", ");I("\u2713 Credencial eliminada. Las siguientes especializaciones verificadas tambi\xe9n fueron eliminadas: ".concat(e));try{const e=await gr.getTutorProfile(r.user.id_token);k(t=>i(i({},t),{},{specializations:e.specializations||[]}))}catch(yo){console.error("Error recargando especializaciones:",yo)}}"boolean"!==typeof(null===t||void 0===t?void 0:t.tutorVerified)||t.tutorVerified||I("Se eliminaron las credenciales. Tu cuenta qued\xf3 no verificada.")}catch(a){I(a instanceof Error?a.message:"Error eliminando credencial")}finally{U(null)}})(t),disabled:p||L===t,children:L===t?"\u2026":"\xd7"})]},t))})]}),b.credentials&&(0,_r.jsx)("span",{className:"error-message",children:b.credentials}),(0,_r.jsx)("p",{className:"help-text",children:"Sube diplomas, certificados o t\xedtulos en PDF o imagen."})]})]})]}),(0,_r.jsxs)("div",{className:"form-actions",children:[(0,_r.jsxs)("div",{className:"main-actions",children:[(0,_r.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p||m,children:p?"Guardando...":"Guardar Cambios"}),(0,_r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{t("student"===s?"/student-dashboard":"tutor"===s?"/tutor-dashboard":"/")},disabled:p||m,children:"Cancelar"})]}),(0,_r.jsxs)("div",{className:"danger-zone",children:[(0,_r.jsxs)("button",{type:"button",className:"btn btn-danger",onClick:()=>{y(!0)},disabled:p||m,children:["\ud83d\uddd1\ufe0f Eliminar ","student"===s?"Rol de Estudiante":"Rol de Tutor"]}),(0,_r.jsx)("p",{className:"danger-text",children:a&&a.length>1?"Se eliminar\xe1 tu rol de ".concat("student"===s?"estudiante":"tutor",". Si es tu \xfanico rol, se eliminar\xe1 toda la cuenta."):"Al ser tu \xfanico rol, esta acci\xf3n eliminar\xe1 completamente tu cuenta y no se puede deshacer."})]})]})]}),v&&(0,_r.jsx)("div",{className:"modal-overlay",onClick:H,children:(0,_r.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,_r.jsx)("div",{className:"modal-header",children:(0,_r.jsx)("h2",{children:"\u26a0\ufe0f Confirmar Eliminaci\xf3n de Rol"})}),(0,_r.jsxs)("div",{className:"modal-body",children:[(0,_r.jsx)("p",{children:(0,_r.jsxs)("strong",{children:["\xbfEst\xe1s seguro de que deseas eliminar tu rol de ","student"===s?"estudiante":"tutor","?"]})}),a&&a.length>1?(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsxs)("p",{children:["Se eliminar\xe1 \xfanicamente tu rol de ","student"===s?"estudiante":"tutor",", pero mantendr\xe1s acceso con tus otros roles."]}),(0,_r.jsx)("p",{children:"Se eliminar\xe1:"})]}):(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)("p",{children:"Al ser tu \xfanico rol, esta acci\xf3n eliminar\xe1 completamente tu cuenta."}),(0,_r.jsx)("p",{children:"Se eliminar\xe1 permanentemente:"})]}),(0,_r.jsxs)("ul",{children:[(0,_r.jsx)("li",{children:"\u2717 Tu perfil personal"}),(0,_r.jsx)("li",{children:"\u2717 Toda tu informaci\xf3n de contacto"}),"student"===s&&(0,_r.jsx)("li",{children:"\u2717 Tu historial acad\xe9mico y tareas"}),"tutor"===s&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)("li",{children:"\u2717 Tu biograf\xeda y especializaciones"}),(0,_r.jsx)("li",{children:"\u2717 Tus credenciales y certificaciones"})]}),(0,_r.jsx)("li",{children:"\u2717 Todo el historial de actividades"})]}),(0,_r.jsx)("p",{className:"warning-text",children:(0,_r.jsx)("strong",{children:"Esta acci\xf3n NO se puede deshacer."})})]}),(0,_r.jsxs)("div",{className:"modal-actions",children:[(0,_r.jsx)("button",{className:"btn btn-danger",onClick:async()=>{var e;if(null!==(e=r.user)&&void 0!==e&&e.id_token){g(!0),w({});try{let e;if("student"===s)e=await gr.removeStudentRole(r.user.id_token);else{if("tutor"!==s)throw new Error("Rol de usuario no v\xe1lido para eliminaci\xf3n");e=await gr.removeTutorRole(r.user.id_token)}if(e.userDeleted)alert("Tu cuenta ha sido eliminada completamente."),r.removeUser(),t("/");else{if(alert("Tu rol de ".concat("student"===s?"estudiante":"tutor"," ha sido eliminado. ").concat(e.message||"")),e.remainingRoles&&e.remainingRoles.length>0){const n=e.remainingRoles[0];t("student"===n?"/student-dashboard":"tutor"===n?"/tutor-dashboard":"/role-selection")}else t("/role-selection")}}catch(n){console.error("Error eliminando cuenta/rol:",n),w({general:n instanceof Error?n.message:"Error eliminando la cuenta"}),y(!1)}finally{g(!1)}}else w({general:"No hay token de autenticaci\xf3n v\xe1lido"})},disabled:m,children:m?"Eliminando...":"S\xed, Eliminar ".concat("student"===s?"Rol de Estudiante":"Rol de Tutor")}),(0,_r.jsx)("button",{className:"btn btn-secondary",onClick:H,disabled:m,children:"Cancelar"})]})]})})]})}):(0,_r.jsx)("div",{className:"loading-container",children:(0,_r.jsxs)("div",{className:"loading-spinner error",children:[(0,_r.jsx)("div",{className:"spinner-icon",children:"\u274c"}),(0,_r.jsx)("p",{children:"Error cargando el perfil"}),(0,_r.jsx)("button",{className:"btn btn-primary",onClick:()=>t("/login"),children:"Volver al Login"})]})})},Ba=()=>{const e=me(),t=dr(),[n,r]=(0,l.useState)([]),[a,o]=(0,l.useState)(!1),[s,i]=(0,l.useState)(""),c=e=>{r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return a?(0,_r.jsx)("div",{className:"role-selection-container",children:(0,_r.jsx)("div",{className:"role-selection-content",children:(0,_r.jsxs)("div",{className:"loading-state",children:[(0,_r.jsx)("h2",{children:"Guardando tu selecci\xf3n..."}),(0,_r.jsx)("div",{className:"loading-spinner"})]})})}):(0,_r.jsx)("div",{className:"role-selection-container",children:(0,_r.jsxs)("div",{className:"role-selection-content",children:[(0,_r.jsxs)("div",{className:"role-selection-header",children:[(0,_r.jsx)("h1",{children:"\xa1Bienvenido a UpLearn!"}),(0,_r.jsx)("p",{children:"Para continuar, selecciona tu(s) rol(es) en la plataforma:"}),(0,_r.jsx)("p",{className:"multiple-selection-note",children:"Puedes seleccionar ambos roles si planeas ser estudiante y tutor"})]}),s&&(0,_r.jsx)("div",{className:"error-message",children:s}),(0,_r.jsx)("div",{className:"roles-grid",children:[{value:"student",title:"Estudiante",description:"Busca tutores y reserva sesiones de aprendizaje",icon:"\ud83d\udcda"},{value:"tutor",title:"Tutor",description:"Ofrece tus conocimientos y ense\xf1a a otros estudiantes",icon:"\ud83d\udc68\u200d\ud83c\udfeb"}].map(e=>(0,_r.jsxs)("label",{className:"role-card ".concat(n.includes(e.value)?"selected":""),htmlFor:e.value,onTouchStart:()=>c(e.value),children:[(0,_r.jsx)("div",{className:"role-icon",children:e.icon}),(0,_r.jsx)("h3",{className:"role-title",children:e.title}),(0,_r.jsx)("p",{className:"role-description",children:e.description}),(0,_r.jsxs)("div",{className:"role-checkbox",children:[(0,_r.jsx)("input",{type:"checkbox",id:e.value,name:"roles",value:e.value,checked:n.includes(e.value),onChange:()=>c(e.value)}),(0,_r.jsx)("span",{children:"Seleccionar"})]})]},e.value))}),(0,_r.jsx)("div",{className:"selected-roles-summary",children:n.length>0&&(0,_r.jsxs)("div",{className:"selection-summary",children:[(0,_r.jsx)("h4",{children:"Roles seleccionados:"}),(0,_r.jsx)("div",{className:"selected-roles-list",children:n.map(e=>(0,_r.jsx)("span",{className:"selected-role-badge",children:"student"===e?"\ud83d\udcda Estudiante":"\ud83d\udc68\u200d\ud83c\udfeb Tutor"},e))})]})}),(0,_r.jsx)("div",{className:"form-actions",children:(0,_r.jsx)("button",{className:"btn btn-primary",onClick:async()=>{var r;if(0!==n.length)if(null!==(r=t.user)&&void 0!==r&&r.id_token){o(!0),i("");try{await gr.saveUserRole(t.user.id_token,n),xr();const r=n.includes("student")?"/student-dashboard":"/tutor-dashboard";e(r,{replace:!0})}catch(s){console.error("Error guardando roles:",s),i("Error al guardar los roles. Int\xe9ntalo de nuevo.")}finally{o(!1)}}else i("Error de autenticaci\xf3n. Por favor inicia sesi\xf3n nuevamente.");else i("Por favor selecciona al menos un rol")},disabled:0===n.length||a,children:"Continuar"})}),(0,_r.jsx)("div",{className:"role-selection-footer",children:(0,_r.jsx)("p",{className:"note",children:"Nota: Podr\xe1s cambiar tus roles m\xe1s tarde desde tu perfil si lo necesitas."})})]})})},Wa=()=>{var e,t,n,r,a,o,s,i,c;const{role:u}=ge(),d=he(),h=me(),p=dr(),f=d.state,m=(0,l.useMemo)(()=>{var e;return null!==(e=null===f||void 0===f?void 0:f.profile)&&void 0!==e?e:{}},[f]),g="student"===u||"tutor"===u?u:"tutor",v=null!==(e=null!==(t=m.name)&&void 0!==t?t:null===(n=p.user)||void 0===n||null===(r=n.profile)||void 0===r?void 0:r.name)&&void 0!==e?e:"Usuario",y=null!==(a=null!==(o=m.email)&&void 0!==o?o:null===(s=p.user)||void 0===s||null===(i=s.profile)||void 0===i?void 0:i.email)&&void 0!==a?a:"",b=(m.userId||m.sub||"").trim(),w="tutor"===g&&!!b;return(0,_r.jsx)("div",{className:"edit-profile-container",children:(0,_r.jsxs)("div",{className:"edit-profile-content",children:[(0,_r.jsxs)("div",{className:"profile-header",children:[(0,_r.jsx)("h1",{children:"Perfil"}),(0,_r.jsx)("p",{children:"Informaci\xf3n del usuario"}),(0,_r.jsx)("div",{className:"user-role-badge",children:"student"===g?"\ud83c\udf93 Estudiante":"\ud83d\udc68\u200d\ud83c\udfeb Tutor"})]}),(0,_r.jsxs)("div",{className:"profile-top-strip",style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,_r.jsx)("div",{"aria-hidden":!0,style:{width:56,height:56,borderRadius:"50%",background:"linear-gradient(135deg, #7C3AED 0%, #6366F1 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:800,fontSize:20},title:v,children:v.trim().charAt(0).toUpperCase()}),(0,_r.jsxs)("div",{children:[(0,_r.jsx)("div",{style:{fontWeight:700},children:v}),y&&(0,_r.jsx)("div",{style:{fontSize:12,color:"#6B7280"},children:y})]})]}),(0,_r.jsxs)("form",{className:"profile-form",onSubmit:e=>e.preventDefault(),children:[(0,_r.jsxs)("div",{className:"form-section",children:[(0,_r.jsx)("h2",{children:"Informaci\xf3n Personal"}),(0,_r.jsx)("div",{className:"form-grid-2",children:(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",htmlFor:"fullName",children:"Nombre Completo"}),(0,_r.jsx)("input",{id:"fullName",className:"form-input",value:v,disabled:!0,readOnly:!0})]})})]}),"student"===g&&(0,_r.jsxs)("div",{className:"form-section",children:[(0,_r.jsx)("h2",{children:"Informaci\xf3n Acad\xe9mica"}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",htmlFor:"educationLevel",children:"Nivel Educativo"}),(0,_r.jsx)("input",{id:"educationLevel",className:"form-input",value:null!==(c=m.educationLevel)&&void 0!==c?c:"\u2014",disabled:!0,readOnly:!0})]})]}),"tutor"===g&&(0,_r.jsxs)("div",{className:"form-section",children:[(0,_r.jsx)("h2",{children:"Informaci\xf3n Profesional"}),!!m.bio&&(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",htmlFor:"bio",children:"Biograf\xeda"}),(0,_r.jsx)("textarea",{id:"bio",className:"form-input form-textarea",value:m.bio,disabled:!0,readOnly:!0,rows:4})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{htmlFor:"specializations",className:"form-label",children:"Especializaciones"}),(0,_r.jsx)("div",{className:"tags-container",children:Array.isArray(m.specializations)&&m.specializations.length>0?(0,_r.jsxs)(_r.Fragment,{children:[m.specializations.map((e,t)=>(0,_r.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA - ".concat(e.source):"Agregado manualmente",children:[e.verified&&(0,_r.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name]},t)),(0,_r.jsx)("input",{id:"specializations",className:"form-input",value:m.specializations.map(e=>e.name).join(", "),readOnly:!0,"aria-hidden":"true",tabIndex:-1,style:{position:"absolute",left:"-10000px"}})]}):(0,_r.jsx)("input",{id:"specializations",className:"form-input",value:"\u2014",disabled:!0,readOnly:!0})})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{htmlFor:"credentials",className:"form-label",children:"Credenciales"}),(0,_r.jsx)("div",{className:"tags-container",children:Array.isArray(m.credentials)&&m.credentials.length>0?(0,_r.jsxs)(_r.Fragment,{children:[m.credentials.map(e=>(0,_r.jsx)("span",{className:"tag",children:e},e)),(0,_r.jsx)("input",{id:"credentials",className:"form-input",value:m.credentials.join(", "),readOnly:!0,"aria-hidden":"true",tabIndex:-1,style:{position:"absolute",left:"-10000px"}})]}):(0,_r.jsx)("input",{id:"credentials",className:"form-input",value:"\u2014",disabled:!0,readOnly:!0})})]}),(0,_r.jsxs)("div",{className:"form-group",children:[(0,_r.jsx)("label",{className:"form-label",htmlFor:"tokensPerHour",children:"Tarifa (Tokens por Hora)"}),(0,_r.jsx)("input",{id:"tokensPerHour",className:"form-input",value:"number"===typeof m.tokensPerHour&&m.tokensPerHour>0?"".concat(m.tokensPerHour," tokens/hora"):"\u2014",readOnly:!0,disabled:!0})]})]}),(0,_r.jsx)("div",{className:"form-actions",style:{justifyContent:"flex-end"},children:(0,_r.jsxs)("div",{className:"main-actions",style:{display:"flex",gap:8,flexWrap:"wrap"},children:[w&&(0,_r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>{b?h("/book/".concat(encodeURIComponent(b)),{state:{tutor:m,role:"tutor"}}):alert("No se pudo identificar al tutor para reservar.")},children:"Reservar Cita"}),(0,_r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>h(-1),children:"Volver"})]})})]})]})})};function Va(e){const[t,n,r]=e.split("-").map(Number);return new Date(t,(null!==n&&void 0!==n?n:1)-1,null!==r&&void 0!==r?r:1)}function qa(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function $a(e,t){const n=Va(e);return n.setDate(n.getDate()+t),qa(n)}const Ja=()=>{var e,t,n,r,a,o;const{tutorId:s}=ge(),i=he(),c=me(),u=dr(),d=i.state,h=null!==(e=null===d||void 0===d?void 0:d.tutor)&&void 0!==e?e:{},p=null!==(t=null===d||void 0===d?void 0:d.role)&&void 0!==t?t:"tutor",[f,m]=(0,l.useState)(),[g,v]=(0,l.useState)(()=>function(e){const t=Va(e),n=(t.getDay()+6)%7;return t.setDate(t.getDate()-n),qa(t)}(qa(new Date))),[y,b]=(0,l.useState)([]),[w,x]=(0,l.useState)(null),[S,_]=(0,l.useState)(!1),[k,E]=(0,l.useState)(0),[N,j]=(0,l.useState)(null),[C,T]=(0,l.useState)(null),[P,A]=(0,l.useState)(!1),[I,R]=(0,l.useState)(""),[D,O]=(0,l.useState)(new Date);(0,l.useEffect)(()=>{const e=setInterval(()=>O(new Date),6e4);return()=>clearInterval(e)},[]);const L=(0,l.useMemo)(()=>{var e,t,n,r,a,o,s,i;return{userId:(null===(e=u.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.sub)||"unknown",name:(null===(n=u.user)||void 0===n||null===(r=n.profile)||void 0===r?void 0:r.name)||(null===(a=u.user)||void 0===a||null===(o=a.profile)||void 0===o?void 0:o.nickname)||"Usuario",email:(null===(s=u.user)||void 0===s||null===(i=s.profile)||void 0===i?void 0:i.email)||"No email",role:"student"}},[u.user]);(0,l.useEffect)(()=>{if(u.isAuthenticated&&u.user){var e,t;const n=null===(e=u.user)||void 0===e?void 0:e.id_token,r=null===(t=u.user)||void 0===t?void 0:t.access_token;m(null!==n&&void 0!==n?n:r)}else m(void 0)},[u.isAuthenticated,u.user]),(0,l.useEffect)(()=>{if(!f)return;(async()=>{try{const e=await Fr.getStudentBalance(f);E(e.tokenBalance)}catch(yo){console.error("Error cargando balance:",yo)}})()},[f]),(0,l.useEffect)(()=>{const e=Number(null===h||void 0===h?void 0:h.tokensPerHour);if(!f||!e||e<=0)return T(null),void R("");let t=!1;return(async()=>{A(!0),R("");try{const n=await Fr.checkStudentTokens(e,f);t||T({hasEnoughTokens:!!n.hasEnoughTokens,requiredTokens:Number(n.requiredTokens),currentBalance:Number(n.currentBalance)})}catch(n){t||R((null===n||void 0===n?void 0:n.message)||"Error verificando tokens")}finally{t||A(!1)}})(),()=>{t=!0}},[f,h]);const U=(0,l.useMemo)(()=>(null===h||void 0===h?void 0:h.userId)||(null===h||void 0===h?void 0:h.sub)||s,[h,s]);(0,l.useEffect)(()=>{(async()=>{if(f&&U){_(!0),x(null),j(null);try{const e=await Ir(U,g,f);b(e)}catch(e){const t=await async function(e,t,n){return Ir(e,t,n)}(U,g,f);b(t)}finally{_(!1)}}})()},[f,U,g]);let M="";N&&(M="success"===N.type?"\u2705":"warning"===N.type?"\u26a0\ufe0f":"\u274c");return(0,_r.jsxs)("div",{className:"dashboard-container",children:[(0,_r.jsx)(Jr,{currentUser:L,onSectionChange:e=>{c("/student-dashboard?tab=".concat(e))},tokenBalance:k}),(0,_r.jsx)("main",{className:"dashboard-main",children:(0,_r.jsxs)("div",{style:{padding:16,maxWidth:1100,margin:"0 auto"},children:[N&&(0,_r.jsxs)("div",{style:(z=N.type,"success"===z?{margin:"12px 0",padding:"12px 16px",background:"#ECFDF5",border:"1px solid #A7F3D0",borderRadius:"8px",color:"#065F46",fontWeight:500,display:"flex",gap:8,alignItems:"center"}:"warning"===z?{margin:"12px 0",padding:"12px 16px",background:"#FFFBEB",border:"1px solid #FDE68A",borderRadius:"8px",color:"#92400E",fontWeight:500,display:"flex",gap:8,alignItems:"center"}:{margin:"12px 0",padding:"12px 16px",background:"#FEF2F2",border:"1px solid #FECACA",borderRadius:"8px",color:"#991B1B",fontWeight:500,display:"flex",gap:8,alignItems:"center"}),children:[(0,_r.jsx)("span",{"aria-hidden":!0,children:M}),(0,_r.jsx)("span",{children:N.text})]}),(0,_r.jsxs)("section",{className:"card compact-profile",children:[(0,_r.jsx)("div",{className:"compact-profile__left",children:(0,_r.jsx)("div",{className:"avatar-bubble",children:"\ud83d\udc68\u200d\ud83c\udfeb"})}),(0,_r.jsxs)("div",{className:"compact-profile__body",children:[(0,_r.jsx)("h2",{className:"compact-profile__name",children:null!==(n=h.name)&&void 0!==n?n:"Usuario"}),"student"===p?(0,_r.jsxs)("div",{className:"compact-profile__block",children:[(0,_r.jsx)("h4",{children:"Informaci\xf3n acad\xe9mica"}),(0,_r.jsxs)("div",{children:["\u2022 Nivel educativo: ",null!==(r=null===h||void 0===h?void 0:h.educationLevel)&&void 0!==r?r:"\u2014"]})]}):(0,_r.jsxs)(_r.Fragment,{children:[h.bio&&(0,_r.jsxs)("div",{className:"compact-profile__block",children:[(0,_r.jsx)("h4",{children:"Biograf\xeda"}),(0,_r.jsx)("p",{children:h.bio})]}),(0,_r.jsxs)("div",{className:"compact-profile__block",children:[(0,_r.jsx)("h4",{children:"Especializaciones"}),(0,_r.jsx)("div",{className:"tags-container",children:null!==(a=h.specializations)&&void 0!==a&&a.length?h.specializations.map((e,t)=>(0,_r.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA - ".concat(e.source):"Agregado manualmente",children:[e.verified&&(0,_r.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name]},t)):"\u2014"})]}),(0,_r.jsxs)("div",{className:"compact-profile__block",children:[(0,_r.jsx)("h4",{children:"Credenciales"}),(0,_r.jsx)("div",{className:"tags-container",children:null!==(o=h.credentials)&&void 0!==o&&o.length?h.credentials.map(e=>(0,_r.jsx)("span",{className:"tag",children:e},e)):"\u2014"})]}),(0,_r.jsxs)("div",{className:"compact-profile__block",children:[(0,_r.jsx)("h4",{children:"Tarifa"}),(0,_r.jsx)("p",{children:Number(null===h||void 0===h?void 0:h.tokensPerHour)>0?"".concat(h.tokensPerHour," tokens/hora"):"\u2014 (sin definir)"}),Number(null===h||void 0===h?void 0:h.tokensPerHour)>0&&(0,_r.jsxs)("div",{style:{fontSize:13},children:[P&&(0,_r.jsx)("p",{children:"Verificando saldo..."}),I&&(0,_r.jsx)("p",{style:{color:"#991B1B"},children:I}),C&&!P&&(0,_r.jsxs)("p",{children:["Saldo: ",(0,_r.jsx)("strong",{children:C.currentBalance})," tokens \u2014 ",C.hasEnoughTokens?"\u2705 suficiente":"\u274c insuficiente"]})]})]})]})]})]}),(0,_r.jsxs)("section",{className:"card action-strip",children:[(0,_r.jsx)("div",{className:"action-strip__left",children:w?(0,_r.jsxs)(_r.Fragment,{children:["Seleccionado: ",(0,_r.jsxs)("strong",{children:[w.date," ",w.hour]})]}):"Selecciona una hora disponible"}),(0,_r.jsxs)("div",{className:"action-strip__right",children:[(0,_r.jsx)("button",{className:"btn btn-secondary",onClick:()=>c(-1),children:"Volver"}),(0,_r.jsx)("button",{className:"btn btn-primary",onClick:async()=>{var e,t;if(!w||!f||!U)return;const n=null===(e=u.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.sub;if(n&&U&&n===U)return void j({type:"warning",text:"No te puedes reservar a ti mismo."});if(!globalThis.confirm("Confirmar reserva el ".concat(w.date," a las ").concat(w.hour,"?")))return;if(Number(null===h||void 0===h?void 0:h.tokensPerHour)>0&&C&&!C.hasEnoughTokens)j({type:"error",text:"No tienes suficientes tokens (saldo ".concat(C.currentBalance,", requiere ").concat(C.requiredTokens,"). Compra tokens antes de reservar.")});else try{await async function(e,t,n,r){const a="".concat(Nr,"/api/reservations");return Cr(await fetch(a,{method:"POST",headers:jr(r),body:JSON.stringify({tutorId:e,date:t,hour:n})}))}(U,w.date,w.hour,f),j({type:"success",text:"\xa1Reserva creada correctamente!"}),setTimeout(()=>c("/student-dashboard?tab=my-reservations",{replace:!0}),900)}catch(yo){const t=String((null===yo||void 0===yo?void 0:yo.message)||"").toLowerCase();t.includes("tutor no puede ser el mismo")||t.includes("no puede ser el mismo que el estudiante")?j({type:"warning",text:"No te puedes reservar a ti mismo."}):j({type:"error",text:(null===yo||void 0===yo?void 0:yo.message)||"Error creando la reserva."})}},disabled:!w||Number(null===h||void 0===h?void 0:h.tokensPerHour)>0&&!!C&&!C.hasEnoughTokens,children:"Confirmar Reserva"})]})]}),(0,_r.jsxs)("section",{className:"card week-nav week-nav--highlight",children:[(0,_r.jsx)("button",{className:"btn btn-ghost",onClick:()=>v($a(g,-7)),children:"\u25c0 Semana anterior"}),(0,_r.jsxs)("div",{className:"week-nav__title",children:["Semana ",g," \u2014 ",$a(g,6)]}),(0,_r.jsx)("button",{className:"btn btn-ghost",onClick:()=>v($a(g,7)),children:"Siguiente semana \u25b6"})]}),(0,_r.jsx)("section",{className:"calendar-container card",style:{padding:12},children:S?(0,_r.jsx)("div",{style:{padding:20},children:"Cargando disponibilidad..."}):(0,_r.jsxs)("div",{className:"calendar-grid",children:[(0,_r.jsxs)("div",{className:"col hour-col",children:[(0,_r.jsx)("div",{className:"head-cell",children:"Hora"}),Array.from({length:24},(e,t)=>String(t).padStart(2,"0")+":00").map(e=>(0,_r.jsx)("div",{className:"hour-cell",children:e},e))]}),Array.from({length:7},(e,t)=>t).map(e=>{const t=$a(g,e);return(0,_r.jsxs)("div",{className:"col",children:[(0,_r.jsxs)("div",{className:"head-cell",children:[["Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b","Dom"][e],(0,_r.jsx)("br",{}),t.slice(5)]}),Array.from({length:24},(e,t)=>String(t).padStart(2,"0")+":00").map(e=>{var n;const r=y.find(n=>n.date===t&&n.hour===e),a=(null!==(n=null===r||void 0===r?void 0:r.status)&&void 0!==n?n:"").toUpperCase(),o=new Date("".concat(t,"T").concat(e))<D,s=!o&&("DISPONIBLE"===a||"AVAILABLE"===a),i=(null===w||void 0===w?void 0:w.date)===t&&(null===w||void 0===w?void 0:w.hour)===e,l="".concat(t,"_").concat(e);let c="disabled";!o&&a&&(c=s?"available":"taken");let u="No disponible ".concat(e," ").concat(t);return s?u="Disponible ".concat(e," ").concat(t):a&&(u="Ocupado ".concat(e," ").concat(t)),(0,_r.jsx)("button",{type:"button",className:"cell "+c+(s?" can-pick":"")+(i?" selected":""),onClick:s?()=>{x({date:t,hour:e,status:"DISPONIBLE",reservationId:null,studentId:null}),j(null)}:void 0,disabled:!s,"aria-pressed":i,"aria-label":u,children:s&&(0,_r.jsx)("span",{className:"cell-label",children:"Disponible"})},l)})]},t)})]})})]})})]});var z};function Ka(e){let{onOpen:t}=e;return(0,_r.jsx)("button",{className:"px-3 py-2 rounded-md border text-white bg-indigo-600 hover:bg-indigo-700 transition",onClick:()=>{globalThis.dispatchEvent(new CustomEvent("open-chat-drawer")),null===t||void 0===t||t()},children:"Chat"})}function Qa(e){let{onToggleMic:t,onToggleCam:n,onShareScreen:r,onEnd:a}=e;const[o,s]=(0,l.useState)(!0),[i,c]=(0,l.useState)(!0),[u,d]=(0,l.useState)(!1);return(0,_r.jsxs)("div",{className:"call-controls-group",children:[(0,_r.jsx)("button",{onClick:()=>{s(!o),t()},className:"call-btn ".concat(o?"":"off"),title:o?"Apagar micr\xf3fono":"Encender micr\xf3fono",children:o?(0,_r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_r.jsx)("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),(0,_r.jsx)("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),(0,_r.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),(0,_r.jsx)("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}):(0,_r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_r.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),(0,_r.jsx)("path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"}),(0,_r.jsx)("path",{d:"M19 10v2a7 7 0 0 1-2.9 5.69M5 10v2a7 7 0 0 0 11.08 5.76"}),(0,_r.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),(0,_r.jsx)("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})}),(0,_r.jsx)("button",{onClick:()=>{c(!i),n()},className:"call-btn ".concat(i?"":"off"),title:i?"Apagar c\xe1mara":"Encender c\xe1mara",children:i?(0,_r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_r.jsx)("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),(0,_r.jsx)("circle",{cx:"12",cy:"13",r:"4"})]}):(0,_r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_r.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),(0,_r.jsx)("path",{d:"M21 21H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3m3-3h6l2 3h4a2 2 0 0 1 2 2v9.34m-7.72-2.06a4 4 0 1 1-5.56-5.56"})]})}),(0,_r.jsx)("button",{onClick:()=>{d(!u),r()},className:"call-btn ".concat(u?"active-share":""),title:"Compartir pantalla",children:(0,_r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_r.jsx)("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),(0,_r.jsx)("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),(0,_r.jsx)("line",{x1:"12",y1:"17",x2:"12",y2:"21"}),(0,_r.jsx)("path",{d:"m16 8-4-4-4 4"})]})}),(0,_r.jsx)("div",{style:{width:1,background:"rgba(255,255,255,0.2)",margin:"0 4px",height:"32px"}}),(0,_r.jsx)("button",{onClick:a,className:"call-btn danger",title:"Finalizar llamada",children:(0,_r.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,_r.jsx)("path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"}),(0,_r.jsx)("line",{x1:"23",y1:"1",x2:"1",y2:"23"})]})})]})}function Ga(e){return null!==e&&void 0!==e?e:""}function Ya(){const{sessionId:e}=ge(),t=he(),n=me(),r=(0,l.useMemo)(()=>new URLSearchParams(t.search),[t.search]),a=dr(),o=(0,l.useMemo)(()=>{var e,t;return(null===(e=a.user)||void 0===e?void 0:e.id_token)||(null===(t=a.user)||void 0===t?void 0:t.access_token)||""},[a.user]),s=(0,l.useMemo)(()=>{var e,t,n,r,o,s;return(null===(e=a.user)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.sub)||(null===(n=a.user)||void 0===n||null===(r=n.profile)||void 0===r?void 0:r.userId)||(null===(o=a.user)||void 0===o||null===(s=o.profile)||void 0===s?void 0:s.preferred_username)||""},[a.user]),[c,u]=(0,l.useState)("idle"),[d,h]=(0,l.useState)(e),[p,f]=(0,l.useState)(r.get("reservationId")||void 0),m=(0,l.useRef)(d),g=(0,l.useRef)(p);(0,l.useEffect)(()=>{m.current=d},[d]),(0,l.useEffect)(()=>{g.current=p},[p]);const v=(0,l.useRef)(null),y=(0,l.useRef)(null),b=(0,l.useRef)(null),w=(0,l.useRef)(null),x=(0,l.useRef)(null),S=(0,l.useRef)(null),_=(0,l.useRef)(null),k=(0,l.useRef)(null),E=(0,l.useRef)(null),N=(0,l.useRef)(!1),j=(0,l.useRef)(!1),C=(0,l.useRef)(!1),T=(0,l.useRef)(!1),P=(0,l.useRef)(!1),A=(0,l.useRef)(!1),I=(0,l.useRef)(!1),R=(0,l.useRef)(!1),D=(0,l.useRef)(!1),O=(0,l.useRef)(null),L=(0,l.useRef)([]),U=(0,l.useRef)(!1),M=(0,l.useRef)(0),z=(0,l.useRef)(!1),[F,H]=(0,l.useState)({signaling:"new",ice:"new",gathering:"new",localTracks:{audio:0,video:0},remoteTracks:{audio:0,video:0},mediaError:""}),B=(0,l.useCallback)((e,t)=>{console.log("[CALL]",e,null!==t&&void 0!==t?t:"")},[]),W=(0,l.useCallback)(()=>{var e;B("cleanup()"),z.current=!0,O.current&&(window.clearInterval(O.current),O.current=null),null===(e=x.current)||void 0===e||e.close(),x.current=null,N.current=!1,j.current=!1,C.current=!1,T.current=!1,P.current=!1,A.current=!1,I.current=!1,R.current=!1,D.current=!1,L.current=[],M.current=0,w.current&&(w.current.getSenders().forEach(e=>{e.track&&e.track.stop()}),w.current.close(),w.current=null),S.current&&(S.current.getTracks().forEach(e=>e.stop()),S.current=null),_.current&&(_.current.getTracks().forEach(e=>e.stop()),_.current=null),u("closed")},[B]),V=(0,l.useCallback)(e=>{const t=x.current;if(!t||t.readyState!==WebSocket.OPEN||!m.current)return;const n=i({type:e.type,sessionId:m.current,reservationId:g.current,from:s,ts:Date.now()},e);try{t.send(JSON.stringify(n)),"HEARTBEAT"!==n.type&&B("WS SEND",{type:n.type,sessionId:n.sessionId})}catch(yo){console.warn("[CALL] WS send failed",yo)}},[B,s]),q=(0,l.useCallback)(()=>{D.current||(D.current=!0,V({type:"RTC_CONNECTED"}))},[V]),$=(0,l.useCallback)(async()=>{const e=w.current;if(e&&C.current&&N.current&&j.current&&I.current&&R.current&&"stable"===e.signalingState&&!P.current)try{P.current=!0,B("maybeNegotiate: createOffer()",{signaling:e.signalingState});const t=await e.createOffer();t.sdp=Ga(t.sdp),await e.setLocalDescription(t),V({type:"OFFER",payload:e.localDescription}),B("OFFER sent")}catch(yo){console.error("[CALL] Error creating offer",yo)}finally{P.current=!1}},[B,V]),J=(0,l.useCallback)(async()=>{const e=function(e){const t=[],n=(e,n)=>{const r=(e||"").trim();if(!(e=>/^(stun:|turns?:)/i.test(e)&&!e.trim().startsWith("#")&&!e.trim().startsWith("//"))(r))return;const a={urls:r};null!==n&&void 0!==n&&n.username&&(a.username=n.username),null!==n&&void 0!==n&&n.credential&&(a.credential=n.credential),t.push(a)};if(Array.isArray(e))e.forEach(e=>{if("string"===typeof e)n(e);else if(e&&"object"===typeof e){var t;const r=null!==(t=e.urls)&&void 0!==t?t:e.url;Array.isArray(r)?r.forEach(t=>n(t,e)):"string"===typeof r&&n(r,e)}});else if(e&&"object"===typeof e){var r;const t=null!==(r=e.urls)&&void 0!==r?r:e.url;Array.isArray(t)?t.forEach(t=>n(t,e)):"string"===typeof t&&n(t,e)}return t.length||t.push({urls:"stun:stun.l.google.com:19302"}),t}(await async function(){const e=await fetch("".concat(ja,"/api/calls/ice-servers"));if(!e.ok)return[{urls:"stun:stun.l.google.com:19302"}];const t=await e.text();try{const e=JSON.parse(t);return Array.isArray(e)?e:[{urls:"stun:stun.l.google.com:19302"}]}catch(n){return[{urls:"stun:stun.l.google.com:19302"}]}}().catch(()=>[]));B("ICE servers",e);const t=new RTCPeerConnection({iceServers:e,bundlePolicy:"max-bundle",iceCandidatePoolSize:2});return w.current=t,k.current=t.addTransceiver("audio",{direction:"sendrecv"}),E.current=t.addTransceiver("video",{direction:"sendrecv"}),_.current=new MediaStream,t.ontrack=e=>{const t=_.current;t.getTracks().some(t=>t.id===e.track.id)||t.addTrack(e.track),B("ontrack",{kind:e.track.kind,id:e.track.id,currentTracks:{audio:t.getAudioTracks().length,video:t.getVideoTracks().length}}),y.current&&"video"===e.track.kind&&(y.current.srcObject=t,y.current.muted=!0,y.current.volume=0,y.current.play().catch(e=>console.warn("[CALL] remote video play error",e))),b.current&&"audio"===e.track.kind&&(b.current.srcObject=t,b.current.volume=1,b.current.play().catch(e=>console.warn("[CALL] remote audio play error",e))),H(e=>i(i({},e),{},{remoteTracks:{audio:t.getAudioTracks().length,video:t.getVideoTracks().length}}))},t.onicecandidate=e=>{N.current&&j.current&&e.candidate&&V({type:"ICE_CANDIDATE",payload:e.candidate})},t.oniceconnectionstatechange=()=>{const e=t.iceConnectionState;B("iceConnectionState",e),H(t=>i(i({},t),{},{ice:e})),"connected"===e||"completed"===e?(u("connected"),q()):"disconnected"===e?u("connecting"):"failed"===e&&u("failed")},t.onsignalingstatechange=()=>{H(e=>i(i({},e),{},{signaling:t.signalingState})),B("signalingState",t.signalingState)},t.onicegatheringstatechange=()=>{H(e=>i(i({},e),{},{gathering:t.iceGatheringState}))},t.onnegotiationneeded=()=>{B("onnegotiationneeded"),$()},t.__maybeNegotiate=$,t},[B,$,q,V]),K=(0,l.useCallback)(async()=>{if(S.current)return S.current;try{const e={audio:!0,video:{width:{ideal:640},height:{ideal:360}}};B("getUserMedia: requesting",e);const t=await navigator.mediaDevices.getUserMedia(e);return B("getUserMedia: success",{audio:t.getAudioTracks().length,video:t.getVideoTracks().length}),S.current=t,v.current&&(v.current.srcObject=t,v.current.muted=!0,v.current.volume=0,v.current.play().catch(e=>console.warn("[CALL] local video play error",e))),H(e=>i(i({},e),{},{localTracks:{audio:t.getAudioTracks().length,video:t.getVideoTracks().length},mediaError:null})),t}catch(yo){return console.error("[CALL] Error acquiring media",yo),H(t=>i(i({},t),{},{mediaError:"".concat((null===yo||void 0===yo?void 0:yo.name)||"Error",": ").concat((null===yo||void 0===yo?void 0:yo.message)||"")})),null}},[B]),Q=(0,l.useCallback)(async()=>{const e=w.current;if(!e)return;await K();const t=S.current;if(!t)return void B("addTracksToPc: no localStream (solo recibir\xe1 medios)");const n=t.getAudioTracks()[0]||null,r=t.getVideoTracks()[0]||null;var a,o;(B("addTracksToPc: attaching tracks",{hasAudio:!!n,hasVideo:!!r}),k.current&&n&&(await k.current.sender.replaceTrack(n),k.current.direction="sendrecv"),E.current&&r&&(await E.current.sender.replaceTrack(r),E.current.direction="sendrecv"),R.current=!(!n&&!r),H(e=>i(i({},e),{},{localTracks:{audio:t.getAudioTracks().length,video:t.getVideoTracks().length}})),C.current&&R.current)&&(null===(a=(o=e).__maybeNegotiate)||void 0===a||a.call(o))},[K,B]),G=(0,l.useCallback)(async e=>{const t=w.current;if(!t)return;const n=JSON.parse(e.data);if("HEARTBEAT"!==n.type&&B("WS RECV",{type:n.type,from:n.from}),(n.from!==s||"JOIN_ACK"===n.type)&&(!n.sessionId||!m.current||n.sessionId===m.current||"JOIN_ACK"===n.type)){if("JOIN_ACK"===n.type){const e=n.payload||{};return C.current=!!e.initiator,T.current=!e.initiator,j.current=!0,B("JOIN_ACK",e),n.sessionId&&(m.current=n.sessionId,h(n.sessionId)),n.reservationId&&(g.current=n.reservationId,f(n.reservationId)),void await Q()}if("PEER_JOINED"!==n.type){if("PEER_LEFT"===n.type)return I.current=!1,B("PEER_LEFT"),void u("connecting");if("OFFER"===n.type){await Q();const e=n.payload;B("OFFER received",{signaling:t.signalingState});const r=P.current,a="stable"===t.signalingState,o="offer"===e.type&&(r||!a);if(o&&!T.current)return A.current=!0,void B("GLARE (impolite), ignoring offer");if(A.current=!1,o&&T.current&&(B("GLARE (polite), rollback local"),await t.setLocalDescription({type:"rollback"})),await t.setRemoteDescription(e),L.current.length>0){for(const e of L.current)await t.addIceCandidate(e).catch(e=>console.error("[CALL] addIceCandidate queued error",e));L.current=[]}const s=await t.createAnswer();return s.sdp=Ga(s.sdp),await t.setLocalDescription(s),V({type:"ANSWER",payload:t.localDescription}),void B("ANSWER sent")}if("ANSWER"!==n.type){if("ICE_CANDIDATE"===n.type){if(A.current||!n.payload)return;const e=new RTCIceCandidate(n.payload);return void(t.remoteDescription&&"rollback"!==t.remoteDescription.type?await t.addIceCandidate(e).catch(e=>console.error("[CALL] addIceCandidate error",e)):L.current.push(e))}"END"!==n.type||W()}else if(B("ANSWER received",{signaling:t.signalingState}),"have-local-offer"===t.signalingState&&(await t.setRemoteDescription(n.payload),L.current.length>0)){for(const e of L.current)await t.addIceCandidate(e).catch(e=>console.error("[CALL] addIceCandidate queued error",e));L.current=[]}}else{var r,a;I.current=!0,B("PEER_JOINED"),u("connecting"),C.current&&R.current&&(null===(r=(a=t).__maybeNegotiate)||void 0===r||r.call(a))}}},[Q,W,B,s]),Y=(0,l.useCallback)(async()=>{B("start()",{sessionIdParam:e,reservationIdParam:r.get("reservationId")}),u("connecting"),z.current=!1,await J(),await K();const t=new WebSocket("".concat("https:"===window.location.protocol?"wss":"ws","://localhost:8093/ws/call?token=").concat(encodeURIComponent(o)));x.current=t,t.onopen=async()=>{N.current=!0,M.current=0,B("WS opened");let e=m.current;if(!e){if(!g.current)return void console.error("[CALL] Falta reservationId para crear la sesi\xf3n");const t=await Ca(g.current,o);e=t.sessionId,m.current=e,h(e),f(t.reservationId),B("Session created",t)}const n={type:"JOIN",sessionId:e,reservationId:g.current,from:s,ts:Date.now()};t.send(JSON.stringify(n)),B("JOIN sent",{sessionId:e}),O.current=window.setInterval(()=>V({type:"HEARTBEAT"}),1e4)},t.onmessage=G,t.onclose=()=>{if(B("WS closed"),x.current=null,N.current=!1,!z.current){if(O.current&&(window.clearInterval(O.current),O.current=null),w.current&&(w.current.getSenders().forEach(e=>e.track&&e.track.stop()),w.current.close(),w.current=null),_.current=null,R.current=!!S.current,M.current+=1,M.current>3)return B("Max reconnect attempts reached"),void u("failed");u("connecting"),B("Scheduling reconnect",{attempt:M.current}),setTimeout(()=>{z.current||Y()},2e3)}},t.onerror=e=>{console.error("[CALL] WS error",e),u("failed")}},[K,J,B,G,V,e,o,s,r]),X=(0,l.useCallback)(()=>{V({type:"END"}),W(),n(-1)},[W,n,V]),Z=(0,l.useCallback)(()=>{var e;const t=null===(e=S.current)||void 0===e?void 0:e.getAudioTracks()[0];t?(t.enabled=!t.enabled,B("toggleMic",{enabled:t.enabled})):B("toggleMic: NO audio track (posible NotReadable / sin permisos)")},[B]),ee=(0,l.useCallback)(()=>{var e;const t=null===(e=S.current)||void 0===e?void 0:e.getVideoTracks()[0];t?(t.enabled=!t.enabled,B("toggleCam",{enabled:t.enabled})):B("toggleCam: NO video track (posible NotReadable / sin permisos)")},[B]),te=(0,l.useCallback)(async()=>{var e;const t=w.current;if(t&&null!==(e=E.current)&&void 0!==e&&e.sender)try{B("shareScreen: getDisplayMedia()");const e=(await navigator.mediaDevices.getDisplayMedia({video:!0})).getVideoTracks()[0];if(!e)return void B("shareScreen: no video track from display");var n,r;if(await E.current.sender.replaceTrack(e),R.current=!0,B("shareScreen: track attached",{id:e.id,label:e.label}),C.current)null===(n=(r=t).__maybeNegotiate)||void 0===n||n.call(r);e.onended=async()=>{var e,t;B("shareScreen: track ended, volviendo a c\xe1mara si existe");const n=(null===(e=S.current)||void 0===e?void 0:e.getVideoTracks()[0])||null;await(null===(t=E.current)||void 0===t?void 0:t.sender.replaceTrack(n))}}catch(yo){console.warn("[CALL] shareScreen error",yo)}else B("shareScreen: no PC o no video sender")},[B]);return(0,l.useEffect)(()=>{if(!U.current)return U.current=!0,M.current=0,Y(),()=>{W()}},[W,Y]),(0,l.useEffect)(()=>{const e=()=>{W()};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[W]),(0,_r.jsxs)("div",{className:"call-page-container",children:[(0,_r.jsxs)("div",{className:"call-header",children:[(0,_r.jsx)("h1",{children:"Sesi\xf3n de llamada"}),(0,_r.jsxs)("div",{className:"call-meta",children:[(0,_r.jsxs)("div",{className:"status-badge",children:[(0,_r.jsx)("span",{className:"status-dot ".concat("connected"===c?"connected":"failed"===c||"closed"===c?"failed":"")}),(0,_r.jsx)("span",{children:c})]}),(0,_r.jsx)(Ka,{})]})]}),(0,_r.jsx)("div",{className:"video-grid",children:(0,_r.jsxs)("div",{className:"remote-video-wrapper",children:[(0,_r.jsx)("video",{ref:y,className:"remote-video",autoPlay:!0,playsInline:!0}),(0,_r.jsx)("div",{className:"local-video-wrapper",children:(0,_r.jsx)("video",{ref:v,className:"local-video",autoPlay:!0,playsInline:!0,muted:!0})})]})}),(0,_r.jsx)("div",{className:"controls-dock",children:(0,_r.jsx)(Qa,{onToggleMic:Z,onToggleCam:ee,onShareScreen:te,onEnd:X})}),(0,_r.jsx)("audio",{ref:b,style:{display:"none"},autoPlay:!0,playsInline:!0}),(0,_r.jsxs)("div",{className:"debug-panel",children:[(0,_r.jsx)("strong",{children:"Debug"}),(0,_r.jsxs)("div",{children:["signaling: ",F.signaling," / ice: ",F.ice," / gathering:"," ",F.gathering]}),(0,_r.jsxs)("div",{children:["local: a",F.localTracks.audio,"v",F.localTracks.video," / remote: a",F.remoteTracks.audio,"v",F.remoteTracks.video]}),F.mediaError&&(0,_r.jsxs)("div",{style:{marginTop:4,fontSize:12,color:"#f87171"},children:["mediaError: ",F.mediaError]})]})]})}function Xa(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function Za(e,t){const n=new Date(e+"T00:00:00");return n.setDate(n.getDate()+t),Xa(n)}function eo(e){const t=(null!==e&&void 0!==e?e:"").trim(),n=/^(\d{1,2}):(\d{2})/.exec(t);return n?"".concat(n[1].padStart(2,"0"),":").concat(n[2]):t.slice(0,5)}function to(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return new Date("".concat(e.date,"T").concat(eo(e.end))).getTime()>=t.getTime()}function no(e){const t=new Date,n=new Date("".concat(e.date,"T").concat(eo(e.start))),r=new Date("".concat(e.date,"T").concat(eo(e.end))),a=(e.status||"").toUpperCase();if("PENDIENTE"===a)return t>r?"VENCIDA":"PENDIENTE";if("ACEPTADO"===a){if(t>=n&&t<=r)return"ACTIVA";if(t>r){var o,s,i,l,c,u;const t=e,n=Boolean(null!==(o=null!==(s=null!==(i=t.studentAttended)&&void 0!==i?i:t.attendedStudent)&&void 0!==s?s:t.attendedByStudent)&&void 0!==o?o:t.attended),r=Boolean(null!==(l=null!==(c=null!==(u=t.tutorAttended)&&void 0!==u?u:t.attendedTutor)&&void 0!==c?c:t.attendedByTutor)&&void 0!==l?l:t.attended);return Boolean(t.hadCall||t.callStartedAt||t.callEndedAt||t.callDurationSec>0)||n&&r?"FINALIZADA":"INCUMPLIDA"}return"ACEPTADO"}return a}function ro(){try{return crypto.getRandomValues(new Uint32Array(4)).join("-")}catch(e){return"".concat(Date.now(),"-").concat(Math.random())}}const ao=e=>{let{message:t,isMine:n}=e;const r=n?"chat-bubble mine":"chat-bubble theirs",a=function(e){if(!e)return(new Date).toISOString();if("object"===typeof e&&null!==e){const t=e,n=t.createdAt,r=t.timestamp;if("string"===typeof n&&n)return n;if("string"===typeof r&&r)return r}return(new Date).toISOString()}(t);return(0,_r.jsxs)("div",{className:r,children:[(0,_r.jsx)("p",{children:t.content}),(0,_r.jsx)("span",{className:"timestamp",children:new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},oo=e=>{let{contact:t,myUserId:n,token:r,onClose:a}=e;const[o,s]=(0,l.useState)([]),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)(""),h=(0,l.useRef)(null),p=(0,l.useRef)(null),f=(0,l.useRef)(null),m=(0,l.useRef)(0),g=(0,l.useRef)(!1),v=e=>{const t=Date.now(),n=f.current;if(f.current=e,m.current=t,"connecting"===e)return;if("closed"===e&&t-m.current<800)return;("open"===n||g.current)&&("closed"!==e&&"error"!==e||g.current||(g.current=!0,a()))};(0,l.useEffect)(()=>(p.current=new da,p.current.connect(r,e=>{const t=((e,t)=>{var n,r,a,o,s,i,l,c,u,d,h,p,f,m,g;return{id:String(null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:ro()),chatId:String(null!==(r=null===e||void 0===e?void 0:e.chatId)&&void 0!==r?r:t),fromUserId:String(null!==(a=null!==(o=null!==(s=null!==(i=null===e||void 0===e?void 0:e.fromUserId)&&void 0!==i?i:null===e||void 0===e?void 0:e.senderId)&&void 0!==s?s:null===e||void 0===e?void 0:e.from)&&void 0!==o?o:null===e||void 0===e?void 0:e.userId)&&void 0!==a?a:""),toUserId:String(null!==(l=null!==(c=null!==(u=null===e||void 0===e?void 0:e.toUserId)&&void 0!==u?u:null===e||void 0===e?void 0:e.recipientId)&&void 0!==c?c:null===e||void 0===e?void 0:e.to)&&void 0!==l?l:""),content:String(null!==(d=null!==(h=null===e||void 0===e?void 0:e.content)&&void 0!==h?h:null===e||void 0===e?void 0:e.text)&&void 0!==d?d:""),createdAt:String(null!==(p=null!==(f=null===e||void 0===e?void 0:e.createdAt)&&void 0!==f?f:null===e||void 0===e?void 0:e.timestamp)&&void 0!==p?p:(new Date).toISOString()),delivered:Boolean(null!==(m=null===e||void 0===e?void 0:e.delivered)&&void 0!==m&&m),read:Boolean(null!==(g=null===e||void 0===e?void 0:e.read)&&void 0!==g&&g)}})(e&&"string"===typeof e.data?JSON.parse(e.data):e,u||"unknown");u&&t.chatId!==u||s(e=>[...e,t])},v),()=>{var e;null===(e=p.current)||void 0===e||e.disconnect(),p.current=null}),[r,u]),(0,l.useEffect)(()=>{let e=!0;return(async a=>{let o=null;try{o=await ia(t.id,r)}catch(l){o=await ca(n,t.id)}if(e){d(null!==(a=o)&&void 0!==a?a:"");try{var i;const t=await la(null!==(i=o)&&void 0!==i?i:"",r);if(!e)return;s(t)}catch(c){if(!e)return;s([])}}})(),()=>{e=!1}},[t.id,n,r]),(0,l.useEffect)(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[o]);return(0,_r.jsxs)("div",{className:"chat-side-panel",children:[(0,_r.jsxs)("div",{className:"chat-window-header",children:[(0,_r.jsx)("h4",{children:t.name}),(0,_r.jsx)("button",{onClick:a,className:"close-chat-btn",type:"button",children:"\xd7"})]}),(0,_r.jsxs)("div",{className:"chat-messages",children:[o.map(e=>(0,_r.jsx)(ao,{message:e,isMine:e.fromUserId===n},e.id)),(0,_r.jsx)("div",{ref:h})]}),(0,_r.jsxs)("form",{className:"chat-input-form",onSubmit:e=>{var n;e.preventDefault(),i.trim()&&(null===(n=p.current)||void 0===n||n.sendMessage(t.id,i),c(""))},children:[(0,_r.jsx)("input",{value:i,onChange:e=>c(e.target.value),placeholder:"Escribe un mensaje..."}),(0,_r.jsx)("button",{type:"submit",children:"Enviar"})]})]})},so=()=>{var e;const t=me(),n=dr(),[r,a]=(0,l.useState)(void 0);(0,l.useEffect)(()=>{var e,t,r;n.isAuthenticated&&n.user?a(null!==(e=null===(t=n.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(r=n.user)||void 0===r?void 0:r.access_token):a(void 0)},[n.isAuthenticated,n.user]);const{userRoles:o,isAuthenticated:s,needsRoleSelection:c}=Sr();Er();const[u,d]=(0,l.useState)(null);(0,l.useEffect)(()=>{var e,r,a,i;null!==s&&null!==o&&(s?c?t("/role-selection"):null!==o&&void 0!==o&&o.includes("student")?n.user&&d({userId:(null===(e=n.user.profile)||void 0===e?void 0:e.sub)||"unknown",name:(null===(r=n.user.profile)||void 0===r?void 0:r.name)||(null===(a=n.user.profile)||void 0===a?void 0:a.nickname)||"Usuario",email:(null===(i=n.user.profile)||void 0===i?void 0:i.email)||"No email",role:"student"}):t("/"):t("/login"))},[s,o,c,t,n.user]);const[h,p]=(0,l.useState)(null),f=null===(e=n.user)||void 0===e?void 0:e.profile.sub,[m,g]=(0,l.useState)(()=>function(e){const t=new Date(e+"T00:00:00"),n=t.getDay(),r=(0===n?-6:1)-n;return t.setDate(t.getDate()+r),Xa(t)}(Xa(new Date))),[v,y]=(0,l.useState)([]),[b,w]=(0,l.useState)(!1),[x,S]=(0,l.useState)(!1),[_,k]=(0,l.useState)(1),[E,N]=(0,l.useState)(0);(0,l.useEffect)(()=>{var e,t,r;const a=null!==(e=null===(t=n.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(r=n.user)||void 0===r?void 0:r.access_token;if(!a)return;(async()=>{try{const e=await Fr.getStudentBalance(a);N(e.tokenBalance)}catch(yo){console.error("Error cargando balance:",yo)}})()},[n.user]);const j=pr.USERS_BASE,C=pr.USERS_PROFILE_PATH,[T,P]=(0,l.useState)({}),A=async()=>{if(!r)return;const e=Za(m,-35),t=Za(m,35);try{w(!0);const n=(await Tr(e,t,r)).map(e=>i(i({},e),{},{effectiveStatus:no(e)}));y(n)}catch(n){y([])}finally{w(!1)}};(0,l.useEffect)(()=>{r&&A()},[r]),(0,l.useEffect)(()=>{r&&A()},[m]);(0,l.useEffect)(()=>{const e=Array.from(new Set(v.map(e=>null===e||void 0===e?void 0:e.tutorId).filter(Boolean))).filter(e=>!T[e]);if(0===e.length||!r)return;let t=!1;return(async()=>{try{const n=await Promise.allSettled(e.map(e=>(async(e,t)=>{var n;const r={Accept:"application/json",Authorization:"Bearer ".concat(t)},a=async t=>{const n="".concat(j).concat(C,"?").concat(t,"=").concat(encodeURIComponent(e)),a=await fetch(n,{headers:r});return a.ok?a.json():null},o=null!==(n=await a("id"))&&void 0!==n?n:await a("sub");return{id:e,prof:o}})(e,r)));if(t)return;const a={};for(const e of n)if("fulfilled"===e.status&&e.value.prof){const{id:t,prof:n}=e.value;a[t]={id:null===n||void 0===n?void 0:n.id,sub:null===n||void 0===n?void 0:n.sub,name:(null===n||void 0===n?void 0:n.name)||(null===n||void 0===n?void 0:n.fullName)||"Tutor",email:null===n||void 0===n?void 0:n.email,avatarUrl:null===n||void 0===n?void 0:n.avatarUrl,tokensPerHour:null===n||void 0===n?void 0:n.tokensPerHour}}Object.keys(a).length>0&&P(e=>i(i({},e),a))}catch(n){}})(),()=>{t=!0}},[v,T,j,C,r]);const I=(0,l.useMemo)(()=>{const e=new Set;for(const t of v)t.tutorId&&e.add(t.tutorId);return e.size},[v]),R=(0,l.useMemo)(()=>v.filter(e=>"CANCELADO"!==e.effectiveStatus&&to(e)).length,[v]),D=v.filter(e=>{const t=new Date(e.date+"T00:00:00"),n=new Date(m+"T00:00:00"),r=new Date(Za(m,6)+"T23:59:59");return t>=n&&t<=r}),O=x?D:D.filter(e=>to(e)),L=x?O:O.filter(e=>"CANCELADO"!==e.effectiveStatus),U=Math.max(1,Math.ceil(L.length/15)),M=L.slice(15*(_-1),15*_);(0,l.useEffect)(()=>{k(1)},[x,m]);if(n.isLoading)return(0,_r.jsx)("div",{className:"full-center",children:"\u23f3 Verificando acceso..."});if(!u)return(0,_r.jsx)("div",{className:"full-center",children:"\ud83d\udd0d Cargando informaci\xf3n..."});return(0,_r.jsxs)("div",{className:"dashboard-container",children:[(0,_r.jsx)(Jr,{currentUser:u,activeSection:"my-reservations",onSectionChange:e=>{"none"!==e&&Wr(t,e)},tokenBalance:E}),(0,_r.jsx)("main",{className:"dashboard-main dashboard-main--tight",children:(0,_r.jsxs)("div",{className:"tasks-section",children:[(0,_r.jsx)("h1",{children:"Mis Reservas \ud83d\uddd3\ufe0f"}),(0,_r.jsxs)("div",{className:"stats-grid",style:{marginTop:8,marginBottom:16},children:[(0,_r.jsxs)("div",{className:"stat-card",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83d\uddd3\ufe0f"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:R}),(0,_r.jsx)("p",{children:"Reservas presentes"})]})]}),(0,_r.jsxs)("div",{className:"stat-card",children:[(0,_r.jsx)("div",{className:"stat-icon",children:"\ud83e\uddd1\u200d\ud83c\udfeb"}),(0,_r.jsxs)("div",{className:"stat-info",children:[(0,_r.jsx)("h3",{children:I}),(0,_r.jsx)("p",{children:"Tutores con solicitudes/reservas"})]})]})]}),(0,_r.jsxs)("div",{className:"page-with-chat-container",children:[(0,_r.jsx)("div",{className:"main-content ".concat(h?"chat-open":""),children:(0,_r.jsxs)("div",{className:"card card--primary-soft reservations-panel",children:[(0,_r.jsxs)("div",{className:"week-toolbar",children:[(0,_r.jsx)("button",{className:"btn btn-ghost btn-nav",onClick:()=>g(Za(m,-7)),type:"button",children:"\xab Anterior"}),(0,_r.jsxs)("div",{className:"week-toolbar__title",children:["Semana del ",m," al ",Za(m,6)]}),(0,_r.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,_r.jsx)("button",{className:"btn btn-nav",onClick:()=>S(!x),type:"button",style:{backgroundColor:"white",color:"#5b46d8"},children:x?"Mostrar presentes":"Mostrar todas"}),(0,_r.jsx)("button",{className:"btn btn-ghost btn-nav",onClick:()=>g(Za(m,7)),type:"button",children:"Siguiente \xbb"})]})]}),b&&(0,_r.jsx)("div",{className:"empty-note",children:"Cargando reservas\u2026"}),!b&&0===L.length&&(0,_r.jsx)("div",{className:"empty-note",children:x?"No tienes reservas esta semana.":"No tienes reservas activas esta semana."}),(0,_r.jsx)("div",{className:"reservations-list",children:M.map(e=>{const n=(e=>{const t=(e||"").toUpperCase();return{CANCELADO:{label:"CANCELADO",color:"#ef4444",bg:"rgba(239,68,68,.12)"},PENDIENTE:{label:"PENDIENTE",color:"#f59e0b",bg:"rgba(245,158,11,.12)"},ACEPTADO:{label:"ACEPTADA",color:"#10b981",bg:"rgba(16,185,129,.12)"},ACTIVA:{label:"ACTIVA",color:"#3b82f6",bg:"rgba(59,130,246,.12)"},INCUMPLIDA:{label:"INCUMPLIDA",color:"#f97316",bg:"rgba(249,115,22,.12)"},FINALIZADA:{label:"FINALIZADA",color:"#0ea5e9",bg:"rgba(14,165,233,.12)"},VENCIDA:{label:"VENCIDA",color:"#6b7280",bg:"rgba(107,114,128,.15)"}}[t]||{label:t,color:"#6b7280",bg:"rgba(107,114,128,.12)"}})(e.effectiveStatus),a=T[e.tutorId],o=(null===a||void 0===a?void 0:a.name)||e.tutorName||"Tutor",s=(new Date("".concat(e.date,"T").concat(eo(e.start))).getTime()-Date.now())/36e5,i=("PENDIENTE"===e.effectiveStatus||"ACEPTADO"===e.effectiveStatus)&&s>=12,l="ACEPTADO"===e.effectiveStatus||"INCUMPLIDA"===e.effectiveStatus;return(0,_r.jsxs)("article",{className:"reservation-card",children:[(0,_r.jsxs)("header",{className:"reservation-card__header",children:[(0,_r.jsxs)("h3",{className:"reservation-card__title",children:["Reserva con ",o]}),(0,_r.jsx)("span",{className:"status-pill",style:{color:n.color,background:n.bg},children:n.label})]}),(0,_r.jsxs)("div",{className:"reservation-card__meta",style:{marginTop:6},children:[(0,_r.jsxs)("span",{children:["\ud83d\udcc5 ",e.date]}),(0,_r.jsxs)("span",{children:["\ud83d\udd52 ",eo(e.start)," \u2013 ",eo(e.end)]})]}),(0,_r.jsxs)("div",{className:"reservation-card__actions",children:[(0,_r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>(async e=>{try{if(!r)return void alert("No hay sesi\xf3n activa.");const{sessionId:n}=await Ca(e.id,r);sessionStorage.setItem("call:reservation:"+n,String(e.id)),t("/call/".concat(n))}catch(yo){var n;alert("No se pudo iniciar la reuni\xf3n: "+(null!==(n=null===yo||void 0===yo?void 0:yo.message)&&void 0!==n?n:"error"))}})(e),disabled:"ACTIVA"!==e.effectiveStatus,title:"ACTIVA"===e.effectiveStatus?"Entrar a la reuni\xf3n":"Disponible cuando la reserva est\xe1 ACTIVA",style:{marginRight:8},children:"\u25b6 Reunirse ahora"}),(0,_r.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>(e=>{const t=T[e],n=(null===t||void 0===t?void 0:t.name)||"Tutor",r=null===t||void 0===t?void 0:t.avatarUrl,a=(null===t||void 0===t?void 0:t.email)||"N/A";p({id:e,sub:e,name:n,email:a,avatarUrl:r})})(e.tutorId),disabled:!l,title:l?"Contactar al tutor":"Solo disponible con reservas ACEPTADAS o INCUMPLIDAS",children:"Contactar"}),(0,_r.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>(async e=>{if(!r)return;const t=(e.effectiveStatus||"").toUpperCase(),n=(new Date("".concat(e.date,"T").concat(eo(e.start))).getTime()-Date.now())/36e5;if(("PENDIENTE"===t||"ACEPTADO"===t)&&n>=12){if(globalThis.confirm("\xbfSeguro que quieres cancelar esta reserva?")){if(await Ar(e.id,r),"ACEPTADO"===t){const t=f||(null===u||void 0===u?void 0:u.userId)||"";try{await Fr.refundOnCancellation({fromUserId:t,toUserId:e.tutorId,reservationId:e.id,cancelledBy:"STUDENT",reason:"Cancelaci\xf3n por estudiante"},r)}catch(yo){console.warn("No se pudo procesar refund por cancelaci\xf3n del estudiante:",yo)}try{const e=await Fr.getStudentBalance(r);N(e.tokenBalance),globalThis.dispatchEvent(new CustomEvent("tokens:refresh"))}catch(yo){console.warn("No se pudo refrescar balance inmediatamente:",yo)}}await A()}}else alert("Solo puedes cancelar reservas PENDIENTE o ACEPTADO y con 12+ horas de antelaci\xf3n.")})(e),disabled:!i,title:i?"Cancelar esta reserva":"Solo si falta 12+ horas y estado PENDIENTE/ACEPTADO",children:"Cancelar"})]})]},e.id)})}),L.length>15&&(0,_r.jsxs)("div",{className:"pagination-controls",style:{marginTop:"20px",textAlign:"center"},children:[(0,_r.jsx)("button",{className:"btn btn-ghost",onClick:()=>k(e=>Math.max(1,e-1)),disabled:1===_,type:"button",children:"Anterior"}),(0,_r.jsxs)("span",{style:{margin:"0 15px",color:"white",fontWeight:"bold"},children:["P\xe1gina ",_," de ",U]}),(0,_r.jsx)("button",{className:"btn btn-ghost",onClick:()=>k(e=>Math.min(U,e+1)),disabled:_===U,type:"button",children:"Siguiente"})]})]})}),h&&f&&r&&(0,_r.jsx)(oo,{contact:h,myUserId:f,token:r,onClose:()=>p(null)})]})]})})]})},io=pr.SEARCH_BASE;function lo(e){if(!e)return"";if("string"===typeof e)return e;if(Array.isArray(e))return e.join(" ");if("object"===typeof e){if("string"===typeof e.text)return e.text;if("string"===typeof e.value)return e.value}return String(e)}const co=class{static async getTopTutors(){try{const e="".concat(io,"/tutors/top"),t=await fetch(e,{method:"GET"});if(!t.ok){const e=await t.text().catch(()=>"");throw console.error("Error HTTP en ApiSearchService.getTopTutors:",t.status,e),new Error("Error obteniendo mejores tutores")}const n=await t.json();return Array.isArray(n)?n.map(e=>{var t,n,r,a,o;let s,i;return s="number"===typeof e.rating?e.rating:"number"===typeof e.ratingValue?e.ratingValue:void 0,i="number"===typeof e.tokensPerHour?e.tokensPerHour:"number"===typeof e.rate?e.rate:void 0,{userId:null!==(t=null!==(n=e.userId)&&void 0!==n?n:e.id)&&void 0!==t?t:"",name:null!==(r=e.name)&&void 0!==r?r:"",email:null!==(a=e.email)&&void 0!==a?a:"",bio:lo(null!==(o=e.bio)&&void 0!==o?o:e.biography),specializations:Array.isArray(e.specializations)?e.specializations:[],credentials:Array.isArray(e.credentials)?e.credentials:[],rating:s,tokensPerHour:i}}):[]}catch(e){throw console.error("ApiSearchService.getTopTutors error:",e),e}}static async searchTutors(e){try{const t=(null!==e&&void 0!==e?e:"").trim(),n=t.length>0?"".concat(io,"/tutors?q=").concat(encodeURIComponent(t)):"".concat(io,"/tutors"),r=await fetch(n,{method:"GET"});if(!r.ok){const e=await r.text().catch(()=>"");throw console.error("Error HTTP en ApiSearchService.searchTutors:",r.status,e),new Error("Error buscando tutores")}const a=await r.json();return Array.isArray(a)?a.map(e=>{var t,n,r,a,o,s;let i,l;return i="number"===typeof e.rating?e.rating:"number"===typeof e.ratingValue?e.ratingValue:void 0,l="number"===typeof e.tokensPerHour?e.tokensPerHour:"number"===typeof e.rate?e.rate:void 0,{userId:null!==(t=null!==(n=null!==(r=e.userId)&&void 0!==r?r:e.id)&&void 0!==n?n:e.sub)&&void 0!==t?t:"",name:null!==(a=e.name)&&void 0!==a?a:"",email:null!==(o=e.email)&&void 0!==o?o:"",bio:lo(null!==(s=e.bio)&&void 0!==s?s:e.biography),specializations:Array.isArray(e.specializations)?e.specializations:[],credentials:Array.isArray(e.credentials)?e.credentials:[],rating:i,tokensPerHour:l}}):[]}catch(t){throw console.error("ApiSearchService.searchTutors error:",t),t}}},uo=()=>{const e=me(),t=dr(),{userRoles:n,isAuthenticated:r,needsRoleSelection:a}=Sr(),{isProfileComplete:o,missingFields:s}=Er(),[i,c]=(0,l.useState)(null),[u,d]=(0,l.useState)(""),[h,p]=(0,l.useState)([]),[f,m]=(0,l.useState)(!1),[g,v]=(0,l.useState)(""),[y,b]=(0,l.useState)(!0),[w,x]=(0,l.useState)(0);(0,l.useEffect)(()=>{var o,s,i,l;null!==r&&null!==n&&(r?a?e("/role-selection"):null!==n&&void 0!==n&&n.includes("student")?t.user&&c({userId:(null===(o=t.user.profile)||void 0===o?void 0:o.sub)||"unknown",name:(null===(s=t.user.profile)||void 0===s?void 0:s.name)||(null===(i=t.user.profile)||void 0===i?void 0:i.nickname)||"Usuario",email:(null===(l=t.user.profile)||void 0===l?void 0:l.email)||"No email",role:"student"}):e("/"):e("/login"))},[r,n,a,e,t.user]),(0,l.useEffect)(()=>{var e,n,r;const a=null!==(e=null===(n=t.user)||void 0===n?void 0:n.id_token)&&void 0!==e?e:null===(r=t.user)||void 0===r?void 0:r.access_token;if(!a)return;(async()=>{try{const e=await Fr.getStudentBalance(a);x(e.tokenBalance)}catch(yo){console.error("Error cargando balance:",yo)}})()},[t.user]),(0,l.useEffect)(()=>{(async()=>{m(!0);try{const e=await co.getTopTutors();p(e||[])}catch(e){console.error("Error cargando mejores tutores:",e),v("No se pudieron cargar los tutores recomendados")}finally{m(!1)}})()},[]);return t.isLoading||!i?(0,_r.jsx)("div",{className:"full-center",children:"Cargando..."}):(0,_r.jsxs)("div",{className:"dashboard-container",children:[!o&&s&&y&&(0,_r.jsx)(Ur,{currentRole:"student",missingFields:s,onDismiss:()=>b(!1)}),(0,_r.jsx)(Jr,{currentUser:i,activeSection:"find-tutors",onSectionChange:t=>{Wr(e,t)},tokenBalance:w}),(0,_r.jsx)("main",{className:"dashboard-main",children:(0,_r.jsxs)("div",{className:"tutors-section",children:[(0,_r.jsx)("h1",{children:"Buscar Tutores \ud83d\udd0d"}),(0,_r.jsxs)("section",{className:"tutor-search",children:[(0,_r.jsxs)("form",{onSubmit:async e=>{null===e||void 0===e||e.preventDefault(),m(!0),v("");try{var t;const e=await co.searchTutors(u);p(e||[]),sessionStorage.setItem("u-learn:lastTutorSearchCount",String(null!==(t=null===e||void 0===e?void 0:e.length)&&void 0!==t?t:0))}catch(n){v((null===n||void 0===n?void 0:n.message)||"Error en la b\xfasqueda")}finally{m(!1)}},className:"tutor-search-form",children:[(0,_r.jsx)("input",{type:"text",placeholder:"Ej: java, c\xe1lculo, Mar\xeda...",value:u,onChange:e=>d(e.target.value)}),(0,_r.jsx)("button",{type:"submit",disabled:f,children:f?"Buscando...":"Buscar"})]}),g&&(0,_r.jsx)("p",{className:"error",children:g}),(0,_r.jsxs)("div",{className:"tutor-results",children:[0===h.length&&!f&&(0,_r.jsx)("p",{children:"No hay tutores disponibles en este momento."}),h.map(t=>(0,_r.jsxs)("div",{className:"tutor-card",children:[(0,_r.jsx)("div",{className:"tutor-card-header",children:(0,_r.jsxs)("div",{className:"tutor-title",children:[(0,_r.jsx)("strong",{className:"tutor-name",children:t.name}),(0,_r.jsx)("br",{}),(0,_r.jsx)("span",{className:"tutor-email",children:t.email})]})}),t.bio&&(0,_r.jsx)("p",{className:"tutor-bio",children:t.bio}),t.specializations&&t.specializations.length>0&&(0,_r.jsx)("div",{className:"tutor-tags",children:t.specializations.map((e,t)=>(0,_r.jsxs)("span",{className:"tag specialization-tag ".concat(e.verified?"verified":"manual"),title:e.verified?"Verificado por IA - ".concat(e.source):"Agregado manualmente",children:[e.verified&&(0,_r.jsx)("span",{className:"verified-icon",children:"\u2713"}),e.name]},t))}),"number"===typeof t.tokensPerHour&&t.tokensPerHour>0&&(0,_r.jsxs)("p",{className:"tutor-rate",children:[(0,_r.jsx)("strong",{children:"Tarifa:"})," ",t.tokensPerHour," tokens/hora"]}),(0,_r.jsxs)("div",{className:"tutor-actions",children:[(0,_r.jsx)("button",{className:"btn-secondary",onClick:()=>e("/profile/tutor/".concat(t.userId),{state:{profile:t}}),type:"button",children:"Ver Perfil"}),(0,_r.jsx)("button",{className:"btn-primary",onClick:()=>e("/book/".concat(t.userId),{state:{tutor:t,role:"tutor"}}),type:"button",children:"Reservar Cita"})]})]},t.userId))]})]})]})})]})},ho=()=>{var e,t;const n=me(),r=dr(),[a]=St(),[o,s]=(0,l.useState)("loading"),[i,c]=(0,l.useState)("Procesando tu pago..."),[u,d]=(0,l.useState)(null),[h,p]=(0,l.useState)(null),f=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{(async()=>{if(!f.current){f.current=!0;try{const e=a.get("session_id");if(console.log("\ud83d\udd0d [PaymentSuccess] session_id from URL:",e),!e)throw new Error("Falta session_id en la URL");s("pending-confirm"),c("Confirmando pago con el servidor..."),console.log("\ud83d\udce4 [PaymentSuccess] Llamando confirmPayment (una sola vez)...");const t=await Fr.confirmPayment(e);console.log("\u2705 [PaymentSuccess] Pago confirmado:",t),p({tokens:t.tokens,amount:t.amount}),s("success"),c("\xa1Pago confirmado!"),setTimeout(()=>n("/student-dashboard"),3e3)}catch(e){console.error("\u274c [PaymentSuccess] Error procesando el pago:",e),s("error"),c(e instanceof Error?e.message:"Ocurri\xf3 un error al procesar tu pago. Por favor, contacta a soporte.")}}})()},[a,n]),(0,l.useEffect)(()=>{(async()=>{if("success"===o&&null===u)try{var e,t,n;const a=null!==(e=null===(t=r.user)||void 0===t?void 0:t.id_token)&&void 0!==e?e:null===(n=r.user)||void 0===n?void 0:n.access_token;if(!a)return;console.log("\ud83d\udd04 [PaymentSuccess] Refrescando balance despu\xe9s de confirmaci\xf3n...");const o=await Fr.getStudentBalance(a);d(o.tokenBalance),console.log("\ud83d\udcb0 [PaymentSuccess] Nuevo balance:",o.tokenBalance)}catch(yo){console.warn("\u26a0\ufe0f [PaymentSuccess] No se pudo refrescar el balance:",yo)}})()},[o,r.user,u]),r.isLoading?(0,_r.jsx)("div",{className:"payment-page",children:(0,_r.jsxs)("div",{className:"payment-card",children:[(0,_r.jsx)("div",{className:"loader"}),(0,_r.jsx)("p",{children:"Verificando sesi\xf3n..."})]})}):(0,_r.jsx)("div",{className:"payment-page",children:(0,_r.jsxs)("div",{className:"payment-card",children:["loading"===o&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)("div",{className:"loader"}),(0,_r.jsx)("h1",{children:"Procesando tu pago"}),(0,_r.jsx)("p",{children:i})]}),"pending-confirm"===o&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)("div",{className:"loader"}),(0,_r.jsx)("h1",{children:"Confirmando pago"}),(0,_r.jsx)("p",{children:i})]}),"success"===o&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)("div",{className:"success-icon",children:"\u2713"}),(0,_r.jsx)("h1",{children:"\xa1Pago exitoso!"}),(0,_r.jsx)("p",{children:i}),null!==u&&(0,_r.jsxs)("div",{className:"balance-display",children:[(0,_r.jsx)("p",{className:"balance-label",children:"Nuevo balance:"}),(0,_r.jsxs)("p",{className:"balance-amount",children:[u," tokens"]})]}),h&&(0,_r.jsxs)("p",{style:{color:"#6b7280"},children:["Tokens acreditados: ",null!==(e=h.tokens)&&void 0!==e?e:"N/D"," | Monto: ",null!==(t=h.amount)&&void 0!==t?t:"N/D"]}),(0,_r.jsx)("p",{className:"redirect-message",children:"Ser\xe1s redirigido al dashboard en unos segundos..."}),(0,_r.jsx)("button",{className:"btn-primary",onClick:()=>n("/student-dashboard"),type:"button",children:"Ir al Dashboard"})]}),"error"===o&&(0,_r.jsxs)(_r.Fragment,{children:[(0,_r.jsx)("div",{className:"error-icon",children:"\u2715"}),(0,_r.jsx)("h1",{children:"Error al procesar el pago"}),(0,_r.jsx)("p",{className:"error-text",children:i}),(0,_r.jsxs)("div",{className:"button-group",children:[(0,_r.jsx)("button",{className:"btn-primary",onClick:()=>n("/student-dashboard"),type:"button",children:"Volver al Dashboard"}),(0,_r.jsx)("button",{className:"btn-secondary",onClick:()=>window.location.reload(),type:"button",children:"Reintentar"})]})]})]})})},po=()=>{const e=me();return(0,_r.jsx)("div",{className:"payment-page",children:(0,_r.jsxs)("div",{className:"payment-card",children:[(0,_r.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,_r.jsx)("h1",{children:"Pago Cancelado"}),(0,_r.jsx)("p",{children:"Has cancelado el proceso de pago. No se realiz\xf3 ning\xfan cargo."}),(0,_r.jsx)("p",{className:"error-text",children:"Si experimentaste alg\xfan problema, por favor intenta nuevamente o contacta a soporte."}),(0,_r.jsxs)("div",{className:"button-group",children:[(0,_r.jsx)("button",{className:"btn-primary",onClick:()=>e("/student-dashboard"),type:"button",children:"Volver al Dashboard"}),(0,_r.jsx)("button",{className:"btn-secondary",onClick:()=>window.history.back(),type:"button",children:"Intentar Nuevamente"})]})]})})},fo=e=>{let{children:t,allowedRoles:n}=e;const{isLoading:r,isAuthenticated:a,userRoles:o,needsRoleSelection:s}=Sr();return console.log("\ud83d\udee1\ufe0f ProtectedRoute check:",{isAuthenticated:a,isLoading:r,allowedRoles:n,userRoles:o,needsRoleSelection:s}),r?(console.log("\u23f3 ProtectedRoute: Cargando..."),(0,_r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"\u23f3 Verificando permisos..."})):a?s?(console.log("\ud83d\udd04 ProtectedRoute: User needs role selection, redirecting"),(0,_r.jsx)(Re,{to:"/role-selection",replace:!0})):n&&n.length>0&&(console.log("\ud83c\udfad ProtectedRoute: User roles:",o,"Allowed roles:",n),!o||!o.some(e=>n.includes(e)))?(console.log("\u274c ProtectedRoute: Role not allowed, redirecting to home"),(0,_r.jsx)(Re,{to:"/",replace:!0})):(console.log("\u2705 ProtectedRoute: Access granted"),(0,_r.jsx)(_r.Fragment,{children:t})):(console.log("\ud83d\udd12 ProtectedRoute: Not authenticated, redirecting to home"),(0,_r.jsx)(Re,{to:"/",replace:!0}))},mo=()=>{const e=dr(),{isLoading:t,isAuthenticated:n,needsRoleSelection:r,userRoles:a,error:o}=Sr(),s=me();return(0,l.useEffect)(()=>{if(console.log("\ud83d\udccd AuthRedirect useEffect:",{isAuthenticated:n,isLoading:t,needsRoleSelection:r,userRoles:a,error:o}),t)console.log("\u23f3 AuthRedirect: Esperando que termine de cargar...");else{if(!n)return console.log("\ud83d\udd12 AuthRedirect: No autenticado, redirigiendo a home"),void s("/",{replace:!0});if(r)return console.log("\ud83c\udfad AuthRedirect: Redirigiendo a selecci\xf3n de rol"),void s("/role-selection",{replace:!0});if(a&&a.length>0){const e=a.includes("student")?"/student-dashboard":"/tutor-dashboard";return console.log("\ud83d\udcca AuthRedirect: Redirigiendo a:",e),void s(e,{replace:!0})}console.log("\ud83e\udd14 AuthRedirect: Estado inesperado, no redirigiendo")}},[n,t,r,a,s]),e.isLoading||t?(0,_r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"\u23f3 Cargando autenticaci\xf3n..."}):e.error||o?(0,_r.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"20px"},children:[(0,_r.jsxs)("div",{children:["\u274c Error de autenticaci\xf3n: ",(null===(i=e.error)||void 0===i?void 0:i.message)||o]}),(0,_r.jsx)("button",{onClick:()=>e.signinRedirect(),children:"Intentar nuevamente"})]}):n?(0,_r.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:"20px"},children:[(0,_r.jsx)("div",{children:"\u2705 \xa1Autenticaci\xf3n exitosa!"}),(0,_r.jsx)("div",{children:"\ud83d\ude80 Redirigiendo..."})]}):(0,_r.jsx)(Re,{to:"/",replace:!0});var i},go=e=>{let{children:t}=e;const{isLoading:n,isAuthenticated:r,needsRoleSelection:a,userRoles:o}=Sr();if(console.log("\ud83c\udfad RoleSelectionProtectedRoute check:",{isAuthenticated:r,isLoading:n,needsRoleSelection:a,userRoles:o}),n)return console.log("\u23f3 RoleSelectionProtectedRoute: Cargando..."),(0,_r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"18px"},children:"\u23f3 Verificando estado..."});if(!r)return console.log("\ud83d\udd12 RoleSelectionProtectedRoute: Not authenticated, redirecting to home"),(0,_r.jsx)(Re,{to:"/",replace:!0});if(!a){console.log("\u2705 RoleSelectionProtectedRoute: Ya tiene roles, redirigiendo al dashboard");const e=null!==o&&void 0!==o&&o.includes("student")?"/student-dashboard":"/tutor-dashboard";return(0,_r.jsx)(Re,{to:e,replace:!0})}return console.log("\ud83c\udfaf RoleSelectionProtectedRoute: Mostrando selecci\xf3n de roles"),(0,_r.jsx)(_r.Fragment,{children:t})},vo=()=>(0,_r.jsx)(gt,{children:(0,_r.jsx)("div",{className:"App",children:(0,_r.jsxs)(Le,{children:[(0,_r.jsx)(De,{path:"/",element:(0,_r.jsx)(kr,{})}),(0,_r.jsx)(De,{path:"/login",element:(0,_r.jsx)(mo,{})}),(0,_r.jsx)(De,{path:"/register",element:(0,_r.jsx)(Re,{to:"/",replace:!0})}),(0,_r.jsx)(De,{path:"/role-selection",element:(0,_r.jsx)(go,{children:(0,_r.jsx)(Ba,{})})}),(0,_r.jsx)(De,{path:"/student-dashboard",element:(0,_r.jsx)(fo,{allowedRoles:["student"],children:(0,_r.jsx)(Qr,{})})}),(0,_r.jsx)(De,{path:"/tutor-dashboard",element:(0,_r.jsx)(fo,{allowedRoles:["tutor"],children:(0,_r.jsx)(Fa,{})})}),(0,_r.jsx)(De,{path:"/tutor/mis-clases-simple",element:(0,_r.jsx)(fo,{allowedRoles:["tutor"],children:(0,_r.jsx)(za,{})})}),(0,_r.jsx)(De,{path:"/availability",element:(0,_r.jsx)(fo,{allowedRoles:["tutor"],children:(0,_r.jsx)(oa,{})})}),(0,_r.jsx)(De,{path:"/profile/:role/:userId",element:(0,_r.jsx)(fo,{children:(0,_r.jsx)(Wa,{})})}),(0,_r.jsx)(De,{path:"/book/:tutorId",element:(0,_r.jsx)(fo,{allowedRoles:["student"],children:(0,_r.jsx)(Ja,{})})}),(0,_r.jsx)(De,{path:"/tutor-classes",element:(0,_r.jsx)(fo,{allowedRoles:["tutor"],children:(0,_r.jsx)(Sa,{})})}),(0,_r.jsx)(De,{path:"/edit-profile",element:(0,_r.jsx)(fo,{children:(0,_r.jsx)(Ha,{})})}),(0,_r.jsx)(De,{path:"/call/:sessionId",element:(0,_r.jsx)(fo,{allowedRoles:["student","tutor"],children:(0,_r.jsx)(Ya,{})})}),(0,_r.jsx)(De,{path:"/student-reservations",element:(0,_r.jsx)(fo,{allowedRoles:["student"],children:(0,_r.jsx)(so,{})})}),(0,_r.jsx)(De,{path:"/student-finds-tutors",element:(0,_r.jsx)(fo,{allowedRoles:["student"],children:(0,_r.jsx)(uo,{})})}),(0,_r.jsx)(De,{path:"/payment-success",element:(0,_r.jsx)(ho,{})}),(0,_r.jsx)(De,{path:"/payment-cancel",element:(0,_r.jsx)(po,{})})]})})});c.createRoot(document.getElementById("root")).render((0,_r.jsx)(l.StrictMode,{children:(0,_r.jsx)(ur,i(i({},{authority:"https://cognito-idp.us-east-1.amazonaws.com/us-east-1_8mvpRkbVu",client_id:"342s18a96gl2pbaroorqh316l8",redirect_uri:"http://localhost:3000",response_type:"code",scope:"email openid profile",extraQueryParams:{ui_locales:"es"}}),{},{children:(0,_r.jsx)(vo,{})}))}))})();
//# sourceMappingURL=main.8a42a0f4.js.map